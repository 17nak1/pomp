!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){let n={},i=r(12),{rbinom:a}=r(23),o=r(24);const{rng:{MersenneTwister:s,timeseed:u}}=o;let l=new s(0);const{Gamma:f,rng:{LecuyerCMRG:c,normal:{BoxMuller:_}}}=o,d=new c(1234),{rgamma:p}=f(new _(d));n.rnorm=function(e=0,t=1){return Math.sqrt(-2*Math.log(rng()))*Math.cos(2*pi*rng())*t+e},n.pnorm=function(e,t=0,r=1,n=!0,a=!1){if(r<0)return NaN;let o=.5*(1+i((e-t)/r/Math.sqrt(2)));return n||(o=1-o),a&&(o=Math.log(o)),o},n.dpois=function(e,t,r=1){let n,i,a=0;if(isNaN(e)||isNaN(t)||t<0)return NaN;if(!Number.isInteger(e))return 0;if(e<0||!isFinite(e))return 0;n=-t+(e=Math.round(e))*Math.log(t);for(let t=1;t<=e;t++)a+=Math.log(t);return i=n-a,i=r?i:Math.exp(i),i},n.nosortResamp=function(e,t,r,n,i){for(j=1;j<e;j++)t[j]+=t[j-1];if(t[e-1]<=0)throw"in 'systematic_resampling': non-positive sum of weight";let a=t[e-1]/r,o=-a*l.unif_rand(),s=0;for(let i=0;i<r;i++){for(o+=a;o>t[s]&&s<e-1;)s++;n[i]=s}if(i)for(j=0;j<r;j++)n[j]+=i},n.reulermultinom=function(e=1,t,r,n,i,o,s){let u,l,f=0;if(t<0||n<0||Math.floor(t+.5)!==t){for(l=0;l<e;l++)s[l+i]=NaN;return 0}for(l=0;l<e;l++){if(o[l+r]<0){for(u=0;u<e;u++)s[u+i]=NaN;return 0}f+=o[l+r]}if(f>0){if(t=a(t,1-Math.exp(-f*n)),!isFinite(t))throw"result of binomial draw is not finite.";for(e-=1,l=0;l<e;l++){if(o[l+r]>f&&(f=o[l+r]),s[l+i]=t>0&&f>0?a(t,o[l+r]/f):0,!(isFinite(t)&&isFinite(f)&&isFinite(o[l+r])&&isFinite(s[l+i])))throw"result of binomial draw is not finite.";t-=s[l+i],f-=o[l+r]}s[e+i]=t}else for(l=0;l<e;l++)s[l+i]=0},n.sign=function(e,t){return isNaN(e)?e:t?Math.abs(e):-Math.abs(e)},n.expRand=function(e){let t=[.6931471805599453,.9333736875190459,.9888777961838675,.998495925291496,.9998292811061389,.9999833164100727,.9999985691438767,.9999998906925558,.9999999924734159,.9999999995283275,.9999999999728814,.9999999999985598,.999999999999929,.9999999999999968,.9999999999999999,1],r=0,n=e();for(;n<=0||n>=1;)n=e();for(;n+=n,!(n>1);)r+=t[0];if(n-=1,n<=t[0])return r+n;let i=0,a=e(),o=a;do{a=e(),o>a&&(o=a),i++}while(n>t[i]);return r+o*t[0]},n.fromLogBarycentric=function(e){var t=0;for(let r=0;r<e.length;r++)e[r]=Math.exp(e[r]),t+=e[r];for(let r=0;r<e.length;r++)e[r]=e[r]/t;return e},n.toLogBarycentric=function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];for(let r=0;r<e.length;r++)e[r]=Math.log(e[r]/t);return e},n.logit=function(e){return Math.log(e/(1-e))},n.plogis=function(e){return(1+Math.tanh(e/2))/2},n.expit=function(e){return 1/(1+Math.exp(-e))},n.qlogis=n.logit,n.rgammawn=function(e,t){let r=Math.pow(e,2);return r>0?p(1,t/r,r):t},n.logMeanExp=function(e){var t=Math.max(...e),r=e.map((e,r)=>Math.exp(e-t)).reduce((e,t)=>e+t,0);return t+Math.log(r/e.length)},n.mean=function(e,t=0){let r=e.length,n=Object.keys(e[0]).length,i={},a=0;0===t&&(t=new Array(r).fill(1));let o=t.reduce((e,t)=>e+t,0);for(let s=0;s<n;s++){a=0;for(let n=0;n<r;n++)0!==t[n]&&(a+=Object.values(e[n])[s]*t[n]);i[Object.keys(e[0])[s]]=a/o}return i},e.exports=n},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,l=[],f=!1,c=-1;function _(){f&&u&&(f=!1,u.length?l=u.concat(l):c=-1,l.length&&d())}function d(){if(!f){var e=s(_);f=!0;for(var t=l.length;t;){for(u=l,l=[];++c<t;)u&&u[c].run();c=-1,t=l.length}u=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||f||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){t.isatty=function(){return!1},t.ReadStream=function(){throw new Error("tty.ReadStream is not implemented")},t.WriteStream=function(){throw new Error("tty.ReadStream is not implemented")}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,a=n.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=a)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),u=n[r];r<a;u=n[++r])m(u)||!v(u)?o+=" "+u:o+=" "+s(u);return o},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var a,o={};function s(e,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&t._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),f(n,e,n.depth)}function u(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function l(e,t){return e}function f(e,r,n){if(e.customInspect&&r&&y(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return g(i)||(i=f(e,i,n)),i}var a=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(g(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(h(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(a)return a;var o=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),R(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return c(r);if(0===o.length){if(y(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(N(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(M(r))return e.stylize(Date.prototype.toString.call(r),"date");if(R(r))return c(r)}var l,v="",I=!1,E=["{","}"];(d(r)&&(I=!0,E=["[","]"]),y(r))&&(v=" [Function"+(r.name?": "+r.name:"")+"]");return N(r)&&(v=" "+RegExp.prototype.toString.call(r)),M(r)&&(v=" "+Date.prototype.toUTCString.call(r)),R(r)&&(v=" "+c(r)),0!==o.length||I&&0!=r.length?n<0?N(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),l=I?function(e,t,r,n,i){for(var a=[],o=0,s=t.length;o<s;++o)x(t,String(o))?a.push(_(e,t,r,n,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(_(e,t,r,n,i,!0))})),a}(e,r,n,s,o):o.map((function(t){return _(e,r,n,s,t,I)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(l,v,E)):E[0]+v+E[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function _(e,t,r,n,i,a){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),x(n,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=m(r)?f(e,u.value,null):f(e,u.value,r-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),b(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function h(e){return"number"==typeof e}function g(e){return"string"==typeof e}function b(e){return void 0===e}function N(e){return v(e)&&"[object RegExp]"===I(e)}function v(e){return"object"==typeof e&&null!==e}function M(e){return v(e)&&"[object Date]"===I(e)}function R(e){return v(e)&&("[object Error]"===I(e)||e instanceof Error)}function y(e){return"function"==typeof e}function I(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(b(a)&&(a=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!o[r])if(new RegExp("\\b"+r+"\\b","i").test(a)){var n=e.pid;o[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else o[r]=function(){};return o[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=h,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=N,t.isObject=v,t.isDate=M,t.isError=R,t.isFunction=y,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(25);var w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),w[e.getMonth()],t].join(" ")}function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",P(),t.format.apply(t,arguments))},t.inherits=r(26),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,r).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(O,t,o)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(1))},function(e,t,r){"use strict";(function(t){var r=t.argv,n=r.indexOf("--"),i=function(e){e="--"+e;var t=r.indexOf(e);return-1!==t&&(-1===n||t<n)};e.exports=!(!("FORCE_COLOR"in t.env)&&(i("no-color")||i("no-colors")||i("color=false")||!(i("color")||i("colors")||i("color=true")||i("color=always"))&&(t.stdout&&!t.stdout.isTTY||"win32"!==t.platform&&!("COLORTERM"in t.env)&&("dumb"===t.env.TERM||!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(t.env.TERM)))))}).call(this,r(1))},function(e,t,r){"use strict";r.r(t);const{pfilter:n}=r(6),i=self.workerfn=async(...e)=>await new Promise((t,r)=>{((t,r)=>()=>{let r,i=new Date;try{"function"==typeof progress&&progress(),r=n(...e)}catch(e){console.error(e),r=NaN}console.debug("Calculation time: ",new Date-i),t(r)})(t)()});t.default=i},function(e,t,r){const{initState:n}=r(7),{rprocessInternal:i}=r(8),{dmeasureInternal:a}=r(10),{pfilter_computations:o}=r(11),s=r(27),u=r(29);t.pfilter=function(e,t){let r=e.params?e.params:e;const l=Object.assign(t.object,{rprocess:s.rprocess,rmeasure:s.rmeasure,dmeasure:s.dmeasure,initializer:s.initializer,params:r}),f=new u(l);let c=Object.assign({},r),_=t.Np,d=t.tol?t.tol:1e-17,p=t.maxFail?t.maxFail:1/0,m=!!t.predMean&&t.predMean,h=!!t.predVar&&t.predVar,g=!!t.filterMean&&t.filterMean,b=!!t.filterTraj&&t.filterTraj,N=!!t.saveStates&&t.saveStates,v=!!t.saveParams&&t.saveParams;if(0===Object.keys(r).length)throw new Error("In pfilterInternal: params must be specified");let M=!1,R=[f.t0,...f.times],I=R.length-1;if("function"==typeof _||void 0===_||_<=0)throw new Error(`Number of particles should be a positive number. ${_} is not translated`);Array.isArray(r)&&!r.every(e=>!Array.isArray(e))||(M=!0,r=[r]);let E,w,P,x=n(f,r,_);(N||b)&&(E=new Array(I)),w=v?new Array(I):[],b&&(P=new Array(I+1));let A,O,T,L,S=new Array(I),q=new Array(I).fill(0),D=0;if(A=m?new Array(I).fill(null):[],O=h?new Array(I).fill(null):[],T=g?new Array(I).fill(null):[],b)throw new Error("filterTraj is not implemented");for(let e=0;e<I;e++){"function"==typeof progress&&progress();try{L=i(f,x,[R[e],R[e+1]],r,1)}catch(e){throw new Error("In pfilterInternal: Process simulation error: "+e)}if(h&&(s=L.every(e=>e.every(e=>isFinite(e))),!s))throw new Error("In pfilter.js: non-finite state variable(s): ");let t=[];try{t=a(f,y=f.data[e],L,R[e+1],r,log=!1)}catch(e){throw new Error("In pfilter.js: error in calculation of weights: "+e)}let n,s=t.map(e=>isFinite(e)).reduce((e,t)=>e&t,1);if(!s)throw new Error("In dmeasure: weights returns non-finite value");try{n=o(L,r,_=_,0,m,h,g,trackancestry=b,M,t=t,d=d)}catch(e){throw new Error("particle-filter error: "+e)}let u=n.fail;if(S[e]=n.loglik,q[e]=n.ess,x=n.states,r=n.params,m&&(A[e]=n.fm),h&&(O[e]=n.pv),g&&(T[e]=n.fm),b&&(P[[e]]=n.ancestry),u&&(D+=1,D>p))throw new Error("In mif2Pfilter: too many filtering failures");(N||b)&&(E[e]=x),v&&(w[e]=r)}if(b)throw new Error("filterTraj is not translated");return N||(E=[]),D>0&&console.log("warning! filtering failure occurred."),{params:c,predMean:A,predVar:O,filterMean:T,filterTraj:!1,paramMatrix:[[]],effSamplesize:q,condLoglik:S,savedStates:E,savedParams:w,Np:_,tol:d,nfail:D,loglik:S.reduce((e,t)=>e+t,0)}}},function(e,t){t.initState=function(e,t,n){return void 0===t&&(t=e.coef),(isNaN(n)||null===n)&&(n=t.length),r(e,t,n)};const r=function(e,t,r){let n=t.length,i=t[0];if(r%n!=0)throw new Error("in 'init.state': number of desired state-vectors 'nsim' is not a multiple of ncol('params')");let a=e.globals,o=e.initializer(i,e.interpolator(e.t0),a);return new Array(r).fill(null).map(e=>o)}},function(e,t,r){const{euler_model_simulator:n}=r(9);t.rprocessInternal=function(e,t,r,i,a=0){let o=r.length;if(o<2)throw new Error("in 'rprocess': length(times) < 2: with no transitions, there is no work to do.");let s=Number(a);if(s<0||s>=o)throw new Error("illegal 'offset' value "+s);let u=t.length,l=i.length;if(u>l)1===i.length&&(i=new Array(u).fill(null).map(e=>i[0]));else if(u<l)throw new Error("More parameters than ICs is not translated!");let f,c,_,d="euler_sim"===e.rprocessDetail.type?3:0;switch(d){case 1:c=e.rprocess,_=1,f=n(c,t,r,i,_,d,e);break;case 2:case 3:c=e.rprocess,_=Number(e.rprocessDetail.deltaT),f=n(c,t,r,i,_,d,e);break;case 4:throw new Error("in 'rprocess': Gillespie's method is not translated");case 0:default:throw new Error("'rprocess' is undefined. Note: only 'euler_sim' (discrete-time Euler) method is translated")}return f}},function(e,t){t.euler_model_simulator=function(e,t,i,a,o,s,u){let l=u.zeronames;if(o<=0)throw new Error("In euler.js: 'delta.t' should be a positive number");let f=t.length,c=i.length,_=i[0],d=t;for(let t=1;t<c;t++){if(_>i[t])throw new Error("In euler.js: 'times' is not an increasing sequence");for(let e=0;e<f;e++)for(let t=0;t<l.length;t++)d[e][l[t]]=0;let c,p;switch(s){case 1:p=i[t]-_,c=p>0?1:0;break;case 2:p=o,c=r(_,i[t],p);break;case 3:p=o,c=n(_,i[t],p);break;default:throw new Error("In euler.js: unrecognized 'method'")}for(let r=0;r<c;r++){"function"==typeof progress&&progress();let n=u.interpolator(_);for(let t=0;t<f;t++){let r={...d[t]};d[t]=e(r,a[t],_,p,n,u.globals)}_+=p,3==s&&r==c-2&&(p=i[t]-_,_=i[t]-p)}}return d};const r=function(e,t,r){let n,i=Math.sqrt(1e-7);return n=Math.floor((t-e)/r/(1-i)),n>0?n:0},n=function(e,t,r){let n,i=Math.sqrt(1e-7);return e>=t?(r=0,n=0):e+r>=t?(r=t-e,n=1):(n=Math.ceil((t-e)/r/(1+i)),r=(t-e)/n),n}},function(e,t){t.dmeasureInternal=function(e,t,r,n,i,a){if(ntimes=Array.isArray(n)?n.length:1,ntimes<1)throw new Error("In 'dmeasureInternal': times is not defined");let o=r[0].length?r[0].length:r.length,s=Object.keys(i).length;if(nreps=s>o?s:o,nreps%s!=0||nreps%o!=0)throw new Error("in 'dmeasureInternal': larger number of replicates is not a multiple of smaller");let u,l=e.dmeasure;if(ntimes>1)for(u=new Array(ntimes),k=0;k<ntimes;k++)u[k]=l(t[k],r[k][0],i,a,e.globals);else{u=new Array(nreps);for(let n=0;n<nreps;n++)1===s&&(i[n]=i[0]),u[n]=l(t,r[n],i[n],a,e.globals)}return u}},function(e,t,r){const n=r(0);t.pfilter_computations=function(e,t,r,i,a,o,s,u,l,f,c){let _=Object.keys(e[0]).length,d=e.length,p=Object.keys(t[0]).length,m=t.length;if(d%t.length!=0)throw new Error("In pfilter_computations: ncol('states') should be a multiple of ncol('params')");let h,g,b,N=Array.isArray(i)?i.length:0,v=N>0,M=!l||v;if(M&&m!==d)throw new Error("In pfilter_computations: ncol('states') should be equal to ncol('params')");let R,y,I,E,w,P,x=0,A=0,O=0,T=0;for(let e=0;e<d;e++)f[e]>c?(A+=f[e],O+=f[e]*f[e]):(f[e]=0,x++);x>=d&&(T=1),T?(g=Math.log(c),h=0):(g=Math.log(A/d),h=A*A/O),b=T,v?(R=Object.keys(i),y=t,I=_+N):(R=null,I=_),(a||o)&&(E={}),o&&(w={}),s&&(P=v?new Array(_+p):{});let L,S,q=0,D=Object.keys(e[0]);for(let t=0;t<_;t++){if(a||o){q=0;for(let r=0;r<d;r++)q+=e[r][D[t]];q/=d,E[D[t]]=q}if(o){let r,n=0;for(let i=0;i<d;i++)r=e[i][D[t]]-q,n+=r*r;w[D[t]]=n/(d-1)}if(s)if(T){let r=0;for(let n=0;n<d;n++)r+=e[n][D[t]];P[D[t]]=r/d}else{let r=0;for(let n=0;n<d;n++)r+=e[n][D[t]]*f[n];P[D[t]]=r/A}}if(v)throw new Error("Non zero rw_sd is not translated in pfilterComputations");if(T){if(u)for(let e=0;e<np;e++)xanc[e]=e+1}else{let i=new Array(2),a=new Array(r);i[0]=_,i[1]=r,L=new Array(r).fill(null).map(()=>new Array(_)),M&&(S=new Array(r).fill(null).map(()=>new Array(p))),n.nosortResamp(d,f,r,a,0);for(let n=0;n<r;n++)L[n]=Object.assign({},e[a[n]]),M&&(S[n]=Object.assign({},t[a[n]])),u&&(xanc[n]=a[n]+1)}let C={fail:b,loglik:g,ess:h,states:null,params:null,pm:null,pv:null,fm:null,ancestry:null};return C.states=T?e:L,C.params=t,C.params=T||!M?t:S,a&&(C.pm=E),o&&(C.pv=w),s&&(C.fm=P),u&&(C.ancestry=xanc),C}},function(e,t,r){"use strict";var n=r(13).factory,i=r(16),a=r(17),o=r(21),s=r(22),u=.8450629115104675,l=n([-.3250421072470015,-.02848174957559851,-.005770270296489442,-23763016656650163e-21]),f=n([.39791722395915535,.0650222499887673,.005081306281875766,.00013249473800432164,-3960228278775368e-21]),c=n([.41485611868374833,-.3722078760357013,.31834661990116175,-.11089469428239668,.035478304325618236,-.002166375594868791]),_=n([.10642088040084423,.540397917702171,.07182865441419627,.12617121980876164,.01363708391202905,.011984499846799107]),d=n([-.6938585727071818,-10.558626225323291,-62.375332450326006,-162.39666946257347,-184.60509290671104,-81.2874355063066,-9.814329344169145]),p=n([19.651271667439257,137.65775414351904,434.56587747522923,645.3872717332679,429.00814002756783,108.63500554177944,6.570249770319282,-.0604244152148581]),m=n([-.799283237680523,-17.757954917754752,-160.63638485582192,-637.5664433683896,-1025.0951316110772,-483.5191916086514]),h=n([30.33806074348246,325.7925129965739,1536.729586084437,3199.8582195085955,2553.0504064331644,474.52854120695537,-22.44095244658582]);e.exports=function(e){var t,r,n,g,b,N,v;return e!=e?NaN:e===o?1:e===s?-1:0===e?e:(e<0?(t=!0,r=-e):(t=!1,r=e),r<.84375?r<3.725290298461914e-9?r<2848094538889218e-321?.125*(8*e+1.0270333367641007*e):e+.1283791670955126*e:e+e*((g=.12837916709551256+(n=e*e)*l(n))/(b=1+n*f(n))):r<1.25?(N=(b=r-1)*c(b)-.0023621185607526594,v=1+b*_(b),t?-u-N/v:u+N/v):r>=6?t?-1:1:(b=1/(r*r),r<2.857142857142857?(g=b*d(b)-.009864944034847148,b=1+b*p(b)):(g=b*m(b)-.0098649429247001,b=1+b*h(b)),n=a(r,0),g=i(-n*n-.5625)*i((n-r)*(n+r)+g/b),t?g/r-1:1-g/r))}},function(e,t,r){"use strict";e.exports=r(14),e.exports.factory=r(15)},function(e,t,r){"use strict";e.exports=function(e,t){var r,n;if((n=e.length)<2||0===t)return 0===n?0:e[0];for(r=e[n-=1]*t+e[n-1],n-=2;n>=0;)r=r*t+e[n],n-=1;return r}},function(e,t,r){"use strict";e.exports=function(e){var t,r,n,i;if(t="return function evalpoly(x){",0===(r=e.length))t+="return 0;";else if(1===r)t+="return "+e[0]+";";else{for(t+="if(x===0){return "+e[0]+";}",t+="return "+e[0],n=r-1,i=1;i<r;i++)t+="+x*",i<n&&(t+="("),t+=e[i];for(i=0;i<n-1;i++)t+=")";t+=";"}return t+="}",new Function(t)()}},function(e,t,r){"use strict";e.exports=Math.exp},function(e,t,r){"use strict";var n=r(18),i=new Float64Array(1),a=new Uint32Array(i.buffer);e.exports=function(e,t){return i[0]=e,a[n]=t>>>0,i[0]}},function(e,t,r){"use strict";var n;n=!0===r(19)?0:1,e.exports=n},function(e,t,r){"use strict";var n,i=r(20);e.exports=((n=new i.uint16(1))[0]=4660,52===new i.uint8(n.buffer)[0])},function(e,t,r){"use strict";var n={uint16:Uint16Array,uint8:Uint8Array};e.exports=n},function(e,t,r){"use strict";e.exports=Number.POSITIVE_INFINITY},function(e,t,r){"use strict";e.exports=Number.NEGATIVE_INFINITY},function(e,t,r){t.rbinom=function(e,t){let r,i,a,o,s,u,l,f,c,_,d,p,m,h,g,b,N,v,M,R,y,I,E,w,P,x=0,A=0,O=0,T=0,L=0,S=0,q=0,D=0,C=0,j=0,F=0,k=0,V=0,B=-1,Q=-1,G=0,U=0;if(!isFinite(e))throw"Input values should be finite.";if(N=Math.round(e),N!==e)return NaN;if(!isFinite(t)||N<0||t<0||t>1)return NaN;if(0===N||0===t)return 0;if(1===t)return N;if(N>=Number.MAX_SAFE_INTEGER)throw"Evade overflow"+N+"> MAX_SAFE_INTEGER";P=Math.trunc(N),m=Math.min(t,1-t),h=1-m,g=P*m,N=m/h,b=N*(P+1);let H=!1;t!==B||P!==Q?(B=t,Q=P,g<30?(D=n(h,P),H=!0):(y=g+m,G=Math.trunc(y),A=G,O=g*h,T=Math.trunc(2.195*Math.sqrt(O)-4.6*h)+.5,k=A+.5,C=k-T,V=k+T,x=.134+20.5/(15.3+A),v=(y-C)/(y-C*m),j=v*(1+.5*v),v=(V-y)/(V*h),F=v*(1+.5*v),L=T*(1+x+x),S=L+x/j,q=S+x/F)):P===Q&&g<30&&(H=!0);let Y=!1;for(;!H;){if(o=Math.random()*q,s=Math.random(),o<=T){U=Math.trunc(k-T*s+o),Y=!0;break}if(o<=L){if(f=C+(o-T)/x,s=s*x+1-Math.abs(k-f)/T,s>1||s<=0)continue;U=Math.trunc(f)}else if(o>S){if(U=Math.trunc(V-Math.log(s)/F),U>P)continue;s=s*(o-S)*F}else{if(U=Math.trunc(C+Math.log(s)/j),U<0)continue;s=s*(o-L)*j}if(w=Math.abs(U-G),w<=20||w>=O/2-1){if(r=1,G<U)for(E=G+1;E<=U;E++)r*=b/E-N;else if(G!==U)for(E=U+1;E<=G;E++)r/=b/E-N;if(s<=r){Y=!0;break}}else{if(R=w/O*((w*(w/3+.625)+.1666666666666)/O+.5),I=-w*w/(2*O),M=Math.log(s),M<I-R){Y=!0;break}if(M<=I+R&&(c=U+1,i=A+1,d=P+1-A,u=P-U+1,p=d*d,_=c*c,a=i*i,l=u*u,M<=k*Math.log(i/c)+(P-G+.5)*Math.log(d/u)+(U-G)*Math.log(u*m/(c*h))+(13860-(462-(132-(99-140/a)/a)/a)/a)/i/166320+(13860-(462-(132-(99-140/p)/p)/p)/p)/d/166320+(13860-(462-(132-(99-140/_)/_)/_)/_)/c/166320+(13860-(462-(132-(99-140/l)/l)/l)/l)/u/166320)){Y=!0;break}}}if(!Y)for(;;){for(U=0,r=D,o=Math.random();;){if(o<r){Y=!0;break}if(U>110)break;o-=r,U++,r*=b/U-N}if(Y)break}return B>.5&&(U=P-U),U};const n=function(e,t){let r=1;if(Number.isNaN(e))return e;if(0!==t){if(!Number.isFinite(e))return R_pow(e,t);for(t<0&&(t=-t,e=1/e);1&t&&(r*=e),t>>=1;)e*=e}return r}},function(e,t,r){(function(t){var n;n=function(e,n,i){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=136)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=n("R_Q_P01_boundaries"),a=n("R_Q_P01_check");function o(e,t){return e?Math.log1p(-t):.5-t+.5}var s;function u(e){return t.ML_ERROR(s.ME_DOMAIN,"",e),Number.NaN}function l(e,t){if(Number.isNaN(e))return e;if(!isFinite(e))return e;if(Number.isNaN(t))return e;if(!isFinite(t))return e;let r=e-t;return r>Number.EPSILON||r<-Number.EPSILON?e:t}function f(e){return!Number.isInteger(e)}function c(e,t){if(2===t)return e*e;if(1===e||0===t)return 1;if(0===e)return t>0?0:t<0?Number.POSITIVE_INFINITY:t;if(Number.isFinite(e)&&Number.isFinite(t))return Math.pow(e,t);if(Number.isNaN(e)||Number.isNaN(t))return e+t;if(!Number.isFinite(e)){if(e>0)return t<0?0:Number.POSITIVE_INFINITY;if(Number.isFinite(t)&&t===Math.floor(t))return t<0?0:_(t,2)?e:-e}return!Number.isFinite(t)&&e>=0?t>0?e>=1?Number.POSITIVE_INFINITY:0:e<1?Number.POSITIVE_INFINITY:0:NaN}function _(e,t){let r=e/t;return e-Math.floor(r)*t}t.M_SQRT2=1.4142135623730951,t.frac=e=>e-Math.trunc(e),t.M_SQRT_32=5.656854249492381,t.DBL_MANT_DIG=18,t.M_LN2=.6931471805599453,t.M_1_SQRT_2PI=.3989422804014327,t.M_2PI=6.283185307179586,t.M_LN_2PI=1.8378770664093456,t.M_1_PI=1/Math.PI,t.M_PI_2=Math.PI/2,t.M_LN_SQRT_PI=.5723649429247001,t.M_LN_SQRT_2PI=.9189385332046728,t.M_LN_SQRT_PId2=.22579135264472744,t.M_SQRT_2dPI=.7978845608028654,t.M_LOG10_2=.3010299956639812,t.DBL_MAX_EXP=Math.log2(Number.MAX_VALUE),t.DBL_MIN_EXP=Math.log2(Number.MIN_VALUE),t.R_D__1=e=>e?0:1,t.R_D__0=e=>e?Number.NEGATIVE_INFINITY:0,t.R_DT_0=(e,r)=>e?t.R_D__0(r):t.R_D__1(r),t.R_DT_1=(e,r)=>e?t.R_D__1(r):t.R_D__0(r),t.R_D_val=(e,t)=>e?Math.log(t):t,t.R_D_Clog=o,t.R_DT_val=function(e,r,n){return e?t.R_D_val(r,n):o(r,n)},t.imin2=function(e,t){return Math.trunc(Math.min(e,t))},t.R_D_Lval=function(e,t){return e?t:1-t},t.R_D_Cval=function(e,t){return e?1-t:t},t.R_P_bounds_Inf_01=function(e,r,n){if(!Number.isFinite(n))return n>0?t.R_DT_1(e,r):t.R_DT_0(e,r)},t.R_D_half=function(e){return e?-t.M_LN2:.5},t.R_P_bounds_01=function(e,r,n,i,a){return n<=i?t.R_DT_0(e,r):n>=a?t.R_DT_1(e,r):void 0},t.R_D_exp=(e,t)=>e?t:Math.exp(t),function(e){e[e.ME_NONE=0]="ME_NONE",e[e.ME_DOMAIN=1]="ME_DOMAIN",e[e.ME_RANGE=2]="ME_RANGE",e[e.ME_NOCONV=4]="ME_NOCONV",e[e.ME_PRECISION=8]="ME_PRECISION",e[e.ME_UNDERFLOW=16]="ME_UNDERFLOW"}(s=t.ME||(t.ME={})),t.mapErr=new Map([[s.ME_NONE,"No error"],[s.ME_DOMAIN,"argument out of domain in '%s'"],[s.ME_RANGE,"argument out of domain in '%s'"],[s.ME_NOCONV,"convergence failed in '%s'"],[s.ME_PRECISION,"full precision may not have been achieved in '%s'"],[s.ME_UNDERFLOW,"underflow occurred in '%s'"]]),t.ML_ERROR=(e,r,n)=>{const i=t.mapErr.get(e);i&&n(i,r)},t.ML_ERR_return_NAN=u,t.R_D_nonint_check=function(e,r,n){if(f(r))return n("non-integer x = %d",r),t.R_D__0(e)},t.fmod=function(e,t){return e-Math.trunc(e/t)*t},t.imax2=function(e,t){return Math.trunc(Math.max(e,t))},t.isOdd=function(e){return Math.floor(e)%2==1},t.epsilonNear=l,t.isEpsilonNear=function(e,t){return!(!isFinite(e)||!isFinite(t))&&l(e,t)===t},t.R_D_negInonint=function(e){return e<0||f(e)},t.R_nonint=f,t.R_D_fexp=function(e,t,r){return e?-.5*Math.log(t)+r:Math.exp(r)/Math.sqrt(t)},t.nsig_BESS=16,t.ensig_BESS=1e16,t.rtnsig_BESS=1e-4,t.enmten_BESS=89e-309,t.enten_BESS=1e308,t.exparg_BESS=709,t.xlrg_BESS_IJ=1e5,t.xlrg_BESS_Y=1e8,t.thresh_BESS_Y=16,t.xmax_BESS_K=705.342,t.sqxmin_BESS_K=149e-156,t.M_eps_sinc=2.149e-8,t.R_pow_di=function(e,t){let r=1;if(Number.isNaN(e))return e;if(0!==t){if(!Number.isFinite(e))return c(e,t);for(t<0&&(t=-t,e=1/e);1&t&&(r*=e),t>>=1;)e*=e}return r},t.R_pow=c,t.R_finite=e=>!Number.isFinite(e),t.R_isnancpp=e=>Number.isNaN(e),t.myfmod=_,t.R_powV=function(e,t){if(1===e||0===t)return 1;if(0===e)return t>0?0:Number.POSITIVE_INFINITY;if(Number.isFinite(e)&&Number.isFinite(t))return Math.pow(e,t);if(Number.isNaN(e)||Number.isNaN(t))return e+t;if(!Number.isFinite(e)){if(e>0)return t<0?0:Number.POSITIVE_INFINITY;if(Number.isFinite(t)&&t===Math.floor(t))return t<0?0:_(t,2)?e:-e}return!Number.isFinite(t)&&e>=0?t>0?e>=1?Number.POSITIVE_INFINITY:0:e<1?Number.POSITIVE_INFINITY:0:NaN},t.ldexp=function(e,t){return Number.isNaN(e)||Number.isNaN(t)?e+t:Number.isFinite(e)&&Number.isFinite(t)?e*Math.pow(2,t):Number.POSITIVE_INFINITY},t.R_D_log=function(e,t){return e?t:Math.log(t)},t.R_Q_P01_boundaries=function(e,t,r,n,a){if(t){if(r>0)return u(i);if(0===r)return e?a:n;if(r===Number.NEGATIVE_INFINITY)return e?n:a}else{if(r<0||r>1)return u(i);if(0===r)return e?n:a;if(1===r)return e?a:n}},t.R_Q_P01_check=function(e,t){if(e&&t>0||!e&&(t<0||t>1))return u(a)},t.R_D_qIv=function(e,t){return e?Math.exp(t):t}},function(e,r,n){"use strict";void 0===t||"renderer"===t.type||!0===t.browser||t.__nwjs?e.exports=n(182):e.exports=n(183)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{abs:n,sign:i,floor:a,trunc:o,max:s}=Math,{isNaN:u}=Number,{isArray:l}=Array,f=r(1)("seq"),c=b(9);function _(...e){let t=[];for(const r of e)if(l(r)){let e=_(...r);t.push(...e)}else t.push(r);return t}function d(e){return function(t,...r){const n=(Array.isArray(t)?t:[t]).map(t=>e(t,...r));return 1===n.length?n[0]:n}}function p(e){return function(...t){return h(...t)(e)}}function m(e){return 1===e.length?e[0]:e}function h(...e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(null!==n)if(["undefined","boolean","number"].indexOf(typeof n)>=0)t.push([n]);else if("string"!=typeof n)if(Array.isArray(n))t.push(n);else{if(n instanceof Object)throw new Error("Sorry, looping over properties not yet supported");if(n instanceof Function)throw new Error("Sorry function arguments are not yet supported")}else t.push(n.split(""));else t.push([n])}const r=s(...t.map(e=>e.length));return function(e){const n=[];for(let i=0;i<r;i++){const r=[];for(let e=0;e<t.length;e++){const n=t[e],a=i%n.length;r.push(n[a])}n.push(e(...r))}return m(n)}}function g(e=!0){return function(t){const r=function(e){if(null==e)throw new TypeError('Illegal argument excepton: input needs to NOT be "null" or "undefined".');if("number"==typeof e)return[{key:0,val:e}];if(l(e))return e.map((e,t)=>({key:t,val:e}));if("string"==typeof e)return e.split("").map((e,t)=>({key:t,val:e}));if("object"==typeof e){const t=Object.getOwnPropertyNames(e);if(0===t.length)throw new Error("Input argument is an Object with no properties");return t.map(t=>({key:t,val:e[t]}))}throw new Error("unreachable code")}(t);return function(t){return e?m(r.map(e=>t(e.val,e.key))):r.forEach(e=>t(e.val,e.key))}}}function b(e=6){return d((function(t){return u(t)?NaN:Number.parseFloat(t.toPrecision(e))}))}function N(e){let t=0;for(let r=0;r<e.length;r++)if(l(e[r]))t+=N(e[r]);else{if("string"==typeof e[r]){const n=Number.parseFloat(e[r]);if(Number.isFinite(n)){t+=n;continue}throw Error(e[r]+" is not a number or can be coerced to a number")}if("number"!=typeof e[r]||!Number.isFinite(e[r]))throw new Error(e[r]+" is not a number");t+=e[r]}return t}t.isOdd=function(e){if(isFinite(e))return 2*a(e/2)<e;throw new Error("Not a finite Number: "+e)},t.seq=(e=0)=>(t=e)=>(r,a,o=1)=>{if(void 0===a){if(r<=0||void 0===r)return[];a=1}let s=r+e,u=a+e,l=s;a<r&&(u=r+t,s=a+t,l=u),o=n(o)*i(a-r),f("step:%d",o);const _=[];do{_.push(l),l+=o}while(c(l)>=s&&c(l)<=u&&0!==o);return c(_)},t.selector=function(...e){const t=_(e);return(e,r)=>t.indexOf(r)>=0},t.flatten=_,t.arrayrify=d,t.multiplex=p,t.asArray=function(e){return function(...t){const r=e(...t);return Array.isArray(r)?r:[r]}},t.possibleScalar=m,t.multiplexer=h,t.map=g(),t.each=g(!1),t.numberPrecision=b,t.any=function(e){return function(t){return t instanceof Function?void 0!==e.find(t):void 0!==e.find(e=>e===t)}},t.sum=N,t.div=p((e,t)=>e/t),t.mult=p((e,t)=>e*t),t.summary=function(e){if(!Array.isArray(e))throw new Error("Illigal argument, not an array");if(0===e.length)throw new Error("argument Array is empty");if(e.findIndex(e=>u(e))>=0)throw new Error("argument Array has NaNs");const t=e.length,r=N(e)/t;let n=0;for(let t=0;t<e.length;t++)n+=(e[t]-r)*(e[t]-r);const i=n/(t-1),s=i*(t-1)/t,l=Math.sqrt(i),f=Math.sqrt(s),c=e.sort((e,t)=>e-t),_=c[0],d=c[t-1],{q1:p,median:m,q3:h}=function(){const e=[4,2,4/3].map(e=>(t-1)/e).map(e=>{const t=1-(e-a(e)),r=1-t;return c[o(e)]*t+c[o(e)+1]*r});return{q1:e[0],median:e[1],q3:e[2]}}();return{N:t,mu:r,population:{variance:s,sd:f},sample:{variance:i,sd:l},relX:"depricated",relX2:"depricated",stats:{min:_,"1st Qu.":p,median:m,"3rd Qu.":h,max:d}}},t.Welch_Satterthwaite=function(e,r){const n=_(t.map(e)((e,t)=>e*e/r[t])),i=n.map((e,t)=>e*e/(r[t]-1));return Math.pow(N(n),2)/N(i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),{exp:i,expm1:a,log:o,log1p:s}=Math;function u(e,t){return e?l(t):s(-t)}function l(e){return e>-n.M_LN2?o(-a(e)):s(-i(e))}t.R_DT_qIv=function(e,t,r){return t?e?i(r):-a(r):n.R_D_Lval(e,r)},t.R_DT_CIv=function(e,t,r){return t?e?-a(r):i(r):n.R_D_Cval(e,r)},t.R_D_LExp=u,t.R_Log1_Exp=l,t.R_DT_Clog=function(e,t,r){return e?u(t,r):n.R_D_log(t,r)},t.R_DT_log=function(e,t,r){return e?n.R_D_log(t,r):u(t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),i=r(67);t.lgammafn=function(e){return n.map(e)(e=>i.lgammafn_sign(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=624,i=397,a=r(20),o=r(7),s=r(14),u=r(10);class l extends o.IRNG{MT_sgenrand(e){for(let t=0;t<n;t++)this.mt[t]=4294901760&e,e=69069*e+1,this.mt[t]|=(4294901760&e)>>>16,e=69069*e+1;this.mti=n}MT_genrand(){let e=new Int32Array(1),t=new Int32Array([0,2567483615]);const r=this.m_seed;if(this.mti=r[0],this.mti>=n){let r;for(625===this.mti&&this.MT_sgenrand(4357),r=0;r<227;r++)e[0]=2147483648&this.mt[r]|2147483647&this.mt[r+1],this.mt[r]=this.mt[r+i]^e[0]>>>1^t[1&e[0]];for(;r<623;r++)e[0]=2147483648&this.mt[r]|2147483647&this.mt[r+1],this.mt[r]=this.mt[r+-227]^e[0]>>>1^t[1&e[0]];e[0]=2147483648&this.mt[623]|2147483647&this.mt[0],this.mt[623]=this.mt[396]^e[0]>>>1^t[1&e[0]],this.mti=0}return e[0]=this.mt[this.mti++],e[0]^=e[0]>>>11,e[0]^=e[0]<<7&2636928640,e[0]^=e[0]<<15&4022730752,e[0]^=e[0]>>>18,r[0]=this.mti,2.3283064365386963e-10*new Uint32Array(e.buffer)[0]}fixupSeeds(){const e=this.m_seed;e[0]=624,e[0]<=0&&(e[0]=624),void 0===this.mt.find(e=>!!e)&&this.init(u.timeseed())}constructor(e=u.timeseed()){super(e)}_setup(){const e=new ArrayBuffer(2500);this._kind=s.IRNGType.MERSENNE_TWISTER,this._name="Mersenne-Twister",this.m_seed=new Int32Array(e).fill(0),this.mt=new Int32Array(e,4),this.mti=625}init(e=u.timeseed()){const t=new Uint32Array([0]);t[0]=e;for(let e=0;e<50;e++)t[0]=69069*t[0]+1;for(let e=0;e<this.m_seed.length;e++)t[0]=69069*t[0]+1,this.m_seed[e]=t[0];this.fixupSeeds(),super.init(e)}internal_unif_rand(){let e=this.MT_genrand();return a.fixup(e)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(u.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.MersenneTwister=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=n("qnorm"),{isNaN:u}=Number,{log:l,sqrt:f,abs:c}=Math;t.qnorm=function(e,t=0,r=1,n=!0,_=!1){let d,p,m,h;return o.map(e)(o=>{if(u(o)||u(t)||u(r))return o+t+r;let g=i.R_Q_P01_boundaries(n,_,o,-1/0,1/0);return void 0!==g?g:r<0?i.ML_ERR_return_NAN(s):0===r?t:(p=a.R_DT_qIv(n,_,o),d=p-.5,s("qnorm(p=%d, m=%d, s=%d, l.t.= %s, log= %s): q = %d",e,t,r,n,_,d),c(d)<=.425?(m=.180625-d*d,h=d*(((((((2509.0809287301227*m+33430.57558358813)*m+67265.7709270087)*m+45921.95393154987)*m+13731.69376550946)*m+1971.5909503065513)*m+133.14166789178438)*m+3.3871328727963665)/(((((((5226.495278852854*m+28729.085735721943)*m+39307.89580009271)*m+21213.794301586597)*m+5394.196021424751)*m+687.1870074920579)*m+42.31333070160091)*m+1)):(m=d>0?a.R_DT_CIv(n,_,o):p,m=f(-(_&&(n&&d<=0||!n&&d>0)?e:l(m))),s("close to 0 or 1: r = %7d",m),m<=5?(m+=-1.6,h=(((((((.0007745450142783414*m+.022723844989269184)*m+.2417807251774506)*m+1.2704582524523684)*m+3.6478483247632045)*m+5.769497221460691)*m+4.630337846156546)*m+1.4234371107496835)/(((((((1.0507500716444169e-9*m+.0005475938084995345)*m+.015198666563616457)*m+.14810397642748008)*m+.6897673349851)*m+1.6763848301838038)*m+2.053191626637759)*m+1)):(m+=-5,h=(((((((2.0103343992922881e-7*m+27115555687434876e-21)*m+.0012426609473880784)*m+.026532189526576124)*m+.29656057182850487)*m+1.7848265399172913)*m+5.463784911164114)*m+6.657904643501103)/(((((((20442631033899397e-31*m+1.421511758316446e-7)*m+18463183175100548e-21)*m+.0007868691311456133)*m+.014875361290850615)*m+.1369298809227358)*m+.599832206555888)*m+1)),d<0&&(h=-h)),t+r*h)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.segFnCache=n.seq(),t.IRNG=class{constructor(e){this.notify=new Set,this.emit=this.emit.bind(this),this.register=this.register.bind(this),this.unif_rand=this.unif_rand.bind(this),this.internal_unif_rand=this.internal_unif_rand.bind(this),this.init=this.init.bind(this),this._setup(),this.init(e)}get name(){return this._name}get kind(){return this._kind}init(e){this.emit("INIT")}unif_rand(e=1){return e=!e||e<0?1:e,n.map(t.segFnCache()(e))(()=>this.internal_unif_rand())}register(e,t){this.notify.add({event:e,handler:t})}emit(e){this.notify.forEach(t=>{t.event===e&&t.handler()})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(155);t.BuggyKindermanRamage=n.BuggyKindermanRamage;var i=r(154);t.BoxMuller=i.BoxMuller;var a=r(153);t.AhrensDieter=a.AhrensDieter;var o=r(72);t.Inversion=o.Inversion;var s=r(156);t.KindermanRamage=s.KindermanRamage;var u=r(15);t.IRNGNormal=u.IRNGNormal},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(115);t.Toms708=n.Toms708;var i=r(63);t.NumberW=i.NumberW},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{trunc:n,ceil:i,min:a,log2:o,pow:s}=Math,{now:u}=Date;t.timeseed=function(){const e=u();do{u()}while(u()-e<500);const t=a(32,i(o(e))),r=n(t/2),l=n(e/s(2,r)),f=e-l*s(2,r),c=new ArrayBuffer(4),_=new Uint8Array(c),d=new Uint32Array(c);return d[0]=f^l,_.reverse(),d[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(29),o=r(4),s=r(42),u=r(2),{log:l,log1p:f}=Math,{isNaN:c,isFinite:_,POSITIVE_INFINITY:d,NEGATIVE_INFINITY:p}=Number,m=n("lbeta");function h(e,t){let r,n,u;return c(e)||c(t)?e+t:(n=u=e,t<n&&(n=t),t>u&&(u=t),n<0?i.ML_ERR_return_NAN(m):0===n?d:_(u)?n>=10?(r=s.lgammacor(n)+s.lgammacor(u)-s.lgammacor(n+u),-.5*l(u)+i.M_LN_SQRT_2PI+r+(n-.5)*l(n/(n+u))+u*f(-n/(n+u))):u>=10?(r=s.lgammacor(u)-s.lgammacor(n+u),o.lgammafn(n)+r+n-n*l(n+u)+(u-.5)*f(-n/(n+u))):l(a.gammafn(n)*(a.gammafn(u)/a.gammafn(n+u))):p)}t.lbeta=function(e,t){return u.multiplexer(e,t)((e,t)=>h(e,t))},t.internal_lbeta=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(9),o=r(2),{isNaN:s,isFinite:u}=Number,{LN2:l,log:f}=Math,c=n("pbeta_raw");function _(e,t,r,n,o){if(0===t||0===r||!u(t)||!u(r))return 0===t&&0===r?o?-l:.5:0===t||t/r==0?i.R_DT_1(n,o):0===r||r/t==0||e<.5?i.R_DT_0(n,o):i.R_DT_1(n,o);let s=.5-e+.5,_=new a.NumberW(0),d=new a.NumberW(0),p=new a.NumberW(0);return c("before Toms708.bratio, a=%d, b=%d, x=%d, w=%d,wc=%d, ierr=%d",t,r,e,_.val,d.val,p.val),a.Toms708.bratio(t,r,e,s,_,d,p),c("after Toms708.bratio, a=%d, b=%d, x=%d, w=%d,wc=%d, ierr=%d",t,r,e,_.val,d.val,p.val),p.val&&11!==p.val&&14!==p.val&&c("pbeta_raw(%d, a=%d, b=%d, ..) -> bratio() gave error code %d",e,t,r,p),o&&(_.val=f(_.val),d.val=f(d.val)),n?_.val:d.val}t.pbeta_raw=_;const d=n("pbeta");t.pbeta=function(e,t,r,n=!0,a=!1){return o.map(e)(e=>(d("pbeta(q=%d, a=%d, b=%d, l.t=%s, ln=%s)",e,t,r,n,a),s(e)||s(t)||s(r)?NaN:t<0||r<0?i.ML_ERR_return_NAN(d):e<=0?i.R_DT_0(n,a):e>=1?i.R_DT_1(n,a):_(e,t,r,n,a)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(30),o=r(2),{isFinite:s}=Number,u=n("rchisq"),l=o.seq()();t.rchisq=function(e,t,r){return o.map(l(e))(()=>!s(t)||t<0?i.ML_ERR_return_NAN(u):a.rgamma(1,t/2,2,r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.WICHMANN_HILL=0]="WICHMANN_HILL",e[e.MARSAGLIA_MULTICARRY=1]="MARSAGLIA_MULTICARRY",e[e.SUPER_DUPER=2]="SUPER_DUPER",e[e.MERSENNE_TWISTER=3]="MERSENNE_TWISTER",e[e.KNUTH_TAOCP=4]="KNUTH_TAOCP",e[e.KNUTH_TAOCP2002=5]="KNUTH_TAOCP2002",e[e.LECUYER_CMRG=6]="LECUYER_CMRG"}(t.IRNGType||(t.IRNGType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),i=r(7);t.IRNGNormal=class{constructor(e){this.rng=e,this.unif_rand=this.unif_rand.bind(this),this.norm_rand=this.norm_rand.bind(this),this.internal_norm_rand=this.internal_norm_rand.bind(this)}norm_rand(e=1){return e=!e||e<0?1:e,n.map(i.segFnCache()(e))(()=>this.internal_norm_rand())}unif_rand(e=1){return this.rng.unif_rand(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7);t.IRNG=n.IRNG;const i=r(149),a=r(148),o=r(151),s=r(152),u=r(5),l=r(8),f=r(15);t.IRNGNormal=f.IRNGNormal;const c=r(157),_=r(10),d=r(158);t.rng={KnuthTAOCP:i.KnuthTAOCP,KnuthTAOCP2002:a.KnuthTAOCP2002,LecuyerCMRG:o.LecuyerCMRG,MarsagliaMultiCarry:s.MarsagliaMultiCarry,MersenneTwister:u.MersenneTwister,normal:{AhrensDieter:l.AhrensDieter,BoxMuller:l.BoxMuller,BuggyKindermanRamage:l.BuggyKindermanRamage,Inversion:l.Inversion,KindermanRamage:l.KindermanRamage},SuperDuper:c.SuperDuper,timeseed:_.timeseed,WichmannHill:d.WichmannHill}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(65),o=r(2),s=r(44),{log:u,log1p:l,round:f}=Math,{isNaN:c,isFinite:_}=Number,d=n("dbinom");function p(e,t,r,n,o){let f,c;if(0===r)return 0===e?i.R_D__1(o):i.R_D__0(o);if(0===n)return e===t?i.R_D__1(o):i.R_D__0(o);if(0===e){if(0===t)return i.R_D__1(o);let e=r<.1?-a.bd0(t,t*n)-t*r:t*u(n);return i.R_D_exp(o,e)}return e===t?(c=n<.1?-a.bd0(t,t*r)-t*n:t*u(r),i.R_D_exp(o,c)):e<0||e>t?i.R_D__0(o):(c=s.stirlerr(t)-s.stirlerr(e)-s.stirlerr(t-e)-a.bd0(e,t*r)-a.bd0(t-e,t*n),f=i.M_LN_2PI+u(e)+l(-e/t),i.R_D_exp(o,c-.5*f))}t.dbinom_raw=p,t.dbinom=function(e,t,r,n=!1){return o.map(e)(e=>c(e)||c(t)||c(r)?e+t+r:r<0||r>1||i.R_D_negInonint(t)?i.ML_ERR_return_NAN(d):(i.R_D_nonint_check(n,e,d),e<0||!_(e)?i.R_D__0(n):(t=f(t),p(e=f(e),t,r,1-r,n))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(31),s=r(19),u=r(22),l=r(4),{LN2:f,log1p:c,expm1:_,sqrt:d,floor:p,pow:m,log:h,exp:g,max:b,abs:N}=Math,{isNaN:v,MIN_VALUE:M,EPSILON:R,isFinite:y,POSITIVE_INFINITY:I}=Number,{isArray:E}=Array,w=e=>e*e,P=w(w(w(4294967296))),x=f*i.DBL_MAX_EXP/R;function A(e,t,r,n){let i=2*r,a=t+r,o=a+r,s=a,u=t*(a-t*e),l=r*r*e,f=o*a-l;for(l=o*u-t*l;N(f*u-s*l)>N(n*u*l);){let t=a*a*e;a+=r,o+=r,s=o*f-t*s,u=o*l-t*u,t=i*i*e,i+=r,o+=r,f=o*s-t*f,l=o*u-t*l,N(l)>P?(s/=P,u/=P,f/=P,l/=P):N(l)<1/P&&(s*=P,u*=P,f*=P,l*=P)}return f/l}function O(e){if(e>1||e<-.79149064)return c(e)-e;{let t=e/(2+e),r=t*t;if(N(e)<.01){let n=2;return t*((((n/9*r+n/7)*r+n/5)*r+n/3)*r-e)}return t*(2*r*A(r,3,2,1e-14)-e)}}function T(e){const t=[.3224670334241132,.0673523010531981,.020580808427784546,.007385551028673986,.0028905103307415234,.001192753911703261,.0005096695247430425,.00022315475845357939,9945751278180853e-20,4492623673813314e-20,2050721277567069e-20,9439488275268397e-21,4374866789907488e-21,2039215753801366e-21,9.55141213040742e-7,4.492469198764566e-7,2.1207184805554665e-7,1.0043224823968099e-7,4.7698101693639804e-8,2.2711094608943164e-8,1.0838659214896955e-8,5.183475041970047e-9,2.4836745438024785e-9,1.1921401405860912e-9,5.731367241678862e-10,2.7595228851242334e-10,1.330476437424449e-10,64229645638381e-24,31044247747322276e-27,15021384080754142e-27,7275974480239079e-27,3527742476575915e-27,1711991790559618e-27,8315385841420285e-28,404220052528944e-27,19664756310966165e-29,9573630387838556e-29,46640760264283744e-30,22737369600659724e-30,11091399470834522e-30];let r,n;if(N(e)>=.5)return l.lgammafn(e+1);for(r=22737368458246524e-29*A(-e/2,42,1,1e-14),n=39;n>=0;n--)r=t[n]-e*r;return(e*r-.5772156649015329)*e-O(e)}t.lgamma1p=T;const L=n("dpois_wrap");function S(e,t,r){if(L("dpois_wrap(x+1=%d, lambda=%d, log=%s)",e,t,r),!y(t))return i.R_D__0(r);if(e>1)return u.dpois_raw(e-1,t,r);if(t>N(e-1)*x)return i.R_D_exp(r,-t-l.lgammafn(e));{let n=u.dpois_raw(e,t,r);return L("  -> d=dpois_raw(..)=%d",n),r?n+h(e/t):n*(e/t)}}const q=n("pgamma_smallx"),D=n("pd_lower_cf");function C(e,t){let r,n,i,a,o,s,u,l,f,c,_=0;if(D("pd_lower_cf(y=%d, d=%d)",e,t),0===e)return 0;if(n=e/t,N(e-1)<N(t)*R)return D(' very small "y" -> returning (y/d)'),n;for(n>1&&(n=1),a=e,s=t,u=0,l=1,f=e,c=t;c>P;)u/=P,l/=P,f/=P,c/=P;for(i=0,r=-1;i<2e5;)if(i++,a--,o=i*a,s+=2,u=s*f+o*u,l=s*c+o*l,i++,a--,o=i*a,s+=2,f=s*u+o*f,c=s*l+o*c,0!==c){if(_=f/c,N(_-r)<=R*b(n,N(_)))return D(" %d iter.\n",i),_;r=_}return D(" ** NON-convergence in pgamma()'s pd_lower_cf() f= %d.",_),_}const j=n("pd_lower_series"),F=n("ppois_asymp");function k(e,t,r,n){const i=[-1e99,2/3,-4/135,8/2835,16/8505,-8992/12629925,-334144/492567075,698752/1477701225],a=[-1e99,1/12,1/288,-139/51840,-571/2488320,163879/209018880,5246819/75246796800,-.0005921664373536939];let u,l,f,_,p,m,h,b,v,M,y,I,E;for(b=t-e,v=-O(b/e),M=d(2*e*v),b<0&&(M=-M),f=0,p=_=d(e),h=m=M,E=1;E<8;E++)f+=p*i[E],f+=h*a[E],_*=v/E,m*=2*v/(2*E+1),p=p/e+_,h=h/e+m;for(u=e,l=1,E=1;E<8;E++)u+=l*a[E],l/=e;if(r||(u=-u),F("res12 = %d   elfb=%d",u,f),y=f/u,I=s.pnorm5(M,0,1,!r,n),n){let e=function(e,t,r){if(e<0&&(e=-e,t=!t),e>10&&!t){let t=1/e,r=t,n=e*e,i=1;do{t*=-i/n,r+=t,i+=2}while(N(t)>R*r);return 1/r}return o.dnorm4(e,0,1,!1)/g(r)}(M,!r,I);return F("pp*_asymp(): f=%d\t np=e^%d  nd/np=%d  f*nd/np=%d",y,I,e,y*e),I+c(y*e)}{let e=o.dnorm4(M,0,1,n);return F("pp*_asymp(): f=%d\t np=%d  nd=%d  f*nd=%d",y,I,e,y*e),I+y*e}}const V=n("pgamma_raw");function B(e,t,r=!0,n=!1){let o;V("pgamma_raw(x=%d, alph=%d, low=%s, log=%s)",e,t,r,n);let s=i.R_P_bounds_01(r,n,e,0,I);if(void 0!==s)return s;if(e<1)o=function(e,t,r,n){let i,o=0,s=t,l=0;q(" pg_smallx(x=%d, alph=%d): ",e,t);do{l++,s*=-e/l,i=s/(t+l),o+=i}while(N(i)>R*N(o));if(q("%d terms --\x3e conv.sum=%d;",l,o),r){let r,i=n?c(o):1+o;return t>1?(r=u.dpois_raw(t,e,n),r=n?r+e:r*g(e)):r=n?t*h(e)-T(t):m(e,t)/g(T(t)),q(" (f1,f2)= (%d,%d)",i,r),n?i+r:i*r}{let r=t*h(e)-T(t);if(q(" 1:%d  2:%d",t*h(e),T(t)),q(" sum=%d  log(1+sum)=%d\t lf2=%d",o,c(o),r),n)return a.R_Log1_Exp(c(o)+r);{let e=o,t=_(r);return-(e+t+e*t)}}}(e,t,r,n);else if(e<=t-1&&e<.8*(t+50)){let i=function(e,t,r){let n=e/t,i=n;do{n*=e/++t,i+=n}while(n>i*R);return r?h(i):i}(e,t,n),s=S(t,e,n);V(' alph "large": sum=pd_upper*()= %d, d=dpois_w(*)= %d',i,s),o=r?n?i+s:i*s:n?a.R_Log1_Exp(s+i):1-s*i}else if(t-1<e&&t<.8*(e+50)){let s,u=S(t,e,n);if(V('  x "large": d=dpois_w(*)= %d ',u),t<1)if(e*R>1-t)s=i.R_D__1(n);else{let r=C(t,e-(t-1))*e/t;s=n?h(r):r}else s=function(e,t){let r=1,n=0;for(j("pd_lower_series(lam=%d, y=%d) ...",e,t);t>=1&&r>n*R;)r*=t/e,n+=r,t--;if(j(" done: term=%d, sum=%d, y= %d",r,n,t),t!==p(t)){let i;j(" y not int: add another term "),i=C(t,e+1-t),j("  (= %d) * term = %d to sum %d",i,r*i,n),n+=r*i}return n}(e,t-1),s=n?c(s):1+s;V(", sum= %d",s),o=r?n?a.R_Log1_Exp(u+s):1-u*s:n?s+u:s*u}else V(" using ppois_asymp()"),o=k(t-1,e,!r,n);return!n&&o<M/R?(V(" very small res=%.14g; -> recompute via log\n",o),g(B(e,t,r,!0))):o}t.pgamma_raw=B;const Q=n("pgamma");t.pgamma=function(e,t,r,n,a){const o=(E(e)?e:[e]).map(e=>v(e)||v(t)||v(r)?e+t+r:t<0||r<=0?i.ML_ERR_return_NAN(Q):v(e/=r)?e:0===t?e<=0?i.R_DT_0(n,a):i.R_DT_1(n,a):B(e,t,n,a));return 1===o.length?o[0]:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{isNaN:o,isFinite:s,EPSILON:u,NaN:l,MIN_VALUE:f}=Number,{trunc:c,log:_,exp:d,abs:p,log1p:m}=Math,h=r(9),g=n("pnorm5");function b(e,t,r,n,i,a,o,s){let u=c(16*n)/16,l=(n-u)*(n+u);r?(t.val=-u*u*.5+.5*-l+_(i),(o&&s>0||a&&s<=0)&&(e.val=m(-d(-u*u*.5)*d(.5*-l)*i))):(t.val=d(-u*u*.5)*d(.5*-l)*i,e.val=1-t.val)}function N(e,t,r,n,a){const s=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,.06568233791820745],l=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],c=[.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192e-8],d=[22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],m=[.215898534057957,.12740116116024736,.022235277870649807,.0014216191932278934,29112874951168793e-21,.023073441764940174],h=[1.284260096144911,.4682382124808651,.06598813786892856,.0037823963320275824,7297515550839662e-20];let g,N,v,M,R,y,I,E,w=f,P=new Int32Array([0]);if(o(e))t.val=r.val=e;else{if(M=.5*u,I=!0!==n,E=!1!==n,y=p(e),y<=.67448975){if(y>M)for(R=e*e,N=s[4]*R,g=R,P[0]=0;P[0]<3;++P[0])N=(N+s[P[0]])*R,g=(g+l[P[0]])*R;else N=g=0;v=e*(N+s[3])/(g+l[3]),I&&(t.val=.5+v),E&&(r.val=.5-v),a&&(I&&(t.val=_(t.val)),E&&(r.val=_(r.val)))}else if(y<=i.M_SQRT_32){for(N=c[8]*y,g=y,P[0]=0;P[0]<7;++P[0])N=(N+c[P[0]])*y,g=(g+d[P[0]])*y;v=(N+c[7])/(g+d[7]),b(r,t,a,y,v,E,I,e),e>0&&(v=t.val,I&&(t.val=r.val),r.val=v)}else if(a&&y<1e170||I&&-37.5193<e&&e<8.2924||E&&-8.2924<e&&e<37.5193){for(R=1/(e*e),N=m[5]*R,g=R,P[0]=0;P[0]<4;++P[0])N=(N+m[P[0]])*R,g=(g+h[P[0]])*R;v=R*(N+m[4])/(g+h[4]),v=(i.M_1_SQRT_2PI-v)/y,b(r,t,a,e,v,E,I,e),e>0&&(v=t.val,I&&(t.val=r.val),r.val=v)}else e>0?(t.val=i.R_D__1(a),r.val=i.R_D__0(a)):(t.val=i.R_D__0(a),r.val=i.R_D__1(a));a?(t.val>-w&&(t.val=-0),r.val>-w&&(r.val=-0)):(t.val<w&&(t.val=0),r.val<w&&(r.val=0))}}t.pnorm5=function(e,t=0,r=1,n=!0,u=!1){return a.map(e)(e=>{let a=new h.NumberW(0),f=new h.NumberW(0);return o(e)||o(t)||o(r)?e+t+r:s(e)||t!==e?r<=0?r<0?i.ML_ERR_return_NAN(g):e<t?i.R_DT_0(n,u):i.R_DT_1(n,u):(a.val=(e-t)/r,s(a.val)?(N(e=a.val,a,f,!n,u),n?a.val:f.val):e<t?i.R_DT_0(n,u):i.R_DT_1(n,u)):l})},t.pnorm_both=N},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.i2_32m1=2.328306437080797e-10,t.fixup=function(e){return e<=0?.5*t.i2_32m1:1-e<=0?1-.5*t.i2_32m1:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(22),o=r(2),{log:s}=Math,{isNaN:u}=Number,l=n("dgamma");t.dgamma=function(e,t,r,n=!1){return o.map(e)(e=>{let o;return u(e)||u(t)||u(r)?e+t+r:t<0||r<=0?i.ML_ERR_return_NAN(l):e<0?i.R_D__0(n):0===t?0===e?1/0:i.R_D__0(n):0===e?t<1?1/0:t>1?i.R_D__0(n):n?-s(r):1/r:t<1?(o=a.dpois_raw(t,e/r,n),n?o+s(t/e):o*t/e):(o=a.dpois_raw(t-1,e/r,n),n?o-s(r):o/r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(65),o=r(4),s=r(2),u=r(44),{round:l,log:f,PI:c}=Math,{isNaN:_,isFinite:d,MIN_VALUE:p}=Number,m=2*c,h=n("dpois");function g(e,t,r){return 0===t?0===e?i.R_D__1(r):i.R_D__0(r):d(t)?e<0?i.R_D__0(r):e<=t*p?i.R_D_exp(r,-t):t<e*p?i.R_D_exp(r,-t+e*f(t)-o.lgammafn(e+1)):i.R_D_fexp(r,m*e,-u.stirlerr(e)-a.bd0(e,t)):i.R_D__0(r)}t.dpois_raw=g,t.dpois=function(e,t,r=!1){return s.map(e)(e=>{if(_(e)||_(t))return e+t;if(t<0)return i.ML_ERR_return_NAN(h);let n=i.R_D_nonint_check(r,e,h);return void 0!==n?n:e<0||!d(e)?i.R_D__0(r):g(e=l(e),t,r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{abs:a,PI:o}=Math,{NaN:s,isNaN:u,isFinite:l}=Number,f=n("cospi");t.cospi=function(e){return u(e)?e:l(e)?(e=i.fmod(a(e),2),.5===i.fmod(e,1)?0:1===e?-1:0===e?1:Math.cos(o*e)):(i.ML_ERROR(i.ME.ME_DOMAIN,"",f),s)};const c=n("tanpi");t.tanpi=function(e){return u(e)?e:l(e)?((e=i.fmod(e,1))<=-.5?e++:e>.5&&e--,0===e?0:.5===e?s:Math.tan(o*e)):(i.ML_ERROR(i.ME.ME_DOMAIN,"",c),s)},t.atanpi=function(e){return Math.atan(e)/Math.PI}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{PI:a}=Math,{NaN:o,isNaN:s,isFinite:u}=Number,l=n("sinpi");t.sinpi=function(e){return s(e)?e:u(e)?((e=i.fmod(e,2))<=-1?e+=2:e>1&&(e-=2),0===e||1===e?0:.5===e?1:-.5===e?-1:Math.sin(a*e)):(i.ML_ERROR(i.ME.ME_DOMAIN,"sinpi not finite",l),o)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(21),a=r(18),o=r(68),s=r(30),u=r(8),l=r(2),f=r(29),c=r(4),_=r(128);t.special={digamma:_.digamma,gamma:f.gammafn,lgamma:c.lgammafn,pentagamma:_.pentagamma,psigamma:_.psigamma,tetragamma:_.tetragamma,trigamma:_.trigamma};const{abs:d}=Math;t.Gamma=function(e=new u.Inversion){const t=n("gamma_normalize_params");function r(e,r){if(void 0===r&&void 0===e)return 1;if(void 0!==r&&void 0!==e)return d(r*e-1)>=1e-16?void t("Both scale:%d and rate:%d are defined but scale <> 1/rate"):r;if(void 0!==r&&void 0===e)return r;if(void 0===r&&void 0!==e)return 1/e;throw new Error("unreachable code, you cant be here!")}const f=n("dgamma"),c=n("pgamma"),_=n("qgamma"),p=n("rgamma");return Object.freeze({dgamma:function(e,t,n,a,o=!1){let s=r(n,a);return void 0!==s?i.dgamma(e,t,s,o):(f("Cannot normalize to [scale]"),l.multiplexer(e)(()=>NaN))},pgamma:function(e,t,n,i,o=!0,s=!1){let u=r(n,i);return void 0!==u?a.pgamma(e,t,u,o,s):(c("Cannot normalize to [scale]"),l.multiplexer(e)(()=>NaN))},qgamma:function(e,t,n,i,a=!0,s=!1){let u=r(n,i);return void 0!==u?o.qgamma(e,t,u,a,s):(_("Cannot normalize to [scale]"),l.multiplexer(e)(()=>NaN))},rgamma:function(t,n,i,a){let o=r(i,a);if(void 0!==o)return s.rgamma(t,n,o,e);p("Cannot normalize to [scale]")}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nsig_BESS=16,t.ensig_BESS=1e16,t.rtnsig_BESS=1e-4,t.enmten_BESS=89e-309,t.enten_BESS=1e308,t.exparg_BESS=709,t.xlrg_BESS_IJ=1e5,t.xlrg_BESS_Y=1e8,t.thresh_BESS_Y=16,t.xmax_BESS_K=705.342,t.sqxmin_BESS_K=149e-156,t.M_eps_sinc=2.149e-8},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{abs:a,log:o,exp:s,round:u}=Math,{isInteger:l,NEGATIVE_INFINITY:f,isNaN:c}=Number,_=r(11),d=r(4),p=r(67),m=r(2);function h(e,t){return-o(e+1)-_.internal_lbeta(e-t+1,t+1)}function g(e,t,r){let n;return n=p.lgammafn_sign(e-t+1,r),d.lgammafn(e+1)-d.lgammafn(t+1)-n}t.choose=function(e,t){return m.multiplexer(e,t)((e,t)=>M(e,t))},t.lchoose=function(e,t){return m.multiplexer(e,t)((e,t)=>N(e,t))};const b=n("lchoose");function N(e,t){let r=t;return t=Math.round(t),c(e)||c(t)?e+t:(a(t-r)>1e-7&&b('"k" (%d) must be integer, rounded to %d',r,t),t<2?t<0?f:0===t?0:o(a(e)):e<0?N(-e+t-1,t):l(e)?(e=u(e))<t?f:e-t<2?N(e,e-t):h(e,t):e<t-1?g(e,t):h(e,t))}t.internal_lchoose=N;const v=n("choose");function M(e,t){let r,n=t;if(t=u(t),c(e)||c(t))return e+t;if(a(t-n)>1e-7&&v("k (%d) must be integer, rounded to %d",n,t),t<30){let n;if(e-t<t&&e>=0&&l(e)&&(t=e-t),t<0)return 0;if(0===t)return 1;for(r=e,n=2;n<=t;n++)r*=(e-n+1)/n;return l(e)?u(r):r}if(e<0)return r=M(-e+t-1,t),i.isOdd(t)&&(r=-r),r;if(l(e))return(e=u(e))<t?0:e-t<30?M(e,e-t):u(s(h(e,t)));if(e<t-1){let n=[0];return r=g(e,t,n),n[0]*s(r)}return s(h(e,t))}t.internal_choose=M},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exp_rand=function(e){const t=[.6931471805599453,.9333736875190459,.9888777961838675,.998495925291496,.9998292811061389,.9999833164100727,.9999985691438767,.9999998906925558,.9999999924734159,.9999999995283275,.9999999999728814,.9999999999985598,.999999999999929,.9999999999999968,.9999999999999999,1];let r=0,n=e();for(;n<=0||n>=1;)n=e();for(;n+=n,!(n>1);)r+=t[0];if(n-=1,n<=t[0])return r+n;let i=0,a=e(),o=a;do{a=e(),o>a&&(o=a),i++}while(n>t[i]);return r+o*t[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(37),i=r(0),a=r(44),o=r(33),s=r(42),u=r(1)("gammafn"),{isNaN:l,NaN:f,POSITIVE_INFINITY:c,NEGATIVE_INFINITY:_}=Number,{PI:d,abs:p,round:m,trunc:h,exp:g,log:b}=Math,N=Math.log(Math.sqrt(2*Math.PI)),v=[.00857119559098933,.004415381324841007,.05685043681599363,-.00421983539641856,.0013268081812124603,-.00018930245297988805,3606925327441245e-20,-6056761904460864e-21,10558295463022833e-22,-1.811967365542384e-7,3.117724964715322e-8,-5.354219639019687e-9,9.193275519859589e-10,-1.5779412802883398e-10,27079806229349544e-27,-464681865382573e-26,797335019200742e-27,-1368078209830916e-28,23473194865638007e-30,-4027432614949067e-30,6910051747372101e-31,-1185584500221993e-31,2034148542496374e-32,-3490054341717406e-33,5987993856485306e-34,-1027378057872228e-34,1.7627028160605298e-20,-3024320653735306e-36,5188914660218398e-37,-8902770842456576e-38,15274740684933426e-39,-2620731256187363e-39,4496464047830539e-40,-7714712731336878e-41,1323635453126044e-41,-22709994129429287e-43,38964189980039913e-44,-6685198115125953e-44,11469986631400244e-45,-1.9679385863451348e-30,3376448816585338e-46,-5793070335782136e-47],{isArray:M}=Array;t.gammafn=function(e){const t=(M(e)?e:[e]).map(e=>function(e){let t,r,M,R,y;const I=1.4901161193847656e-8;if(l(e))return e;if(0===e||e<0&&e===m(e))return i.ML_ERROR(i.ME.ME_DOMAIN,"gammafn",u),f;if(M=p(e),M<=10){if(r=e>>0,e<0&&--r,M=e-r,--r,y=n.chebyshev_eval(2*M-1,v,22)+.9375,0===r)return y;if(r<0){if(e<-.5&&p(e-h(e-.5)/e)<I&&i.ML_ERROR(i.ME.ME_PRECISION,"gammafn",u),M<22474362225598545e-324)return i.ML_ERROR(i.ME.ME_RANGE,"gammafn",u),e>0?c:_;for(r=-r,t=0;t<r;t++)y/=e+t;return y}for(t=1;t<=r;t++)y*=M+t;return y}if(e>171.61447887182297)return i.ML_ERROR(i.ME.ME_RANGE,"gammafn",u),c;if(e<-170.5674972726612)return i.ML_ERROR(i.ME.ME_UNDERFLOW,"gammafn",u),0;if(M<=50&&M===h(M))for(y=1,t=2;t<M;t++)y*=t;else y=g((M-.5)*b(M)-M+N+(2*M==h(2)*M?a.stirlerr(M):s.lgammacor(M)));return e>0?y:(p((e-h(e-.5))/e)<I&&i.ML_ERROR(i.ME.ME_PRECISION,"gammafn",u),R=o.sinpi(M),0===R?(i.ML_ERROR(i.ME.ME_RANGE,"gammafn",u),c):-d/(M*R*y))}(e));return 1===t.length?t[0]:t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(28),{expm1:o,abs:s,sqrt:u,log:l,exp:f}=Math,{isFinite:c}=Number;t.rgamma=function(e=1,t=1,r=1,n){const i=new Array(e).fill(0).map(()=>d(t,r,n));return 1===i.length?i[0]:i};const _=n("_rgamma");function d(e=1,t=1,r){const n=.3333333,d=-.250003,p=.2000062,m=-.1662921,h=.1423657,g=-.1367177,b=.1233795;let N=0,v=0,M=0,R=0,y=0,I=0,E=0,w=0,P=0,x=0,A=0,O=0,T=0,L=0,S=0,q=0,D=0,C=0,j=0;if(!c(e)||!c(t)||e<0||t<=0)return 0===t?0:i.ML_ERR_return_NAN(_);if(e<1){if(0===e)return 0;for(x=1+.36787944117144233*e;;)if(A=x*r.unif_rand(),A>=1){if(C=-l((x-A)/e),a.exp_rand(r.unif_rand)>=(1-e)*l(C))break}else if(C=f(l(A)/e),a.exp_rand(r.unif_rand)>=C)break;return t*C}if(e!==N&&(N=e,R=e-.5,M=u(R),y=5.656854-12*M),L=r.norm_rand(),C=M+.5*L,j=C*C,L>=0)return t*j;if(S=r.unif_rand(),y*S<=L*L*L)return t*j;if(e!==v&&(v=e,T=1/e,I=((((((2424e-7*T+24511e-8)*T-7388e-8)*T+.00144121)*T+.00801191)*T+.02083148)*T+.04166669)*T,e<=3.686?(E=.463+M+.178*R,w=1.235,P=.195/M-.079+.16*M):e<=13.022?(E=1.654+.0076*R,w=1.68/M+.275,P=.062/M+.024):(E=1.77,w=.75,P=.1515/M)),C>0&&(q=L/(M+M),O=s(q)<=.25?I+.5*L*L*((((((b*q+g)*q+h)*q+m)*q+p)*q+d)*q+n)*q:I-M*L+.25*L*L+(R+R)*l(1+q),l(1-S)<=O))return t*j;for(;x=a.exp_rand(r.unif_rand),S=r.unif_rand(),S=S+S-1,L=S<0?E-w*x:E+w*x,!(L>=-.71874483771719&&(q=L/(M+M),O=s(q)<=.25?I+.5*L*L*((((((b*q+g)*q+h)*q+m)*q+p)*q+d)*q+n)*q:I-M*L+.25*L*L+(R+R)*l(1+q),O>0&&(D=o(O),P*s(S)<=D*f(x-.5*L*L)))););return C=M+.5*L,t*C*C}t._rgamma=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{isNaN:a,isFinite:o,MAX_VALUE:s,POSITIVE_INFINITY:u,NaN:l}=Number,{sqrt:f,exp:c,abs:_,round:d,log:p}=Math,m=n("dnorm4"),{isArray:h}=Array;t.dnorm4=function(e,t=0,r=1,n=!1){let g=(h(e)&&e||[e]).map(e=>{if(a(e)||a(t)||a(r))return e+t+r;if(!o(r))return i.R_D__0(n);if(!o(e)&&t===e)return l;if(r<=0)return r<0?i.ML_ERR_return_NAN(m):e===t?u:i.R_D__0(n);if(!o(e=(e-t)/r))return i.R_D__0(n);if((e=_(e))>=2*f(s))return i.R_D__0(n);if(n)return-(i.M_LN_SQRT_2PI+.5*e*e+p(r));if(e<5)return i.M_1_SQRT_2PI*c(-.5*e*e)/r;if(e>f(-2*i.M_LN2*(i.DBL_MIN_EXP+1-i.DBL_MANT_DIG)))return 0;let h=i.ldexp(d(i.ldexp(e,16)),-16),g=e-h;return i.M_1_SQRT_2PI/r*(c(-.5*h*h)*c((-.5*g-h)*g))});return 1===g.length?g[0]:g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(28),o=r(2),s=r(161),{trunc:u,log:l,abs:f,pow:c,exp:_,floor:d,sqrt:p}=Math,{isFinite:m}=Number,h=o.seq()();t.rpois=function(e,t,r){return o.map(h(e))(()=>function(e,t){const r=[1,1,2,6,24,120,720,5040,40320,362880];let n,o,h,b,N,v,M,R,y,I,E=0,w=0,P=new Array(36),x=0,A=0,O=0,T=0,L=0,S=0,q=0,D=0,C=0,j=0,F=0,k=0,V=0,B=0,Q=0,G=0,U=0,H=0,Y=0,W=0,z=0,K=-1,X=0,J=!1;if(!m(e)||e<0)return i.ML_ERR_return_NAN(g);if(e<=0)return 0;if(I=e>=10,I&&(J=!1),!I||e!==Q)if(I)J=!0,Q=e,F=p(e),k=6*e*e,B=d(e-1.1484);else for(e!==Q&&(Q=e,w=i.imax2(1,u(e)),E=0,j=D=C=_(-e));;){if(z=t.unif_rand(),z<=D)return 0;if(0!==E){for(y=z<=.458?1:i.imin2(E,w);y<=E;y++)if(z<=P[y])return y;if(35===E)continue}for(E++,y=E;y<=35;y++)if(C*=e/y,j+=C,P[y]=j,z<=j)return E=y,y;E=35}if(b=e+F*t.norm_rand(),b>=0){if(K=d(b),K>=B)return K;if(Y=K,U=e-Y,z=t.unif_rand(),k*z>=U*U*U)return K}(J||e!==G)&&(G=e,V=i.M_1_SQRT_2PI/F,x=.041666666666666664/e,A=.3*x*x,q=.14285714285714285*x*A,S=A-15*q,L=x-6*A+45*q,T=1-x+3*A-15*q,O=.1069/e);let $=!1,Z=!0;for(;;)if(Z&&(Z=!1,b>=0&&(X=0,$=!0)),$||(H=a.exp_rand(t.unif_rand),z=2*t.unif_rand()-1,W=1.8+s.fsign(H,z>=0)),W>-.6744||$)if($||(K=d(e+F*W),Y=K,U=e-Y,X=1),$=!1,K<10?(N=-e,v=c(e,K)/r[u(K)]):(n=.08333333333333333/Y,n*=1-4.8*n*n,M=U/Y,N=f(M)<=.25?Y*M*M*(((((((.125006*M-.1384794)*M+.1421878)*M-.1661269)*M+.2000118)*M-.2500068)*M+.3333333)*M-.5)-n:Y*l(1+M)-U-n,v=i.M_1_SQRT_2PI/p(Y)),R=(.5-U)/F,R*=R,o=-.5*R,h=V*(((q*R+S)*R+L)*R+T),X>0){if(O*f(z)<=v*_(N+H)-h*_(o+H))break}else if(h-z*h<=v*_(N-o))break;return K}(t,r))};const g=n("_rpois")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(23);t.cospi=n.cospi;var i=r(24);t.sinpi=i.sinpi;var a=r(76);t.tanpi=a.tanpi,t.atanpi=a.atanpi},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(106),i=r(11),a=r(53),o=r(54),s=r(12),u=r(35),l=r(55),f=r(56),c=r(13),_=r(41),d=r(2),p=r(8),m=r(107);t.special={beta:n.beta,lbeta:i.lbeta},t.Beta=function(e=new p.Inversion){return Object.freeze({dbeta:function(e,t,r,n,i){return void 0===n||0===n?a.dbeta(e,t,r,i||!1):o.dnbeta(e,t,r,n||0,i||!1)},pbeta:function(e,t,r,n,i=!0,a=!1){return void 0===n||0===n?s.pbeta(e,t,r,i,a):u.pnbeta(e,t,r,n,i,a)},qbeta:function(e,t,r,n,i=!0,a=!1){return void 0===n?l.qbeta(e,t,r,i,a):f.qnbeta(e,t,r,n,i,a)},rbeta:function(t,r,n,i=0){if(0===i)return m.rbeta(t,r,n,e);{let a=_.rnchisq(t,2*r,i,e),o=c.rchisq(t,2*n,e),s=d.multiplexer(a,o)((e,t)=>e/(e+t));return 1===s.length?s[0]:s}}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(4),o=r(9),{log1p:s,floor:u,max:l,sqrt:f,log:c,exp:_}=Math,{isNaN:d}=Number,p=n("pnbeta_raw"),m=n("pnbeta2");function h(e,t,r,n,d,h,g){let b=function(e,t,r,n,d){let m,h,g,b,N,v,M,R,y,I,E=new o.NumberW(0),w=new o.NumberW(0),P=new o.NumberW(0);if(d<0||r<=0||n<=0)return i.ML_ERR_return_NAN(p);if(e<0||t>1||0===e&&1===t)return 0;if(e>1||t<0||1===e&&0===t)return 1;g=d/2,N=u(l(g-7*f(g),0)),m=r+N,h=a.lgammafn(m)+a.lgammafn(n)-a.lgammafn(m+n),o.Toms708.bratio(m,n,e,t,E,w,P),R=_(m*c(e)+n*(e<.5?s(-e):c(t))-h-c(m)),y=_(m>r?-g+N*c(g)-a.lgammafn(N+1):-g),I=1-y,v=M=y*E.val;let x=u(N);do{x++,E.val-=R,R*=e*(r+n+x-1)/(r+x),y*=g/x,I-=y,M=E.val*y,v+=M,b=(E.val-R)*I}while(b>1e-9&&x<1e4+N);return b>1e-9&&i.ML_ERROR(i.ME.ME_PRECISION,"pnbeta",p),x>=1e4+N&&i.ML_ERROR(i.ME.ME_NOCONV,"pnbeta",p),v}(e,t,r,n,d);return h?g?c(b):b:(b>1-1e-10&&i.ML_ERROR(i.ME.ME_PRECISION,"pnbeta",m),b>1&&(b=1),g?s(-b):1-b)}t.pnbeta2=h,t.pnbeta=function(e,t,r,n,a,o){const s=(Array.isArray(e)?e:[e]).map(e=>{if(d(e)||d(t)||d(r)||d(n))return e+t+r+n;let s=i.R_P_bounds_01(a,o,e,0,1);return void 0!==s?s:h(e,1-e,t,r,n,a,o)});return 1===s.length?s[0]:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(59),{log:s,abs:u,abs:l,sqrt:f,min:c,trunc:_,round:d}=Math,{MAX_SAFE_INTEGER:p,isFinite:m}=Number,h=a.seq()(),g=n("_rbinom");t.rbinom=function(e,t,r,n){return a.map(h(e))(()=>function(e,t,r){let n,a,h,b,N,v,M,R,y,I,E,w,P,x,A,O,T,L,S,q,D,C,j,F,k,V=0,B=0,Q=0,G=0,U=0,H=0,Y=0,W=0,z=0,K=0,X=0,J=0,$=0,Z=-1,ee=-1,te=0,re=0;if(!m(e))return i.ML_ERR_return_NAN(g);if(T=d(e),T!==e)return i.ML_ERR_return_NAN(g);if(!m(t)||T<0||t<0||t>1)return i.ML_ERR_return_NAN(g);if(0===T||0===t)return 0;if(1===t)return T;if(T>=p)return g("Evade overflow:%d > MAX_SAFE_INTEGER",T),o.qbinom(r.unif_rand(),T,t,!1,!1);k=_(T),P=c(t,1-t),x=1-P,A=k*P,T=P/x,O=T*(k+1);let ne=!1;t!==Z||k!==ee?(Z=t,ee=k,A<30?(W=i.R_pow_di(x,k),ne=!0):(D=A+P,te=_(D),B=te,Q=A*x,G=_(2.195*f(Q)-4.6*x)+.5,J=B+.5,z=J-G,$=J+G,V=.134+20.5/(15.3+B),L=(D-z)/(D-z*P),K=L*(1+.5*L),L=($-D)/($*x),X=L*(1+.5*L),U=G*(1+V+V),H=U+V/K,Y=H+V/X)):k===ee&&A<30&&(ne=!0);let ie=!1;for(;!ne;){if(b=r.unif_rand()*Y,N=r.unif_rand(),b<=G){re=_(J-G*N+b),ie=!0;break}if(b<=U){if(R=z+(b-G)/V,N=N*V+1-u(J-R)/G,N>1||N<=0)continue;re=_(R)}else if(b>H){if(re=_($-s(N)/X),re>k)continue;N=N*(b-H)*X}else{if(re=_(z+s(N)/K),re<0)continue;N=N*(b-U)*K}if(F=l(re-te),F<=20||F>=Q/2-1){if(n=1,te<re)for(j=te+1;j<=re;j++)n*=O/j-T;else if(te!==re)for(j=re+1;j<=te;j++)n/=O/j-T;if(N<=n){ie=!0;break}}else{if(q=F/Q*((F*(F/3+.625)+.1666666666666)/Q+.5),C=-F*F/(2*Q),S=s(N),S<C-q){ie=!0;break}if(S<=C+q&&(y=re+1,a=B+1,E=k+1-B,v=k-re+1,w=E*E,I=y*y,h=a*a,M=v*v,S<=J*s(a/y)+(k-te+.5)*s(E/v)+(re-te)*s(v*P/(y*x))+(13860-(462-(132-(99-140/h)/h)/h)/h)/a/166320+(13860-(462-(132-(99-140/w)/w)/w)/w)/E/166320+(13860-(462-(132-(99-140/I)/I)/I)/I)/y/166320+(13860-(462-(132-(99-140/M)/M)/M)/M)/v/166320)){ie=!0;break}}}if(!ie)for(;;){for(re=0,n=W,b=r.unif_rand();;){if(b<n){ie=!0;break}if(re>110)break;b-=n,re++,n*=O/re-T}if(ie)break}return Z>.5&&(re=k-re),re}(t,r,n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{abs:a}=Math,o=n("chebyshev_eval");t.chebyshev_init=function(e,t,r){let n,i=0;if(t<1)return 0;n=0;for(let o=1;o<=t;o++)if(i=t-o,n+=a(e[i]),n>r)return i;return i},t.chebyshev_eval=function(e,t,r){let n,a,s,u,l;if(r<1||r>1e3)return i.ML_ERR_return_NAN(o);if(e<-1.1||e>1.1)return i.ML_ERR_return_NAN(o);for(u=2*e,s=a=0,n=0,l=1;l<=r;l++)s=a,a=n,n=u*a-s+t[r-l];return.5*(n-s)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(18);t.pchisq=function(e,t,r=!0,i=!1){return n.pgamma(e,t/2,2,r,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(4),s=r(127),u=r(2),l=r(38),{sqrt:f,abs:c,exp:_,log:d,min:p,max:m,LN2:h,LN10:g}=Math,{isNaN:b,isFinite:N,EPSILON:v,NEGATIVE_INFINITY:M}=Number;t.DBL_MAX_EXP=Math.log2(Number.MAX_VALUE),t.DBL_MIN_EXP=Math.log2(Number.MIN_VALUE);const R=h*t.DBL_MIN_EXP,{expm1:y,log1p:I}=Math,E=n("pnchisq");function w(e,t,r,n,u,p,m,g){let b,I,w,P,x,A,O,T,L,S,q,D,C,j,F,k,V,B,Q=-1,G=-1,U=-1;if(e<=0){if(0===e&&0===t){const e=-.5*r,t=m?i.R_D_exp(g,e):g?a.R_Log1_Exp(e):-y(e);return E("result1:%d",t),t}return i.R_DT_0(m,g)}if(!N(e))return i.R_DT_1(m,g);if(r<80){let n,i;if(m&&t>0&&d(e)<h+2/t*(o.lgammafn(t/2+1)+R)){let a=.5*r,o=M,u=M,f=-a;for(i=0;i<110&&(u=s.logspace_add(u,f),o=s.logspace_add(o,f+l.pchisq(e,t+2*i,m,!0)),!(u>=-1e-15));f+=d(a)-d(++i));return n=o-u,E("pnchisq(x=%d, f=%d, th.=%d); th. < 80, logspace: i=%d, ans=(sum=%d)-(sum2=%d)",e,t,r,i,o,u),g?n:_(n)}{let a=.5*r,o=0,s=0,u=_(-a);for(i=0;i<110&&(s+=u,o+=u*l.pchisq(e,t+2*i,m,!1),!(s>=1-1e-15));u*=a/++i);return n=o/s,E("pnchisq(x=%d, f=%d, theta=%d); theta < 80: i=%d, sum=%d, sum2=%d",e,t,r,i,o,s),g?d(n):n}}if(E("pnchisq(x=%d, f=%d, theta=%d >= 80): ",e,t,r),b=.5*r,T=-b<R,T?(j=0,U=-b,Q=d(b)):j=_(-b),F=j,I=.5*e,w=.5*t,A=t-e,E("-- v=exp(-th/2)=%d, x/2= %d, f/2= %d",F,I,w),w*v>.125&&c(k=I-w)<f(v)*w?(V=(1-k)*(2-k/(w+1))-i.M_LN_SQRT_2PI-.5*d(w+1),E(" (case I) === > ")):V=w*d(I)-I-o.lgammafn(w+1),E(" lt= %d",V),L=V<R,L){if(E(" is very small"),e>t+r+5*f(2*(t+2*r)))return i.R_DT_1(m,g);G=d(e),C=P=0,k=0}else k=_(V),E(", t=exp(lt)= %d",k),P=F*k,C=P;for(B=1,O=t+2,A+=2;;B++,O+=2,A+=2){if(E(" _OL_: n=%d",B),A>0&&(x=k*e/A,E(" L10: n=%d; term= %d; bound= %d",B,P,x),S=D=!1,(q=x<=n)&&(S=P<=u*C)||(D=B>p))){E("BREAK n=%d %s; bound= %d %s, rel.err= %d %s",B,D?"> itrmax":"",x,q?"<= errmax":"",P/C,S?"<= reltol":"");break}T?(U+=Q-d(B),U>=R&&(E(" n=%d; nomore underflow in u = exp(lu) === > change",B),F=j=_(U),T=!1)):(j*=b/B,F+=j),L?(V+=G-d(O),V>=R&&(E("  n=%d; nomore underflow in t = exp(lt) === > change",B),k=_(V),L=!1)):k*=e/O,T||L||(P=F*k,C+=P)}return D&&E("pnchisq(x=%d, ..): not converged in %d iter.",e,p),E(" ===  L_End: n=%d; term= %d; bound=%d",B,P,x),i.R_DT_val(m,g,C)}t.pnchisq=function(e,t,r=0,n=!0,a=!1){return u.map(e)(e=>{let o;return b(e)||b(t)||b(r)?NaN:N(t)&&N(r)?t<0||r<0?i.ML_ERR_return_NAN(E):(o=w(e,t,r,1e-12,8*v,1e6,n,a),r>=80&&(n?o=p(o,i.R_D__1(a)):(o<(a?-10*g:1e-10)&&i.ML_ERROR(i.ME.ME_PRECISION,"pnchisq",E),a||(o=m(o,0)))),!a||o<-1e-8?o:(E("   pnchisq_raw(*, log_p): ans=%d => 2nd call, other tail",o),o=w(e,t,r,1e-12,8*v,1e6,!n,!1),I(-o))):i.ML_ERR_return_NAN(E)})},t.pnchisq_raw=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(68);t.qchisq=function(e,t,r=!0,i=!1){return n.qgamma(e,.5*t,2,r,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(30),o=r(32),s=r(13),u=n("rnchisq"),{isFinite:l}=Number;t.rnchisq=function(e,t,r,n){const f=new Array(e).fill(0).map(()=>{if(!l(t)||!l(r)||t<0||r<0)return i.ML_ERR_return_NAN(u);if(0===r)return 0===t?0:a.rgamma(1,t/2,2,n);{let e=o.rpois(1,r/2,n);return e>0&&(e=s.rchisq(1,2*e,n)),t>0&&(e+=a.rgamma(1,t/2,2,n)),e}});return 1===f.length?f[0]:f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(37),a=r(0),o=n("lgammacor"),s=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46];t.lgammacor=function(e){let t;if(e<10)return a.ML_ERR_return_NAN(o);if(e>=3745194030963158e291)a.ML_ERROR(a.ME.ME_UNDERFLOW,"lgammacor",o);else if(e<94906265.62425156)return t=10/e,i.chebyshev_eval(t*t*2-1,s,5)/e;return 1/(12*e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{isNaN:o,isFinite:s}=Number,u=n("rnorm"),l=a.seq()();t.rnorm=function(e=1,t=0,r=1,n){let f=a.multiplexer(l(e))(()=>o(t)||!s(r)||r<0?i.ML_ERR_return_NAN(u):0!==r&&s(t)?t+r*n.norm_rand():t);return 1===f.length?f[0]:f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(74);t.stirlerr=n.stirlerr},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(64),o=r(31),s=r(2),u=r(74),{log1p:l,abs:f,exp:c,log:_,sqrt:d}=Math,{isNaN:p,EPSILON:m,isFinite:h}=Number,g=n("dt");t.dt=function(e,t,r=!1){return s.map(e)(e=>{if(p(e)||p(t))return e+t;if(t<=0)return i.ML_ERR_return_NAN(g);if(!h(e))return i.R_D__0(r);if(!h(t))return o.dnorm4(e,0,1,r);let n,s,b=-a.bd0(t/2,(t+1)/2)+u.stirlerr((t+1)/2)-u.stirlerr(t/2),N=e*e/t,v=0,M=N>1/m;if(M?(v=f(e),s=_(v)-_(t)/2,n=t*s):N>.2?(s=_(1+N)/2,n=t*s):(s=l(N)/2,n=-a.bd0(t/2,(t+e*e)/2)+e*e/2),r)return b-n-(i.M_LN_SQRT_2PI+s);let R=M?d(t)/v:c(-s);return c(b-n)*i.M_1_SQRT_2PI*R})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(12),a=r(0),o=r(4),s=r(19),u=r(2),l=r(47),{isFinite:f,EPSILON:c}=Number,{sqrt:_,exp:d,pow:p,log:m,expm1:h,abs:g,min:b}=Math,N=n("pnt"),v=.6931471805599453;t.pnt=function(e,t,r,n=!0,M=!1){return u.map(e)(e=>function(e,t,r,n=!0,u=!1){let M,R,y,I,E,w,P,x,A,O,T=0;if(t<=0)return a.ML_ERR_return_NAN(N);if(0===r)return l.pt(e,t,n,u);if(!f(e))return e<0?a.R_DT_0(n,u):a.R_DT_1(n,u);const L=e<0,S=g(e),q=e>=0?r:-r;if(e<0&&r>40&&(!u||!n))return N("if x <=0 and solution for edge ncp > 40"),a.R_DT_0(n,u);if(t>4e5||q*q>2*v*1021){N("Abramowitz & Stegun 26.7.10 ncp:%d, del:%d, ncp2:%d, del2:%d, D:%d",r,q,r*r,q*q,2*v*1021);const e=1/(4*t);return s.pnorm5(S*(1-e),q,_(1+S*S*2*e),n!==L,u)}if(y=e*e,R=t/(y+t),y/=y+t,N("pnt(t=%d, df=%d, ncp=%d, rxb=%d) ==> x= %d",e,t,r,R,y),y>0){N("x > 0 branch");const e=q*q;if(w=.5*d(-.5*e),N("p=%d",w),0===w)return N("p=%d, underflow protection",w),a.ML_ERROR(a.ME.ME_UNDERFLOW,"pnt",N),a.ML_ERROR(a.ME.ME_RANGE,"pnt",N),a.R_DT_0(n,u);N("it  1e5*(godd,   geven)|          p           q           s        pnt(*)     errbd"),P=a.M_SQRT_2dPI*w*q,x=.5-w,x<1e-7&&(x=-.5*h(-.5*e));let r=.5,s=.5*t;R=p(R,s);const l=a.M_LN_SQRT_PI+o.lgammafn(s)-o.lgammafn(.5+s);O=i.pbeta(y,r,s,!0,!1),N("return from pbeta:%d",O),E=2*R*d(r*m(y)-l),T=s*y,A=T<c?T:1-R,I=T*R,T=w*O+P*A;let f=!1;for(let t=1;t<=1e3;t++){if(r+=1,O-=E,A-=I,E*=y*(r+s-1)/r,I*=y*(r+s-.5)/(r+.5),w*=e/(2*t),P*=e/(2*t+1),T+=w*O+P*A,x-=w,x<-1e-10){a.ML_ERROR(a.ME.ME_PRECISION,"pnt",N),N("goto:true, s = %d < 0 !!! ---\x3e non-convergence!!",x),f=!0;break}if(x<=0){N("goto:true, s:%d < 0 && it:%d>1",x,t),f=!0;break}if(M=2*x*(O-E),N("%d %d %d|%d %d %d %d %d",t,1e5*E,1e5*I,w,P,x,T,M),g(M)<1e-12){N("goto:true, errbd:%d < errmax:%d",M,1e-12),f=!0;break}f=!1}f||a.ML_ERROR(a.ME.ME_NOCONV,"pnt",N)}T+=s.pnorm5(-q,0,1,!0,!1),n=n!==L,T>1-1e-10&&n&&a.ML_ERROR(a.ME.ME_PRECISION,"pnt{final}",N);const D=a.R_DT_val(n,u,b(T,1));return N("rc:%d, tnc:%d, log_p:%s, lower_tail:%s",D,T,u,n),D}(e,t,r,n,M))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(11),a=r(12),o=r(0),s=r(19),u=r(2),{log1p:l,sqrt:f,log:c,abs:_,exp:d}=Math,{isNaN:p,isFinite:m}=Number,h=n("pt");t.pt=function(e,t,r=!0,n=!1){return u.map(e)(e=>{let u,g,b=r;if(p(e)||p(t))return e+t;if(t<=0)return o.ML_ERR_return_NAN(h);if(!m(e))return e<0?o.R_DT_0(b,n):o.R_DT_1(b,n);if(!m(t))return s.pnorm5(e,0,1,b,n);if(t>4e5)return u=1/(4*t),s.pnorm5(e*(1-u)/f(1+e*e*2*u),0,1,b,n);if(g=1+e/t*e,g>1e100){let r;r=-.5*t*(2*c(_(e))-c(t))-i.internal_lbeta(.5*t,.5)-c(.5*t),u=n?r:d(r)}else u=t>e*e?a.pbeta(e*e/(t+e*e),.5,t/2,!1,n):a.pbeta(1/g,t/2,.5,!0,n);return e<=0&&(b=!b),n?b?l(-.5*d(u)):u-o.M_LN2:(u/=2,o.R_D_Cval(b,u))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WilcoxonCache=class{constructor(){this._map2={}}get(e,t,r){const n=this._map2[e];if(void 0!==n){const e=n[t];if(void 0!==e)return e[r]}}set(e,t,r,n){let i=this._map2[e];void 0===i&&(i={},this._map2[e]=i);let a=i[t];void 0===a&&(a={},i[t]=a),a[r]=n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{trunc:n}=Math;t.cwilcox=function e(t,r,i,a){let o,s;const u=r*i,l=n(u/2);if(t<0||t>u)return 0;if(t>l&&(t=u-t),r<i?(o=r,s=i):(o=i,s=r),s>0&&t<s)return e(t,o,t,a);if(void 0===a.get(o,s,t))if(0===s)a.set(o,s,t,0===t?1:0);else{const r=e(t-s,o-1,s,a),n=e(t,o,s-1,a);a.set(o,s,t,r+n)}const f=a.get(o,s,t);if(void 0===f)throw new Error("WilcoxonCache not set");return f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(23),s=r(24),u=r(52),l=r(103),{isNaN:f}=Number,{floor:c,trunc:_}=Math,d=n("bessel_j");function p(e,t){let r,n;if(f(e)||f(t))return e+t;if(e<0)return i.ML_ERROR(i.ME.ME_RANGE,"bessel_j",d),NaN;if(n=c(t),t<0)return(t-n==.5?0:p(e,-t)*o.cospi(t))+(t===n?0:u.internal_bessel_y(e,-t)*s.sinpi(t));if(t>1e7)return d("besselJ(x, nu): nu=%d too large for bessel_j() algorithm",t),NaN;r=1+_(n),t-=r-1;const a=l.J_bessel(e,t,r);return a.ncalc!==r&&(a.ncalc<0?d("bessel_j(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?",e,a.ncalc,a.nb,t):d("bessel_j(%d,nu=%d): precision lost in result",e,t+r-1)),e=a.x}t.bessel_j=function(e,t){return a.multiplexer(e,t)((e,t)=>p(e,t))},t.internal_bessel_j=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(104),{isNaN:s}=Number,{floor:u}=Math,l=n("bessel_k");function f(e,t,r=!1){let n,a;if(s(e)||s(t))return e+t;if(e<0)return i.ML_ERROR(i.ME.ME_RANGE,"bessel_k",l),NaN;a=r?2:1,t<0&&(t=-t),n=1+u(t),t-=n-1;const f=o.K_bessel(e,t,n,a);return f.ncalc!==f.nb&&(f.ncalc<0?l("bessel_k(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?\n",f.x,f.ncalc,f.nb,t):l("bessel_k(%d,nu=%d): precision lost in result\n",f.x,t+f.nb-1)),e=f.x}t.bessel_k=function(e,t,r){return a.multiplexer(e,t,r)((e,t,r)=>f(e,t,r))},t.internal_bessel_k=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(23),s=r(24),u=r(50),l=r(105),{floor:f}=Math,{isNaN:c,POSITIVE_INFINITY:_}=Number,d=n("bessel_y");function p(e,t){if(c(e)||c(t))return e+t;if(e<0)return i.ML_ERROR(i.ME.ME_RANGE,"bessel_y",d),NaN;const r=f(t);if(t<0)return(t-r==.5?0:p(e,-t)*o.cospi(t))-(t===r?0:u.internal_bessel_j(e,-t)*s.sinpi(t));if(t>1e7)return d("besselY(x, nu): nu=%d too large for bessel_y() algorithm",t),NaN;const n=1+r;t-=n-1;const a=l.Y_bessel(e,t,n);if(a.ncalc!==n){if(-1===a.ncalc)return _;a.ncalc<-1?d("bessel_y(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?\n",a.x,a.ncalc,n,t):d("bessel_y(%d,nu=%d): precision lost in result\n",a.x,t+n-1)}return e=a.x}t.bessel_y=function(e,t){return a.multiplexer(e,t)((e,t)=>p(e,t))},t.internal_bessel_y=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(17),o=r(2),s=r(11),{log:u,log1p:l}=Math,{isNaN:f,isFinite:c,POSITIVE_INFINITY:_}=Number,d=n("dbeta");t.dbeta=function(e,t,r,n){return o.multiplexer(e,t,r,n)((e,t,r,n)=>{if(f(e)||f(t)||f(r))return e+t+r;if(t<0||r<0)return i.ML_ERR_return_NAN(d);if(e<0||e>1)return i.R_D__0(n);if(0===t||0===r||!c(t)||!c(r))return 0===t&&0===r?0===e||1===e?_:i.R_D__0(n):0===t||t/r==0?0===e?_:i.R_D__0(n):0===r||r/t==0?1===e?_:i.R_D__0(n):.5===e?_:i.R_D__0(n);if(0===e)return t>1?i.R_D__0(n):t<1?_:i.R_D_val(n,r);if(1===e)return r>1?i.R_D__0(n):r<1?_:i.R_D_val(n,t);let o;return o=t<=2||r<=2?(t-1)*u(e)+(r-1)*l(-e)-s.internal_lbeta(t,r):u(t+r-1)+a.dbinom_raw(t-1,t+r-2,e,1-e,!0),i.R_D_exp(n,o)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(22),o=r(2),s=r(53),{log:u,sqrt:l,ceil:f}=Math,{isNaN:c,isFinite:_}=Number,d=n("dnbeta");t.dnbeta=function(e,t,r,n,p){return o.multiplexer(e,t,r,n,p)((function(e,t,r,n,o){return function(e,t,r,n,o){let p,m,h,g,b,N,v,M,R,y;if(c(e)||c(t)||c(r)||c(n))return e+t+r+n;if(n<0||t<=0||r<=0)return i.ML_ERR_return_NAN(d);if(!_(t)||!_(r)||!_(n))return i.ML_ERR_return_NAN(d);if(e<0||e>1)return i.R_D__0(o);if(0===n)return s.dbeta(e,t,r,o);if(h=.5*n,g=h*e,b=(g-t-1)/2,N=b*b+g*(t+r)-t,N<=0?p=0:(N=f(b+l(N)),p=N>0?N:0),v=s.dbeta(e,t+p,r,!0),R=a.dpois_raw(p,h,!0),0===e||!_(v)||!_(R))return i.R_D_exp(o,R+v);for(R+=v,M=v=1,m=p;m>0&&v>1e-15*M;)m--,y=(m+1)*(m+t)/(m+t+r)/g,v*=y,M+=v;v=1,m=p;do{y=g*(m+t+r)/(m+t)/(m+1),m++,v*=y,M+=v}while(v>1e-15*M);return i.R_D_exp(o,R+u(M))}(e,t,r,n,o)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(11),s=r(12),{expm1:u,log1p:l,sqrt:f,min:c,exp:_,abs:d,log:p,pow:m,max:h}=Math,{isNaN:g,MIN_VALUE:b,EPSILON:N,POSITIVE_INFINITY:v,NEGATIVE_INFINITY:M,isFinite:R,NaN:y}=Number,I=n("qbeta");t.qbeta=function(e,t,r,n,a){const o=(Array.isArray(e)?e:[e]).map(e=>{if(g(t)||g(r)||g(e))return t+r+e;if(t<0||r<0)return i.ML_ERR_return_NAN(I);let o=[0,0];return S(e,t,r,n,a,-1,-5,4,o),o[0]});return 1===o.length?o[0]:o};const E=b/4,w=i.M_LN2*(i.DBL_MIN_EXP-2),P=1-N;function x(e,t){e?(t[0]=M,t[1]=0):(t[0]=0,t[1]=1)}function A(e,t){e?(t[0]=0,t[1]=M):(t[0]=1,t[1]=0)}function O(e,t){t[0]=t[1]=e?-i.M_LN2:.5}const T=n("qbeta_raw"),L=T;function S(e,t,r,n,g,N,I,S,q){let D,C,j,F,k,V,B,Q,G,U,H,Y,W,z,K,X,J=-1===N,$=I===v,Z=$,ee=!1,te=!0,re=-1,ne=0,ie=0,ae=0;if(e===i.R_DT_0(n,g))return x($,q);if(e===i.R_DT_1(n,g))return A($,q);if(g&&e>0||!g&&(e<0||e>1))return T("qbeta(alpha=%d, %d, %d, .., log_p=%d): %s%s",e,t,r,g,"alpha not in ",g?"[-Inf, 0]":"[0,1]"),i.ML_ERROR(i.ME.ME_DOMAIN,"",T),void(q[0]=q[1]=y);0!==t&&0!==r&&R(t)&&R(r)||(T("qbeta(%d, %d, %d, lower_t=%d, log_p=%d): (p,q)-boundary: trivial",e,t,r,n,g),0===t&&0===r&&(e<i.R_D_half(g)&&x($,q),e>i.R_D_half(g)&&A($,q),O($,q))),H=a.R_DT_qIv(n,g,e),B=o.lbeta(t,r),D=J?H>.5:N,D?(k=a.R_DT_CIv(n,g,e),V=a.R_DT_Clog(n,g,e),U=r,Y=t):(k=H,V=a.R_DT_log(n,g,e),U=t,Y=r);let oe=h(1e-300,m(10,-13-2.5/(U*U)-.5/(k*k))),se=0,ue=(V+p(U)+B)/U,le=i.M_LN2*(1-i.DBL_MANT_DIG);W=U*(1-Y)/(U+1),K=.2,T("qbeta(%d, %d, %d, lower_t=%d, log_p=%d):%s   swap_tail=%d, la=%d, u0=%d (bnd: %d (%d)) ",e,t,r,n,g,!g||0!==H&&1!==H?"":0===H?" p_=0":" p_=1",D,V,ue,(K*le-p(d(U*(1-Y)*(2-Y)/(2*(U+2)))))/2,K*le-p(d(W)));let fe=!1,ce=!1,_e=!1;if(i.M_LN2*i.DBL_MIN_EXP<ue&&ue<-.01&&ue<(K*le-p(d(U*(1-Y)*(2-Y)/(2*(U+2)))))/2&&(W*=_(ue),W>-1?(ne=ue-l(W)/U,T("u1-u0=%d --\x3e choosing u = u1",ne-ue)):(ne=ue,T("cannot cheaply improve u0")),se=ie=_(ne),Z=!0,fe=!0),!fe){if(W=f(-2*V),re=W-(2.30753+.27061*W)/(1+(.99229+.04481*W)*W),U>1&&Y>1)W=(re*re-3)/6,z=1/(U+U-1),K=1/(Y+Y-1),G=2/(z+K),X=re*f(G+W)/G-(K-z)*(W+5/6-2/(3*G)),T("p,q > 1 => w=%d",X),X>300?(K=X+X+p(Y)-p(U),ne=K<=18?-l(_(K)):-K-_(-K),ie=_(ne)):(ie=U/(U+Y*_(X+X)),ne=-l(Y/U*_(X+X)));else if(W=Y+Y,K=1/(3*f(Y)),K=W*i.R_pow_di(1+K*(-K+re),3),z=4*U+W-2,L("min(p,q) <= 1: t=%g",K),0===K||K<0&&z>=K){let t;t=D?a.R_DT_log(n,g,e):a.R_DT_Clog(n,g,e),L(" t <= 0 : log1p(-a)=%.15g, better l1ma=%.15g\n",l(-k),t);let r=(t+p(Y)+B)/Y;r<=0?(ie=-u(r),ne=a.R_Log1_Exp(r)):(L(" xx=%g > 0: xinbta:= 1-e^xx < 0\n",r),ie=0,ne=M)}else K=z/K,L(" t > 0 or s < t < 0:  new t = %g ( > 1 ?)\n",K),K<=1?(ne=(V+p(U)+B)/U,ie=_(ne)):(ie=1-2/(K+1),ne=l(-2/(K+1)));J&&(D&&ne>=-_(I)||!D&&ne>=-_(4*I)&&U/Y<1e3)&&(D=!D,L(" u = %g (e^u = xinbta = %.16g) ==> ",ne,ie),D?(k=a.R_DT_CIv(n,g,e),V=a.R_DT_Clog(n,g,e),U=r,Y=t):(k=H,V=a.R_DT_log(n,g,e),U=t,Y=r),L("\"%s'; la = %g\n",D?"swap now":"swap back",V),ne=a.R_Log1_Exp(ne),ie=_(ne)),Z||(Z=ne<I);let o=!R(ne),c=o||ie>1-222e-18;L(" -> u = %g, e^u = xinbta = %.16g, (Newton acu=%g%s)\n",ne,ie,oe,o?", ** bad u **":Z?", on u = log(x) scale":""),ae=1,se=ie,(o||ne<I)&&(X=s.pbeta_raw(E,U,Y,!0,g),X>(g?V:k)?(L(' quantile is left of smallest positive number; "convergence"\n'),g||d(X-k)<d(0-k)?(se=E,ae=w):(se=0,ae=M),Z=g,te=!1,ce=!0):(L(" pbeta(smallest pos.) = %g <= %g  --\x3e continuing\n",X,g?V:k),ne<w&&(ne=w,ie=E))),!c||Z&&se>0||(ne===M?(L("  u = -Inf;"),ne=i.M_LN2*i.DBL_MIN_EXP,ie=b):(L(" bad_init: u=%g, xinbta=%g;",ne,ie),ie=ie>1.1?.5:ie<3e-308?_(ne):1-222e-18,o&&(ne=p(ie))),L(" -> (partly)new u=%g, xinbta=%g\n",ne,ie))}if(!ce){W=1-U,K=1-Y;let e=0,t=1,r=1;if(Z)for(j=0;j<1e3&&(re=s.pbeta_raw(ie,U,Y,!0,!0),X=re===M?0:(re-V)*_(re-ne+B+W*ne+K*a.R_Log1_Exp(ne)),R(X));j++){for(j>=S&&X*e<=0&&(t=h(d(r),3e-308)),L("N(i=%2d): u=%#20.16g, pb(e^u)=%#12.6g, w=%#15.9g, %s prev=%11g,",j,ne,re,X,X*e<=0?"new":"old",t),Q=1,F=0;F<1e3;F++){if(r=Q*X,(j<S||d(r)<t)&&(ae=ne-r,ae<=0)){if(t<=oe||d(X)<=oe){L(" it{in}=%d, -adj=%g, %s <= acu  ==> convergence\n",F,-r,t<=oe?"prev":"|w|"),_e=!0;break}break}Q/=3}if(_e)break;let n=c(d(r),d(ae-ne));if(L(" it{in}=%d, delta(u)=%9.3g, D/|.|=%.3g\n",F,ae-ne,n/d(ae+ne)),n<=4e-16*d(ae+ne)){_e=!0;break}ne=ae,ie=_(ne),e=X}else for(j=0;j<1e3;j++){if(re=s.pbeta_raw(ie,U,Y,!0,g),!(R(re)||g&&re===M))return i.ML_ERROR(i.ME.ME_DOMAIN,"",T),void(q[0]=q[1]=y);for(X=g?(re-V)*_(re+B+W*p(ie)+K*l(-ie)):(re-k)*_(B+W*p(ie)+K*l(-ie)),j>=S&&X*e<=0&&(t=h(d(r),3e-308)),L("N(i=%2d): x0=%d, pb(x0)=%d, w=%d, %s prev=%d,",j,ie,re,X,X*e<=0?"new":"old",t),Q=1,F=0;F<1e3;F++){if(r=Q*X,(j<S||d(r)<t)&&(se=ie-r,0<=se&&se<=1)){if(t<=oe||d(X)<=oe){L(" it{in}=%d, delta(x)=%g, %s <= acu  ==> convergence\n",F,-r,t<=oe?"prev":"|w|"),_e=!0;break}if(0!==se&&1!==se)break}Q/=3}if(_e)break;if(L(" it{in}=%d, delta(x)=%g\n",F,se-ie),d(se-ie)<=4e-16*(se+ie)){_e=!0;break}if(ie=se,0===se)break;e=X}_e||(ee=!0,i.ML_ERROR(i.ME.ME_PRECISION,"qbeta",T)),C=g||Z,L(" %s: Final delta(y) = %g%s\n",ee?"_NO_ convergence":"converged",re-(C?V:k),C?" (log_)":""),C&&re===M||!C&&0===re?(X=s.pbeta_raw(E,U,Y,!0,C),(C||d(X-k)<=d(re-k))&&(se=E,ae=w),te=!1):!ee&&(C?d(re-V)>3:d(re-k)>1e-4)&&(C&&re===M&&s.pbeta_raw(P,U,Y,!0,!0)>V+2||T("qbeta(a, *) =: x0 with |pbeta(x0,* %s) - alpha| = %d is not accurate",C?", log_":"",d(re-(C?V:k))))}if($){Z||T("qbeta() L_return, u_n=%d;  give_log_q=TRUE but use_log_x=FALSE -- please report!",ae);let e=a.R_Log1_Exp(ae);D?(q[0]=e,q[1]=ae):(q[0]=ae,q[1]=e)}else{if(Z){if(!te)return void(D?(q[0]=-u(ae),q[1]=_(ae)):(q[0]=_(ae),q[1]=-u(ae)));ie=_(ae),re=s.pbeta_raw(ie,U,Y,!0,g),X=g?(re-V)*_(re+B+W*p(ie)+K*l(-ie)):(re-k)*_(B+W*p(ie)+K*l(-ie)),se=ie-X,L("Final Newton correction(non-log scale): xinbta=%.16g, y=%g, w=%g. => new tx=%.16g\n",ie,re,X,se)}D?(q[0]=1-se,q[1]=se):(q[0]=se,q[1]=1-se)}}t.qbeta_raw=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=r(35),{isNaN:u,isFinite:l,MIN_VALUE:f,EPSILON:c}=Number,{min:_}=Math,d=n("qnbeta");t.qnbeta=function(e,t,r,n,p,m){return o.map(e)(e=>{let o,h,g,b;if(u(e)||u(t)||u(r)||u(n))return e+t+r+n;if(!l(t))return i.ML_ERR_return_NAN(d);if(n<0||t<=0||r<=0)return i.ML_ERR_return_NAN(d);let N=i.R_Q_P01_boundaries(p,m,e,0,1);if(void 0!==N)return N;if((e=a.R_DT_qIv(p,m,e))>1-c)return 1;for(b=_(1-c,e*(1+1e-14)),o=.5;o<1-c&&s.pnbeta(o,t,r,n,!0,!1)<b;o=.5*(1+o));for(b=e*(1-1e-14),h=.5;h>f&&s.pnbeta(h,t,r,n,!0,!1)>b;h*=.5);do{g=.5*(h+o),s.pnbeta(g,t,r,n,!0,!1)>e?o=g:h=g}while((o-h)/g>1e-15);return.5*(o+h)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{isNaN:a,isFinite:o}=Number,{floor:s,log:u}=Math,l=r(12),f=r(9),c=n("pnbinom");t.pnbinom=function(e,t,r,n,u){const f=(Array.isArray(e)?e:[e]).map(e=>a(e)||a(t)||a(r)?e+t+r:o(t)&&o(r)?t<0||r<=0||r>1?i.ML_ERR_return_NAN(c):0===t?e>=0?i.R_DT_1(n,u):i.R_DT_0(n,u):e<0?i.R_DT_0(n,u):o(e)?(e=s(e+1e-7),l.pbeta(r,t,e+1,n,u)):i.R_DT_1(n,u):i.ML_ERR_return_NAN(c));return 1===f.length?f[0]:f};const _=n("printer_pnbinom_mu");t.pnbinom_mu=function(e,t,r,n,l){const d=(Array.isArray(e)?e:[e]).map(e=>{if(a(e)||a(t)||a(r))return e+t+r;if(!o(t)||!o(r))return i.ML_ERR_return_NAN(_);if(t<0||r<0)return i.ML_ERR_return_NAN(_);if(0===t)return e>=0?i.R_DT_1(n,l):i.R_DT_0(n,l);if(e<0)return i.R_DT_0(n,l);if(!o(e))return i.R_DT_1(n,l);e=s(e+1e-7);{let i=new f.NumberW(0),a=new f.NumberW(0),o=new f.NumberW(0);return f.Toms708.bratio(t,e+1,t/(t+r),r/(t+r),a,o,i),i&&c("pnbinom_mu() -> bratio() gave error code %d",i.val),l&&(a.val=u(a.val),o.val=u(o.val)),n?a.val:o.val}});return 1===d.length?d[0]:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(12),a=r(0),o=r(2),s=n("pbinom"),{floor:u,round:l}=Math,{isNaN:f,isFinite:c}=Number;t.pbinom=function(e,t,r,n=!0,_=!1){return o.map(e)(e=>{if(f(e)||f(t)||f(r))return NaN;if(!c(t)||!c(r))return a.ML_ERR_return_NAN(s);let o=n,d=_;return a.R_nonint(t)?(s("non-integer n = %d",t),a.ML_ERR_return_NAN(s)):(t=l(t))<0||r<0||r>1?a.ML_ERR_return_NAN(s):e<0?a.R_DT_0(o,d):(e=u(e+1e-7),t<=e?a.R_DT_1(o,d):(s("calling pbeta:(q=%d,a=%d,b=%d, l.t=%s, log=%s",r,e+1,t-e,!o,d),i.pbeta(r,e+1,t-e,!o,d)))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{max:a,min:o,floor:s,sqrt:u}=Math,{isNaN:l,isFinite:f,EPSILON:c}=Number,_=r(9),d=r(3),p=r(6),m=r(2),h=r(58),g=n("do_search");function b(e,t,r,n,i,s){if(t.val>=r)for(g("new z=%o >= p = %d  --\x3e search to left (y--) ..",t,r);;){let o;if(0===e||(o=h.pbinom(e-s,n,i,!0,!1))<r)return e;e=a(0,e-s),t.val=o}else for(g("new z=%d < p = %d  --\x3e search to right (y++) ..",t.val,r);;)if((e=o(e+s,n))===n||(t.val=h.pbinom(e,n,i,!0,!1))>=r)return e}t.qbinom=function(e,t,r,n=!0,o=!1){return m.map(e)(e=>function(e,t,r,n,o){let m,g,v,M;const R=new _.NumberW(0);let y;if(l(e)||l(t)||l(r))return NaN;if(!f(t)||!f(r))return i.ML_ERR_return_NAN(N);if(!f(e)&&!o)return i.ML_ERR_return_NAN(N);if(!Number.isInteger(t))return i.ML_ERR_return_NAN(N);if(r<0||r>1||t<0)return i.ML_ERR_return_NAN(N);let I=i.R_Q_P01_boundaries(n,o,e,0,t);if(void 0!==I)return I;if(0===r||0===t)return 0;if(m=1-r,0===m)return t;if(g=t*r,v=u(t*r*m),M=(m-r)/v,N("qbinom(p=%d, n=%d, pr=%d, l.t.=%s, log=%s): sigm=%d, gam=%d",e,t,r,n,o,v,M),!n||o){if(0===(e=d.R_DT_qIv(n,o,e)))return 0;if(1===e)return t}if(Math.abs(e-1)<c)return t;if(R.val=p.qnorm(e,0,1,!0,!1),y=s(g+v*(R.val+M*(R.val*R.val-1)/6)+.5),y>t&&(y=t),N("  new (p,1-p)=(%d,%d), z=qnorm(..)=%d, y=%d, size=%d",e,1-e,R.val,y,t),R.val=h.pbinom(y,t,r,!0,!1),e*=1-64*c,t<1e5)return b(y,R,e,t,r,1);let E,w=s(.001*t);do{console.log("loopdieloop"),E=w,y=b(y,R,e,t,r,w),w=a(1,s(w/100))}while(E>1&&w>1e-15*t);return y}(e,t,r,n,o))};const N=n("_qbinom")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(21);t.dchisq=function(e,t,r=!1){return n.dgamma(e,t/2,2,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(60),o=r(22),{ceil:s,sqrt:u}=Math,{isNaN:l,isFinite:f,POSITIVE_INFINITY:c}=Number,_=n("dnchisq");t.dnchisq=function(e,t,r,n){const d=(Array.isArray(e)?e:[e]).map(e=>{let d,p,m,h,g,b,N,v;if(l(e)||l(t)||l(r))return e+t+r;if(!f(t)||!f(r)||r<0||t<0)return i.ML_ERR_return_NAN(_);if(e<0)return i.R_D__0(n);if(0===e&&t<2)return c;if(0===r)return t>0?a.dchisq(e,t,n):i.R_D__0(n);if(e===c)return i.R_D__0(n);if(p=.5*r,b=s((-(2+t)+u((2-t)*(2-t)+4*r*e))/4),b<0&&(b=0),!f(b)){if(n||r>1e3){let i=t+r,o=i/(i+r);return a.dchisq(e*o,i*o,n)}return i.R_D__0(n)}g=t+2*b,h=o.dpois_raw(b,p,!1)*a.dchisq(e,g,!1),N=h,v=h,t=g,d=b;let M=e*p;do{d++,m=M/d/t,t+=2,v*=m,N+=v}while(m>=1||v*m>5e-15*(1-m)||v>1e-10*N);for(v=h,t=g,d=b;0!==d&&(m=d*(t-=2)/M,d--,v*=m,N+=v,!(m<1&&v*m<=5e-15*(1-m))););return i.R_D_val(n,N)});return 1===d.length?d[0]:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(40),o=r(2),s=r(39),{expm1:u,min:l}=Math,{MAX_VALUE:f,MIN_VALUE:c,EPSILON:_,isNaN:d,isFinite:p,POSITIVE_INFINITY:m}=Number,h=n("_qnchisq");t.qnchisq=function(e,t,r=0,n=!0,g=!1){return o.map(e)(e=>function(e,t,r,n=!0,o=!1){h("start");const g=4*_,b=1e-11;let N,v,M,R,y;if(d(e)||d(t)||d(r))return NaN;if(!p(t))return i.ML_ERR_return_NAN(h);if(t<0||r<0)return i.ML_ERR_return_NAN(h);let I=i.R_Q_P01_boundaries(n,o,e,0,m);if(void 0!==I)return I;if(y=i.R_D_qIv(o,e),y>1-_)return n?m:0;{let i,s,u;i=r*r/(t+3*r),s=(t+3*r)/(t+2*r),u=(t+2*r)/(s*s),N=i+s*a.qchisq(e,u,n,o),N<0&&(N=1),M=N}if(!n&&r>=80?(y<1e-10&&i.ML_ERROR(i.ME.ME_PRECISION,"qnchisq",h),e=o?-u(e):.5-e+.5,n=!0):e=y,y=l(1-_,e*(1+b)),n){for(;N<f&&s.pnchisq_raw(N,t,r,b,1e-10,1e4,!0,!1)<y;N*=2);for(y=e*(1-b),v=l(M,f);v>c&&s.pnchisq_raw(v,t,r,b,1e-10,1e4,!0,!1)>y;v*=.5);}else{for(;N<f&&s.pnchisq_raw(N,t,r,b,1e-10,1e4,!1,!1)>y;N*=2);for(y=e*(1-b),v=l(M,f);v>c&&s.pnchisq_raw(v,t,r,b,1e-10,1e4,!1,!1)<y;v*=.5);}if(n)do{R=.5*(v+N),s.pnchisq_raw(R,t,r,1e-13,g,1e5,!0,!1)>e?N=R:v=R}while((N-v)/R>1e-13);else do{R=.5*(v+N),s.pnchisq_raw(R,t,r,1e-13,g,1e5,!1,!1)<e?N=R:v=R}while((N-v)/R>1e-13);return.5*(N+v)}(e,t,r,n,g))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberW=class{constructor(e=0){this._val=e}get val(){return this._val}set val(e){if(Number.isNaN(e))throw new Error("trying to set NaN, old value:"+this._val);this._val=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{isFinite:n,MIN_VALUE:i,NaN:a}=Number,{abs:o,log:s}=Math;t.bd0=function(e,t){let r,u,l,f,c;if(!n(e)||!n(t)||0===t)return a;if(o(e-t)<.1*(e+t)){if(f=(e-t)/(e+t),u=(e-t)*f,o(u)<i)return u;for(r=2*e*f,f*=f,c=1;c<1e3;c++){if(r*=f,l=u+r/(1+(c<<1)),l===u)return l;u=l}}return e*s(e/t)+t-e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(64))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(33),{PI:i,log:a,exp:o,trunc:s}=Math,{EPSILON:u,MIN_VALUE:l,POSITIVE_INFINITY:f}=Number;t.Rf_gamma_cody=function(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349],c=[-.001910444077728,.00084171387781295,-.0005952379913043012,.0007936507935003503,-.0027777777777776816,.08333333333333333,.0057083835261];let _,d,p,m,h,g,b,N,v,M,R,y;if(p=0,m=1,d=0,b=e,b<=0){if(b=-e,v=s(b),M=b-v,0===M)return f;v!==2*s(.5*v)&&(p=1),m=-i/n.sinpi(M),b+=1}if(b<u){if(!(b>=l))return f;M=1/b}else if(b<12){for(v=b,b<1?(N=b,b+=1):(d=s(b)-1,b-=d,N=b-1),g=0,h=1,_=0;_<8;++_)g=(g+t[_])*N,h=h*N+r[_];if(M=g/h+1,v<b)M/=v;else if(v>b)for(_=0;_<d;++_)M*=b,b+=1}else{if(!(b<=171.624))return f;for(y=b*b,R=c[6],_=0;_<6;++_)R=R/y+c[_];R=R/b-b+.9189385332046728,R+=(b-.5)*a(b),M=o(R)}return p&&(M=-M),1!==m&&(M=m/M),M}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(33),o=r(29),s=r(42),{isNaN:u,POSITIVE_INFINITY:l}=Number,{log:f,abs:c,floor:_,trunc:d}=Math,p=n("lgammafn_sign");t.lgammafn_sign=function(e,t){let r,n,m;return t&&(t[0]=1),u(e)?e:(t&&e<0&&0===i.fmod(_(-e),2)&&(t[0]=-1),e<=0&&e===d(e)?(i.ML_ERROR(i.ME.ME_RANGE,"lgamma",p),l):(n=c(e),n<1e-306?-f(n):n<=10?f(c(o.gammafn(e))):n>25327372760800758e289?(i.ML_ERROR(i.ME.ME_RANGE,"lgamma",p),l):e>0?e>1e17?e*(f(e)-1):e>4934720?i.M_LN_SQRT_2PI+(e-.5)*f(e)-e:i.M_LN_SQRT_2PI+(e-.5)*f(e)-e+s.lgammacor(e):(m=c(a.sinpi(n)),0===m?(p(" ** should NEVER happen! *** [lgamma.c: Neg.int, y=%d]",n),i.ML_ERR_return_NAN(p)):(r=i.M_LN_SQRT_PId2+(e-.5)*f(n)-e-f(m)-s.lgammacor(n),c((e-Math.trunc(e-.5))*r/e)<1.4901161193847656e-8&&i.ML_ERROR(i.ME.ME_PRECISION,"lgamma",p),r))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(21),s=r(4),u=r(18),l=r(18),f=r(18),c=r(6),{isArray:_}=Array,{abs:d,sqrt:p,pow:m,exp:h,log:g}=Math,{isNaN:b,POSITIVE_INFINITY:N,NEGATIVE_INFINITY:v,MIN_VALUE:M,isFinite:R}=Number,y=n("qchisq_appr");function I(e,t,r,n,o,s){let u,l,_,N,v,M,R,I,E;if(b(e)||b(t))return e+t;let w=i.R_Q_P01_check(o,e);if(void 0!==w)return w;if(t<=0)return i.ML_ERR_return_NAN(y);if(u=.5*t,_=u-1,t<-1.24*(v=a.R_DT_log(n,o,e))){let e=u<.5?f.lgamma1p(u):g(u)+r;N=h((e+v)/u+i.M_LN2),y(" small chi-sq., ch0 = %d",N)}else if(t>.32)E=c.qnorm(e,0,1,n,o),v=2/(9*t),N=t*m(E*p(v)+1-v,3),y(" nu > .32: Wilson-Hilferty; x = %d",E),N>2.2*t+6&&(N=-2*(a.R_DT_Clog(n,o,e)-_*g(.5*N)+r));else{N=.4,l=a.R_DT_Clog(n,o,e)+r+_*i.M_LN2,y(" nu <= .32: a = %d",l);do{R=N,v=1/(1+N*(4.67+N)),M=N*(6.73+N*(6.66+N)),I=(4.67+2*N)*v-.5-(6.73+N*(13.32+3*N))/M,N-=(1-h(l+.5*N)*M*v)/I}while(d(R-N)>s*d(N))}return N}t.qchisq_appr=I,t.qgamma=function(e,t=1,r=1,n=!0,i=!1){const a=(_(e)?e:[e]).map(e=>w(e,t,r,n,i));return 1===a.length?a[0]:a};const E=n("_qgamma");function w(e,t=1,r=1/t,n=!0,f=!1){let c,_,p,m,y,w,P,x,A,O,T,L,S,q,D,C,j,F,k=1,V=0,B=!1;if(b(e)||b(t)||b(r))return e+t+r;let Q=i.R_Q_P01_boundaries(n,f,e,0,N);if(void 0!==Q)return Q;if(t<0||r<=0)return i.ML_ERR_return_NAN(E);if(0===t)return 0;if(t<1e-10&&(E("value of shape (%d) is extremely small: results may be unreliable",t),k=7),c=a.R_DT_qIv(n,f,e),E("qgamma(p=%d, alpha=%d, scale=%d, l.t.=%s, log_p=%s): ",e,t,r,n,f),y=s.lgammafn(t),w=I(e,2*t,y,n,f,.01),R(w)||(k=0,B=!0),!1===B&&w<5e-7&&(k=20,B=!0),!1===B&&(c>1-1e-14||c<1e-100)&&(k=20,B=!0),!1===B){for(E("\t==> ch = %d:",w),m=t-1,D=1/5040*(120+m*(346+127*m)),P=w,F=1;F<=1e3;F++){if(V=w,x=.5*w,A=c-l.pgamma_raw(x,t,!0,!1),1===F&&E(" Ph.II iter; ch=%d, p2=%d",w,A),F>=2&&E("     it=%d,  ch=%d, p2=%d",F,w,A),!R(A)||w<=0){w=P,k=27,B=!0;break}if(C=A*h(t*i.M_LN2+y+x-m*g(w)),p=C/w,_=.5*C-p*m,O=1/420*(210+_*(140+_*(105+_*(84+_*(70+60*_))))),T=1/2520*(420+_*(735+_*(966+_*(1141+1278*_)))),L=1/2520*(210+_*(462+_*(707+932*_))),S=1/5040*(252+_*(672+1182*_)+m*(294+_*(889+1740*_))),q=1/2520*(84+2264*_+m*(1175+606*_)),w+=C*(1+.5*C*O-p*m*(O-p*(T-p*(L-p*(S-p*(q-p*D)))))),d(V-w)<5e-7*w){B=!0;break}d(V-w)>.1*w&&(w=w<V?.9*V:1.1*V)}E("qgamma(%d) not converged in %d iterations; rel.ch=%d",e,1e3,w/d(V-w))}if(j=.5*r*w,k){if(f||(e=g(e),f=!0),0===j){const i=1+1e-7,a=1-1e-7;if(j=M,c=u.pgamma(j,t,r,n,f),n&&c>e*i||!n&&c<e*a)return 0}else c=u.pgamma(j,t,r,n,f);if(c===v)return 0;for(F=1;F<=k&&(x=c-e,1===F&&E(" it=%d: p=%d, x = %d, p.=%d; p1=d{p}=%d",F,e,j,c,x),F>=2&&E("          x{it= %d} = %d, p.=%d, p1=d{p}=%d",F,j,c,x),!(d(x)<d(1e-15*e)));F++){if(y=o.dgamma(j,t,r,f),y===i.R_D__0(f)){1===F&&E("no final Newton step because dgamma(*)== 0!");break}if(C=f?x*h(c-y):x/y,C=n?j-C:j+C,c=u.pgamma(C,t,r,n,f),d(c-e)>d(x)||F>1&&d(c-e)===d(x)){1===F&&k>1&&E("no Newton step done since delta{p} >= last delta");break}C>1.1*j?C=1.1*j:C<.9*j&&(C=.9*j),j=C}}return j}t._qgamma=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(2),a=r(0),o=r(17),s=n("dhyper"),{round:u}=Math,{isNaN:l}=Number;t.dhyper=function(e,t,r,n,f=!1){return i.map(e)(e=>{let i,c,_,d,p;if(l(e)||l(t)||l(r)||l(n))return e+t+r+n;if(a.R_D_negInonint(t)||a.R_D_negInonint(r)||a.R_D_negInonint(n)||n>t+r)return a.ML_ERR_return_NAN(s);if(e<0)return a.R_D__0(f);let m=a.R_D_nonint_check(f,e,s);return void 0!==m?m:(e=u(e),t=u(t),r=u(r),(n=u(n))<e||t<e||n-e>r?a.R_D__0(f):0===n?0===e?a.R_D__1(f):a.R_D__0(f):(i=n/(t+r),c=(t+r-n)/(t+r),_=o.dbinom_raw(e,t,i,c,f),d=o.dbinom_raw(n-e,r,i,c,f),p=o.dbinom_raw(n,t+r,i,c,f),f?_+d-p:_*d/p))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=r(133),{log:u,exp:l,min:f,max:c,round:_}=Math,{isNaN:d,isFinite:p,EPSILON:m}=Number,h=n("qhyper");t.qhyper=function(e,t,r,n,g=!0,b=!1){return o.map(e)(e=>{let o,N,v,M,R,y,I,E;if(d(e)||d(t)||d(r)||d(n))return NaN;if(!p(t)||!p(r)||!p(n))return i.ML_ERR_return_NAN(h);let w=_(t),P=_(r);if(o=w+P,n=_(n),w<0||P<0||n<0||n>o)return i.ML_ERR_return_NAN(h);N=c(0,n-P),v=f(n,w);let x=i.R_Q_P01_boundaries(g,b,e,N,v);if(void 0!==x)return x;for(M=N,R=n-M,E=o<1e3,I=s.lfastchoose(w,M)+s.lfastchoose(P,R)-s.lfastchoose(o,n),E&&(I=l(I)),w-=M,P-=R,g&&!b||(e=a.R_DT_qIv(g,b,e)),e*=1-1e3*m,y=E?I:l(I);y<e&&M<v;)M++,P++,E?I*=w/M*(R/P):I+=u(w/M*(R/P)),y+=E?I:l(I),R--,w--;return M})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),{isNaN:i,isFinite:a}=Number,{floor:o,max:s}=Math,u=r(1),l=r(18),f=r(2),c=u("ppois");function _(e,t,r=!0,s=!1){return f.map(e)(e=>i(e)||i(t)?e+t:t<0?n.ML_ERR_return_NAN(c):e<0?n.R_DT_0(r,s):0===t?n.R_DT_1(r,s):a(e)?(e=o(e+1e-7),l.pgamma(t,e+1,1,!r,s)):n.R_DT_1(r,s))}t.ppois=_,t.do_search=function(e,t,r,n,i){if(t.val>=r)for(;;){if(0===e||(t.val=_(e-i,n,!0,!1))<r)return e;e=s(0,e-i)}else for(;;)if(e+=i,(t.val=_(e,n,!0,!1))>=r)return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),i=r(5),a=r(15),{isArray:o}=Array;class s extends a.IRNGNormal{constructor(e=new i.MersenneTwister(0)){super(e)}internal_norm_rand(){let e=this.rng.unif_rand(),t=this.rng.unif_rand();e=new Int32Array([134217728*e])[0]+t;const r=n.qnorm(e/134217728,0,1,!0,!1);return o(r)?r[0]:r}}t.Inversion=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),{isFinite:o,EPSILON:s,isNaN:u}=Number,{LN2:l,abs:f,trunc:c,log:_,exp:d,floor:p,round:m}=Math,h=n("dsignrank"),g=n("psignrank"),b=n("qsignrank"),N=n("rsignrank");function v(e,t,r,n,a){if(e<0||e>r)return 0;if(e>n&&(e=r-e),1===t)return 1;if(1===a[0])return a[e];a[0]=a[1]=1;for(let e=2;e<t+1;++e){let t;for(t=i.imin2(e*(e+1)/2,n);t>=e;--t)a[t]+=a[t-e]}return a[e]}t.csignrank=v,t.dsignrank=function(e,t,r=!1){const n=m(t),a=n*(n+1)/2,o=c(a/2),s=new Array(o+1).fill(0),d=(Array.isArray(e)?e:[e]).map(e=>u(e)||u(t)?e+t:t<=0?i.ML_ERR_return_NAN(h):f(e-m(e))>1e-7||(e=m(e))<0||e>t*(t+1)/2?i.R_D__0(r):i.R_D_exp(r,_(v(c(e),t,a,o,s))-t*l));return 1===d.length?d[0]:d},t.psignrank=function(e,t,r=!0,n=!1){const a=m(t),s=a*(a+1)/2,f=c(s/2),_=new Array(f+1).fill(0),p=(Array.isArray(e)?e:[e]).map(e=>m(e+1e-7)).map(e=>{let c=r;if(u(e)||u(t))return e+t;if(!o(t))return i.ML_ERR_return_NAN(g);if(t<=0)return i.ML_ERR_return_NAN(g);if(e<0)return i.R_DT_0(r,n);if(e>=s)return i.R_DT_1(r,n);let p=d(-a*l),m=0;if(e<=s/2)for(let t=0;t<=e;t++)m+=v(t,a,s,f,_)*p;else{e=t*(t+1)/2-e;for(let t=0;t<e;t++)m+=v(t,a,s,f,_)*p;c=!c}return i.R_DT_val(c,n,m)});return 1===p.length?p[0]:p},t.qsignrank=function(e,t,r=!0,n=!1){const f=m(t),_=f*(f+1)/2,p=c(_/2),h=new Array(p+1).fill(0),g=(Array.isArray(e)?e:[e]).map(e=>{if(u(e)||u(t))return e+t;if(!o(e)||!o(t))return i.ML_ERR_return_NAN(b);let m=i.R_Q_P01_check(n,e);if(void 0!==m)return m;if(f<=0)return i.ML_ERR_return_NAN(b);if(e===i.R_DT_0(r,n))return 0;if(e===i.R_DT_1(r,n))return _;!n&&r||(e=a.R_DT_qIv(r,n,e));let g=d(-t*l),N=0,M=0;if(e<=.5)for(e-=10*s;N+=v(M,f,_,p,h)*g,!(N>=e);)M++;else for(e=1-e+10*s;;){if(N+=v(M,f,_,p,h)*g,N>e){M=c(_-M);break}M++}return M});return 1===g.length?g[0]:g},t.rsignrank=function(e,t,r){const n=new Array(e).fill(0).map(()=>{if(u(t))return t;const e=m(t);if(e<0)return i.ML_ERR_return_NAN(N);if(0===e)return 0;let n=0,a=p(e);for(let e=0;e<a;)n+=++e*p(r.unif_rand()+.5);return n});return 1===n.length?n[0]:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(4),{trunc:a,log:o}=Math,s=[0,.15342640972002736,.08106146679532726,.05481412105191765,.0413406959554093,.03316287351993629,.02767792568499834,.023746163656297496,.020790672103765093,.018488450532673187,.016644691189821193,.015134973221917378,.013876128823070748,.012810465242920227,.01189670994589177,.011104559758206917,.010411265261972096,.009799416126158804,.009255462182712733,.008768700134139386,.00833056343336287,.00793411456431402,.007573675487951841,.007244554301320383,.00694284010720953,.006665247032707682,.006408994188004207,.006171712263039458,.0059513701127588475,.0057462165130101155,.005554733551962801],u=.08333333333333333,l=.002777777777777778,f=.0007936507936507937,c=.0005952380952380953;t.stirlerr=function(e){let t;return e<=15?(t=e+e,t===a(t)?s[a(t)]:i.lgammafn(e+1)-(e+.5)*o(e)+e-n.M_LN_SQRT_2PI):(t=e*e,e>500?(u-l/t)/e:e>80?(u-(l-f/t)/t)/e:e>35?(u-(l-(f-c/t)/t)/t)/e:(u-(l-(f-(c-.0008417508417508417/t)/t)/t)/t)/e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(6),s=r(2),u=r(23),l=r(45),f=r(47),{LN2:c,PI:_,SQRT2:d,sqrt:p,pow:m,log:h,exp:g,min:b,abs:N,expm1:v}=Math,{isNaN:M,EPSILON:R,MAX_VALUE:y,MIN_VALUE:I,POSITIVE_INFINITY:E,NEGATIVE_INFINITY:w,isFinite:P}=Number,x=n("qt");t.qt=function(e,t,r,n){return s.map(e)(e=>function(e,t,r,n){let s,A;if(M(e)||M(t))return e+t;let O=i.R_Q_P01_boundaries(r,n,e,w,E);if(void 0!==O)return O;if(t<=0)return i.ML_ERR_return_NAN(x);if(t<1){let o,s,u,l,c=0;if((e=a.R_DT_qIv(r,n,e))>1-R)return E;for(l=b(1-R,e*(1+1e-11)),o=1;o<y&&f.pt(o,t,!0,!1)<l;o*=2);for(l=e*(1-1e-11),s=-1;s>-y&&f.pt(s,t,!0,!1)>l;s*=2);do{u=.5*(s+o),f.pt(u,t,!0,!1)>e?o=u:s=u}while((o-s)/N(u)>1e-13&&++c<1e3);return c>=1e3&&i.ML_ERROR(i.ME.ME_PRECISION,"qt",x),.5*(s+o)}if(t>1e20)return o.qnorm(e,0,1,r,n);s=i.R_D_qIv(n,e);let T=(!r||s<.5)&&(r||s>.5),L=r===T;if(s=T?2*(n?r?s:-v(e):i.R_D_Lval(r,e)):2*(n?r?-v(e):s:i.R_D_Cval(r,e)),N(t-2)<1e-12)A=s>I?3*s<R?1/p(s):s>.9?(1-s)*p(2/(s*(2-s))):p(2/(s*(2-s))-2):n?L?g(-e/2)/d:1/p(-v(e)):E;else if(t<1+1e-12)A=1===s?0:s>0?1/u.tanpi(s/2):n?L?i.M_1_PI*g(-e):-1/(_*v(e)):E;else{let u=0,_=0,d=0,b=1/(t-.5),M=48/(b*b),y=((20700*b/M-98)*b-16)*b+96.36,E=((94.5/(M+y)-3)/M+1)*p(b*i.M_PI_2)*t,w=s>I||!n,x=w;if(w&&(_=m(E*s,2/t),x=_>=R),x||(d=L?i.R_D_log(n,e):a.R_D_LExp(n,e),u=(h(E)+c+d)/t,_=g(2*u)),t<2.1&&s>.5||_>.05+b?(u=x?o.qnorm(.5*s,0,1,!1,!1):o.qnorm(d,0,1,r,!0),_=u*u,t<5&&(y+=.3*(t-4.5)*(u+.6)),y=(((.05*E*u-5)*u-7)*u-2)*u+M+y,_=(((((.4*_+6.3)*_+36)*_+94.5)/y-_-3)/M+1)*u,_=v(b*_*_),A=p(t*_)):!x&&u<-c*i.DBL_MANT_DIG?A=p(t)*g(-u):(_=((1/(((t+6)/(t*_)-.089*E-.822)*(t+2)*3)+.5/(t+4))*_-1)*(t+1)/(t+2)+1/_,A=p(t*_)),w){let e=0;for(;e++<10&&(_=l.dt(A,t,!1))>0&&P(u=(f.pt(A,t,!1,!1)-s/2)/_)&&N(u)>1e-14*N(A);)A+=u*(1+u*A*(t+1)/(2*(A*A+t)))}}return T&&(A=-A),A}(e,t,r,n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{NaN:a,isNaN:o,isFinite:s}=Number,{PI:u}=Math,l=n("tanpi");t.tanpi=function(e){return o(e)?e:s(e)?((e=i.fmod(e,1))<=-.5?e++:e>.5&&e--,0===e?0:.5===e?a:Math.tan(u*e)):(i.ML_ERROR(i.ME.ME_DOMAIN,"",l),a)},t.atanpi=function(e){return Math.atan(e)/Math.PI}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(169),a=r(0),o=r(0),s=r(4),u=r(2),{isNaN:l,isFinite:f}=Number,{exp:c,sqrt:_,log:d,LN2:p}=Math,m=n("_ptukey");function h(e,t,r,n,u,h){const g=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],b=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];let N,v,M,R,y,I,E,w,P,x,A;if(l(e)||l(t)||l(r)||l(n))return a.ML_ERR_return_NAN(m);if(e<=0)return a.R_DT_0(u,h);if(n<2||t<1||r<2)return a.ML_ERR_return_NAN(m);if(!f(e))return a.R_DT_1(u,h);if(n>25e3)return o.R_DT_val(u,h,i.wprob(e,t,r));v=.5*n,R=v*d(n)-n*p-s.lgammafn(v),M=v-1,y=.25*n,x=n<=100?1:n<=800?.5:n<=5e3?.25:.125,R+=d(x),N=0,I=0;for(let n=1;n<=50;n++){I=0,P=(2*n-1)*x;for(let n=1;n<=16;n++){const a=8<n?n-8-1:n-1,o=8<n?R+M*d(P+g[a]*x)-(g[a]*x+P)*y:R+M*d(P-g[a]*x)+(g[a]*x-P)*y;o>=-30&&(E=8<n?e*_(.5*(g[a]*x+P)):e*_(.5*(-g[a]*x+P)),A=i.wprob(E,t,r),w=A*b[a]*c(o),I+=w)}if(n*x>=1&&I<=1e-14)break;N+=I}return I>1e-14&&a.ML_ERROR(a.ME.ME_PRECISION,"ptukey",m),N>1&&(N=1),o.R_DT_val(u,h,N)}t.ptukey=function(e,t,r,n,i=!0,a=!1){return u.map(e)(e=>h(e,t,r,n,i,a))},t._ptukey=h},function(e,t,r){"use strict";e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var r;function o(){if(o.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var a=o,s=Number(new Date),u=s-(r||s);a.diff=u,a.prev=r,a.curr=s,r=s,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var l=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return e;l++;var i=n.formatters[r];if("function"==typeof i){var o=t[l];e=i.call(a,o),t.splice(l,1),l--}return e})),n.formatArgs.call(a,t);var f=a.log||n.log;f.apply(a,t)}}return o.namespace=e,o.enabled=n.enabled(e),o.useColors=n.useColors(),o.color=t(e),o.destroy=i,o.extend=a,"function"==typeof n.init&&n.init(o),n.instances.push(o),o}function i(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function a(e,t){return n(this.namespace+(void 0===t?":":t)+e)}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var a=n.instances[t];a.enabled=n.enabled(a.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(184),Object.keys(e).forEach((function(t){n[t]=e[t]})),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(102),i=r(50),a=r(51),o=r(52);t.special=Object.freeze({besselJ:i.bessel_j,besselY:o.bessel_y,besselK:a.bessel_k,besselI:n.bessel_i})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(108),a=r(57),o=r(109),s=r(110),u=Object.freeze(['at most specify either argument "mu" or  "prob", but not both at the same time!','both arguments "mu" and "prob" are undefined']);function l(e,t,r){const n={mu:{d:i.dnbinom_mu,p:a.pnbinom_mu,q:o.qnbinom_mu,r:s.rnbinom_mu},p:{d:i.dnbinom,p:a.pnbinom,q:o.qnbinom,r:s.rnbinom}};if(void 0!==r&&void 0!==t)throw new Error(u[0]);if(void 0===r&&void 0===t)throw new Error(u[1]);return n[void 0===r?"mu":"p"][e]}t.NegativeBinomial=function(e=new n.Inversion){return{dnbinom:function(e,t,r,n,i=!1){const a=n||r;return l("d",n,r)(e,t,a,i)},pnbinom:function(e,t,r,n,i=!0,a=!1){const o=n||r;return l("p",n,r)(e,t,o,i,a)},qnbinom:function(e,t,r,n,i=!0,a=!1){const o=n||r;return l("q",n,r)(e,t,o,i,a)},rnbinom:function(t,r,n,i){const a=i||n;return l("r",i,n)(t,r,a,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(17),a=r(58),o=r(59),s=r(36);t.Binomial=function(e=new n.MersenneTwister){return{dbinom:i.dbinom,pbinom:a.pbinom,qbinom:o.qbinom,rbinom:(t,r,n)=>s.rbinom(t,r,n,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(111),i=r(112),a=r(113),o=r(114),s=r(5);t.Cauchy=function(e=new s.MersenneTwister(0)){return{rcauchy:(t,r=0,n=1)=>o.rcauchy(t,r,n,e),dcauchy:n.dcauchy,pcauchy:i.pcauchy,qcauchy:a.qcauchy}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(37);t.ChebyshevSeries={chebyshev_eval:n.chebyshev_eval,chebyshev_init:n.chebyshev_init}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(60),a=r(61),o=r(38),s=r(39),u=r(40),l=r(62),f=r(13),c=r(41);t.ChiSquared=function(e=new n.Inversion){return{dchisq:function(e,t,r,n=!1){return void 0===r?i.dchisq(e,t,n):a.dnchisq(e,t,r,n)},pchisq:function(e,t,r,n=!0,i=!1){return void 0===r?o.pchisq(e,t,n,i):s.pnchisq(e,t,r,n,i)},qchisq:function(e,t,r,n=!0,i=!1){return void 0===r?u.qchisq(e,t,n,i):l.qnchisq(e,t,r,n,i)},rchisq:function(t=1,r,n){return void 0===n?f.rchisq(t,r,e):c.rnchisq(t,r,n,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(27);t.special={choose:n.choose,lchoose:n.lchoose}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(116),i=r(117),a=r(118),o=r(119),s=r(16),{MersenneTwister:u}=s.rng;t.Exponential=function(e=new u(0)){return{dexp:(e,t=1,r=!1)=>n.dexp(e,1/t,r),pexp:(e,t=1,r=!0,n=!1)=>i.pexp(e,1/t,r,n),qexp:(e,t=1,r=!0,n=!1)=>a.qexp(e,1/t,r,n),rexp:(t,r=1)=>o.rexp(t,1/r,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(13),i=r(41),a=r(2),o=r(2),s=r(8),u=r(120),l=r(121),f=r(122),c=r(123),_=r(124),d=r(125),p=r(126),m=a.seq()();t.FDist=function(e=new s.Inversion){return{df:function(e,t,r,n,i=!1){return void 0===n?u.df(e,t,r,i):l.dnf(e,t,r,n,i)},pf:function(e,t,r,n,i=!0,a=!1){return void 0===n?f.pf(e,t,r,i,a):c.pnf(e,t,r,n,i,a)},qf:function(e,t,r,n,i=!0,a=!1){return void 0===n?_.qf(e,t,r,i,a):d.qnf(e,t,r,n,i,a)},rf:function(t,r,a,s){if(void 0===s)return p.rf(t,r,a,e);if(Number.isNaN(s))return o.possibleScalar(m(t).fill(NaN));const u=o.arrayrify((e,t)=>e/t),l=u(i.rnchisq(t,r,s,e),r),f=u(n.rchisq(t,a,e),a);return o.multiplexer(l,f)((e,t)=>e/t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(129),a=r(130),o=r(131),s=r(132);t.Geometric=function(e=new n.Inversion){return{dgeom:i.dgeom,pgeom:a.pgeom,qgeom:o.qgeom,rgeom:(t,r)=>s.rgeom(t,r,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(69),i=r(134),a=r(70),o=r(135),s=r(5);t.HyperGeometric=function(e=new s.MersenneTwister){return{dhyper:n.dhyper,phyper:i.phyper,qhyper:a.qhyper,rhyper:function(t,r,n,i){return o.rhyper(t,r,n,i,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(137),a=r(138),o=r(139),s=r(140);t.Logistic=function(e=new n.MersenneTwister(0)){return{dlogis:i.dlogis,plogis:a.plogis,qlogis:o.qlogis,rlogis:function(t,r=0,n=1){return s.rlogis(t,r,n,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(141),i=r(142),a=r(143),o=r(144),s=r(8);t.LogNormal=function(e=new s.Inversion){return{dlnorm:n.dlnorm,plnorm:i.plnorm,qlnorm:a.qlnorm,rlnorm:(t,r=0,n=1)=>o.rlnorm(t,r,n,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(145),i=r(146),a=r(5);t.Multinomial=function(e=new a.MersenneTwister(0)){return{rmultinom:function(t,r,n){return i.rmultinom(t,r,n,e)},dmultinom:n.dmultinom}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(31),i=r(19),a=r(6),o=r(43),s=r(16),{normal:{Inversion:u}}=s.rng;t.Normal=function(e=new u){return{rnorm:(t=1,r=0,n=1)=>o.rnorm(t,r,n,e),dnorm:n.dnorm4,pnorm:i.pnorm5,qnorm:a.qnorm,rng:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),i=r(71),a=r(147),o=r(32),s=r(8);t.Poisson=function(e=new s.Inversion){return{dpois:n.dpois,ppois:i.ppois,qpois:a.qpois,rpois:(t,r)=>o.rpois(t,r,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(16),i=r(160),a=r(162),o=r(163),s=r(164),{MersenneTwister:u}=n.rng;t.SignRank=function(e=new u(0)){return{dsignrank:i.dsignrank,psignrank:a.psignrank,qsignrank:o.qsignrank,rsignrank:function(t,r){return s.rsignrank(t,r,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(13),i=r(43),a=r(2),o=r(72),s=r(165),u=r(45),l=r(46),f=r(47),c=r(166),_=r(75),d=r(167);t.StudentT=function(e=new o.Inversion){return{dt:function(e,t,r,n=!1){return void 0===r?u.dt(e,t,n):s.dnt(e,t,r,n)},pt:function(e,t,r,n=!0,i=!1){return void 0===r?f.pt(e,t,n,i):l.pnt(e,t,r,n,i)},qt:function(e,t,r,n=!0,i=!1){return void 0===r?_.qt(e,t,n,i):c.qnt(e,t,r,n,i)},rt:function(t,r,o){if(void 0===o)return d.rt(t,r,e);if(Number.isNaN(o))return new Array(t).fill(NaN);{const s=a.arrayrify((e,t)=>e/t),u=a.arrayrify(Math.sqrt),l=a.flatten(i.rnorm(t,o,1,e)),f=a.flatten(u(s(n.rchisq(t,r,e),r))),c=l.map((e,t)=>e/f[t]);return 1===c.length?c[0]:c}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(77),i=r(168);t.Tukey=function(){return{ptukey:function(e,t,r,i=1,a=!0,o=!1){return n.ptukey(e,i,t,r,a,o)},qtukey:function(e,t,r,n=1,a=!0,o=!1){return i.qtukey(e,n,t,r,a,o)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(170),i=r(171),a=r(172),o=r(173),s=r(16),{MersenneTwister:u}=s.rng;t.Uniform=function(e=new u(0)){return{dunif:n.dunif,punif:i.punif,qunif:a.qunif,rng:e,runif:(t=1,r=0,n=1)=>o.runif(t,r,n,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(174),i=r(175),a=r(176),o=r(177),s=r(16);t.Weibull=function(e=new s.rng.MersenneTwister(0)){return{dweibull:n.dweibull,pweibull:i.pweibull,qweibull:a.qweibull,rweibull:function(t,r,n=1){return o.rweibull(t,r,n,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(178),i=r(179),a=r(180),o=r(181),s=r(5);t.Wilcoxon=function(e=new s.MersenneTwister(0)){return{dwilcox:n.dwilcox,pwilcox:i.pwilcox,qwilcox:a.qwilcox,rwilcox:function(t,r,n){return o.rwilcox(t,r,n,e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(66),a=r(26),{sqrt:o,pow:s,min:u,max:l,exp:f,trunc:c}=Math,{POSITIVE_INFINITY:_}=Number,d=n("I_bessel");t.I_bessel=function(e,t,r,n){let p,m,h,g,b,N,v,M,R,y,I,E,w,P,x,A,O,T,L,S,q,D,C,j,F,k=r,V=new Array(r).fill(0);if(j=t,F=j+j,r>0&&e>=0&&0<=j&&j<1&&1<=n&&n<=2){if(k=r,1===n&&e>a.exparg_BESS)return{x:_,nb:r,ncalc:k};if(2===n&&e>a.xlrg_BESS_IJ)return{x:0,nb:r,ncalc:k};if(m=c(e),e>=a.rtnsig_BESS){h=r-m,N=m+1,E=N+N+F,S=1,y=E/e,R=a.ensig_BESS+a.ensig_BESS,2*m>5*a.nsig_BESS?R=o(R*y):R/=s(1.585,m);let t=!1;if(h>=3){for(q=a.enten_BESS/a.ensig_BESS,v=m+2,p=r-1,g=v;g<=p;++g)if(N=g,E+=2,M=S,S=y,y=E*S/e+M,y>q){q=a.enten_BESS,y/=q,S/=q,L=y,D=S,v=N+1;do{++N,E+=2,M=S,S=y,y=E*S/e+M}while(y<=1);for(O=E/e,R=M*S/a.ensig_BESS,R*=.5-.5/(O*O),y=S*q,--N,E-=2,p=u(r,N),b=v;b<=p&&(k=b-1,M=D,D=L,L=E*D/e+M,!(L*D>R));++b)k=p;t=!0;break}!1===t&&(N=p,E=N+N+F,R=l(R,o(S*a.ensig_BESS)*o(y+y)))}if(!1===t)do{++N,E+=2,M=S,S=y,y=E*S/e+M}while(y<R);++N,E+=2,O=0,A=1/y,I=N-1,w=I+j,P=I-1+F,C=A*w*P/I,p=N-r;let c=!1;for(let t=0;t<1;t++){if(p<0)for(V[N-1]=A,p=-p,b=1;b<=p;++b)V[N+b-1]=0;else{if(p>0)for(b=1;b<=p;++b){if(--N,E-=2,T=O,O=A,p>100&&A>1e200){let e=s(2,-900);T*=e,O*=e,C*=e}if(A=E*O/e+T,I-=1,P-=1,1===N)break;2===N&&(P=1),w-=1,C=(C+A*w)*P/I}if(V[N-1]=A,r<=1){C=C+C+A,c=!0;break}if(--N,E-=2,V[N-1]=E*A/e+O,1===N)break;I-=1,2===N?P=1:P-=1,w-=1,C=(C+V[N-1]*w)*P/I}if(p=N-2,p>0)for(b=1;b<=p;++b)--N,E-=2,V[N-1]=E*V[N]/e+V[N+1],I-=1,2===N?P=1:P-=1,w-=1,C=(C+V[N-1]*w)*P/I;V[0]=2*w*V[1]/e+V[2]}for(!1===c&&(C=C+C+V[0]),0!==j&&(C*=i.Rf_gamma_cody(1+j)*s(.5*e,-j)),1===n&&(C*=f(-e)),A=a.enmten_BESS,C>1&&(A*=C),N=1;N<=r;++N)V[N-1]<A?V[N-1]=0:V[N-1]/=C;const _={x:V[r-1],nb:r,ncalc:k};return d("normalize, devide all  Bi[N] by sum, result:%o",_),_}if(A=1,w=1+j,x=.5*e,0!==j&&(A=s(x,j)/i.Rf_gamma_cody(w)),2===n&&(A*=f(-e)),O=x*x,V[0]=A+A*O/w,0!==e&&0===V[0]&&(k=0),r>1)if(0===e)for(N=2;N<=r;++N)V[N-1]=0;else for(T=x,q=(a.enmten_BESS+a.enmten_BESS)/e,0!==O&&(q=a.enmten_BESS/O),N=2;N<=r;++N)A/=w,w+=1,A*=T,V[N-1]=A<=q*w?A=0:A+A*O/w,0===V[N-1]&&k>N&&(k=N-1)}else k=u(r,0)-1;const B={x:V[r-1],nb:r,ncalc:k};return d("drop off, result:%o",B),B}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(24),s=r(51),u=r(101),{isNaN:l}=Number,{exp:f,trunc:c,floor:_,PI:d}=Math,p=n("bessel_i");function m(e,t,r=!1){let n,a,h;if(l(e)||l(t))return e+t;if(e<0)return i.ML_ERROR(i.ME.ME_RANGE,"bessel_i",p),NaN;if(a=r?2:1,h=_(t),t<0)return m(e,-t,r)+(t===h?0:s.internal_bessel_k(e,-t,r)*(1===a?2:2*f(-2*e))/d*o.sinpi(-t));n=1+c(h),t-=n-1;const g=u.I_bessel(e,t,n,a);return g.ncalc!==g.nb&&(g.ncalc<0?p("bessel_i(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?",e,g.ncalc,g.nb,t):p("bessel_i(%d,nu=%d): precision lost in result\n",g.x,t+g.nb-1)),e=g.x}t.bessel_i=function(e,t,r){return a.multiplexer(e,t,r)((e,t,r)=>m(e,t,r))},t.internal_bessel_i=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(66),o=r(26),{min:s,trunc:u,pow:l,sqrt:f,sin:c,cos:_,max:d,abs:p}=Math,m=n("J_bessel");t.J_bessel=function(e,t,r){const n=.6366197723675814,h=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8];let g,b,N,v,M,R,y,I,E,w,P,x,A,O,T,L,S,q,D,C,j,F,k,V,B,Q,G,U,H,Y,W,z,K,X,J,$,Z,ee,te=new Array(r).fill(0),re=!1,ne=t,ie=ne+ne;if(!(r>0&&e>=0&&0<=ne&&ne<1))return te[0]=0,ee=s(r,0)-1,{x:e,nb:r,ncalc:ee};if(ee=r,e>o.xlrg_BESS_IJ)return i.ML_ERROR(i.ME.ME_RANGE,"J_bessel",m),{x:0,nb:r,ncalc:ee};let ae=u(e);if(e<1e-4){if(m("x < 0.0001 , x=%d, nb=%d",e,r),D=1+ne,C=e>o.enmten_BESS?.5*e:0,j=0!==ne?l(C,ne)/(ne*a.Rf_gamma_cody(ne)):1,F=e+1>1?-C*C:0,te[0]=j+j*F/D,0!==e&&0===te[0]&&(ee=0),1!==r)if(e<=0)for(y=2;y<=r;++y)te[y-1]=0;else for(Q=0===F?(o.enmten_BESS+o.enmten_BESS)/e:o.enmten_BESS/F,k=C,y=2;y<=r;++y)j/=D,D+=1,j*=k,j<=Q*D&&(j=0),te[y-1]=j+j*F/D,0===te[y-1]&&ee>y&&(ee=y-1)}else if(e>25&&r<=ae+1){for(m("x > 25 and nb < int(x+1) :x=%d, nb=%d",e,r),W=f(n/e),$=1/(64*e*e),R=e>=130?4:e>=35?8:11,K=4*R,S=u(e/6.283185307179586+.5),q=e-6.28125*S-.001935307179586477*S-(ne+.5)/n,O=c(q),x=_(q),J=ie,N=1;N<=2;++N){L=(K-1-J)*(K-1+J)*$*.5,S=(J-(K-3))*(J+(K-3)),G=(J-(K+1))*(J+(K+1));let t=R+R;for(E=L*S/h[t],w=L*G/h[t+1],z=K;t>=4;t-=2)z-=4,L=(z-1-J)*(z-1+J),G=S,S=(J-(z-3))*(J+(z-3)),E=(E+1/h[t-2])*L*S*$,w=(w+1/h[t-1])*L*G*$;if(E+=1,w=(w+1)*(J*J-1)*(.125/e),te[N-1]=W*(E*x-w*O),1===r)return{x:te[r-1],nb:r,ncalc:ee};S=O,O=-x,x=S,J+=2}if(r>2)for(J=ie+2,v=3;v<=r;v++,J+=2)te[v-1]=J*te[v-1-1]/e-te[v-2-1]}else{if(m("rest: x=%d, nb=%d\t",e,r),b=r-ae,y=ae+1,Y=y+y+ie,B=1,T=Y/e,A=o.ensig_BESS+o.ensig_BESS,b>=3){Q=o.enten_BESS/o.ensig_BESS,I=ae+2,g=r-1,Y=I+I-2+ie;for(let t=I;t<=g;++t)if(y=t,Y+=2,P=B,B=T,T=Y*B/e-P,T>Q){Q=o.enten_BESS,T/=Q,B/=Q,V=T,X=B,I=y+1;do{++y,Y+=2,P=B,B=T,T=Y*B/e-P}while(T<=1);for(F=Y/e,A=P*B*(.5-.5/(F*F)),A/=o.ensig_BESS,T=B*Q,--y,Y-=2,g=s(r,y),M=I;M<=g;++M){if(P=X,X=V,V=Y*X/e-P,V*X>A){ee=M-1;break}ee=M}re=!0;break}y=g,Y=y+y+ie,A=d(A,f(B*o.ensig_BESS)*f(T+T))}if(!re)do{++y,Y+=2,P=B,B=T,T=Y*B/e-P}while(T<A);for(++y,Y+=2,F=0,j=1/T,H=R=y>>1,R=(y<<1)-(R<<2),0===R?Z=0:(D=H-1+ne,U=H+H+ne,Z=j*D*U/H),g=y-r,M=1;M<=g;++M)if(--y,Y-=2,k=F,F=j,j=Y*F/e-k,R=R?0:2,0!==R){if(H-=1,U=H+H+ne,1===y)break;D=H-1+ne,0===D&&(D=1),Z=(Z+j*U)*D/H}te[y-1]=j;let t=!1,n=!1;for(let i=1;i>0;i--)if(g>=0){if(r<=1){U=ne+1===1?1:ne,Z+=te[0]*U,n=!0;break}if(--y,Y-=2,te[y-1]=Y*j/e-F,1===y){t=!0;break}R=R?0:2,0!==R&&(H-=1,U=H+H+ne,D=H-1+ne,0===D&&(D=1),Z=(Z+te[y-1]*U)*D/H)}if(!1===n&&!1===t){for(y-=1;y>=2;y--)Y-=2,te[y-1]=Y*te[y+1-1]/e-te[y+2-1],R=R?0:2,0!==R&&(H-=1,U=H+H+ne,D=H-1+ne,0===D&&(D=1),Z=(Z+te[y-1]*U)*D/H);te[0]=2*(ne+1)*te[1]/e-te[2]}for(!1===n&&(H-=1,U=H+H+ne,0===U&&(U=1),Z+=te[0]*U),p(ne)>1e-15&&(Z*=a.Rf_gamma_cody(ne)*l(.5*e,-ne)),j=o.enmten_BESS,Z>1&&(j*=Z),y=1;y<=r;++y)p(te[y-1])<j?te[y-1]=0:te[y-1]/=Z}return{x:te[r-1],nb:r,ncalc:ee}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(26),{min:o,log:s,exp:u,abs:l,sinh:f,trunc:c,sqrt:_,max:d}=Math,{MAX_VALUE:p,EPSILON:m,MIN_VALUE:h}=Number,g=n("K_bessel");t.K_bessel=function(e,t,r,n){const b=.11593151565841245,N=[.8056298756904329,20.404550020536515,157.7056051066762,536.6711164692075,900.3827592912887,730.9238866506604,229.29930150942513,.8224670334241132],v=[29.460198624785043,277.5778685102212,1206.7032559102745,2762.9144415979154,3443.740505065646,2210.6319011337864,572.2673383598922],M=[-.48672575865218404,13.079485869097804,-101.96490580880537,347.65409106507815,.0003495898124521935],R=[-25.57910550997646,212.57260432226545,-610.6901868494411,422.6966880577776],y=[1.6125990452916364e-10,2.5051878502858254e-8,27557319615147965e-22,.00019841269840928374,.008333333333333475,.16666666666666666],I=[52.0583,5.7607,2.7782,14.4303,185.3004,9.3715],E=[41.8341,7.1075,6.4306,42.511,1.35633,84.5096,20];let w,P,x,A,O,T,L,S,q,D,C,j,F,k,V,B,Q,G,U,H,Y,W,z,K,X,J,$,Z,ee,te=new Array(r).fill(0);T=0,J=e,ee=t;let re=o(r,0)-2;if(r>0&&0<=ee&&ee<1&&1<=n&&n<=2){for(let e=0;e<1;e++){if(J<=0||1===n&&J>a.xmax_BESS_K)return J<=0?(J<0&&i.ML_ERROR(i.ME.ME_RANGE,"K_bessel",g),te[0]=1/0):te[0]=0,re=r,{x:te[0],nb:r,ncalc:re};if(A=0,ee<a.sqxmin_BESS_K?ee=0:ee>.5&&(A=1,ee-=1),K=ee+ee,w=r+A-1,D=ee*ee,B=-D,J<=1){for(k=0,V=N[0],W=1,z=v[0],P=2;P<=7;P+=2)k=D*k+N[P-1],V=D*V+N[P],W=D*W+v[P-1],z=D*z+v[P];for(k*=ee,W*=ee,G=s(J),Q=b+ee*(N[7]-ee*(k+V)/(W+z))-G,Y=u(-ee*(b-ee*(N[7]+ee*(k-V)/(W-z))-G)),G=ee*Q,H=u(G),k=M[4],W=1,P=0;P<4;++P)k=D*k+M[P],W=D*W+R[P];if(l(G)<=.5){for(G*=G,V=0,P=0;P<6;++P)V=G*V+y[P];V=Q+Q*G*V}else V=f(G)/ee;if(Q=V-ee*k/(W*H),J<=1e-10){if(te[0]=Q+J*Q,1===n&&(te[0]-=J*te[0]),j=H/Q,D=J*p,0!==A){if(re=-1,te[0]>=D/j)return{x:te[r-1],nb:r,ncalc:re};te[0]=j*te[0]/J,K+=2,j=K}if(re=1,1===r)return{x:te[r-1],nb:r,ncalc:re};for(re=-1,P=1;P<r;++P){if(j>=D)return{x:te[r-1],nb:r,ncalc:re};te[P]=j/J,K+=2,j=K}re=1;break}D=1,S=J*J/4,H*=.5,Y*=.5,k=-1,V=0,$=0,Z=0,G=Q,U=H;do{k+=2,V+=1,B=k+B,D=S*D/V,Q=(V*Q+H+Y)/B,H/=V-ee,Y/=V+ee,W=D*Q,z=D*(H-V*Q),$+=W,Z+=z}while(l(W/(G+$))>m||l(z/(U+Z))>m);$=G+$,Z=2*(U+Z)/J,2===n&&(k=u(J),$*=k,Z*=k),F=E[0]*J+E[1]}else{if(m*J>1)return re=r,$=1/(.7978845608028654*_(J)),{x:$,nb:r,ncalc:re};if(q=J+J,C=0,j=0,J<=4){for(V=c(I[0]/J+I[1]),O=c(V),k=V+V,V-=.5,V*=V,P=2;P<=O;++P)k-=2,V-=k,j=(B+V)/(q+k-j);for(V=c(I[2]*J+I[3]),O=c(V),D=l(ee),B=D+D,k=B-1,G=h,Q=(2*(D+V)/J+.5*J/(D+V+1))*h,P=3;P<=O;++P)V-=1,U=(B+V+V)*Q,C=(1+k/V)*(U+C),U=U/J+G,G=Q,Q=U;for(G=(B+2)*Q/J+G,k=0,W=1,P=1;P<=7;++P)k=D*k+N[P-1],W=D*W+v[P-1];H=u(D*(b+D*(N[7]-D*k/W)-s(J)))/J,U=(D+.5-j)*G/J,$=H+(B*Q-U+Q+C)/(U+G+Q)*H,1===n&&($*=u(-J)),F=E[2]*J+E[3]}else{for(X=c(I[4]/J+I[5]),O=c(X),V=X-.5,V*=V,k=X+X,P=2;P<=O;++P)X-=1,k-=2,V-=k,j=(B+V)/(q+k-j),C=(j+j*C)/X;$=1/((.7978845608028654+.7978845608028654*C)*_(J)),1===n&&($*=u(-J)),F=E[4]*(J-l(J-E[6]))+E[5]}Z=$+$*(ee+.5-j)/J}if(re=r,te[0]=$,0===w)return{x:te[r-1],nb:r,ncalc:re};if(x=1-A,x>=0&&(te[x]=Z),1===w)return{x:te[r-1],nb:r,ncalc:re};for(O=o(c(F-ee),w),P=2;P<=O;++P){if(W=$,$=Z,K+=2,J<1){if($>=p/K*J)break}else if($/J>=p/K)break;Z=K/J*$+W,T=P,++x,x>=0&&(te[x]=Z)}if(O=T,O===w)return{x:te[r-1],nb:r,ncalc:re};for(j=Z/$,L=O+1,re=-1,P=L;P<=w;++P)if(K+=2,j=K/J+1/j,++x,x>=1)te[x]=j;else{if(Z>=p/j)return{x:te[r-1],nb:r,ncalc:re};Z*=j}if(re=d(1,L-A),1===re&&(te[0]=Z),1===r)return{x:Z,nb:r,ncalc:re}}for(P=re;P<r;++P)te[P]*=te[P-1],re++}return{x:te[r-1],nb:r,ncalc:re}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(23),a=r(24),o=r(26),s=.3183098861837907,u=1.5707963267948966,{min:l,trunc:f,sqrt:c,sin:_,cos:d,log:p,abs:m,pow:h,PI:g}=Math,{MIN_VALUE:b,EPSILON:N,NEGATIVE_INFINITY:v,MAX_VALUE:M}=Number,R=n("Y_bessel");t.Y_bessel=function(e,t,r){const n=[-6773524182239884e-39,-6145518011604988e-38,29017595056104746e-37,136394179190731e-33,23826220476859634e-34,-9064290795755071e-33,-14943667065169001e-31,-3391907830536221e-29,-1702377664251273e-28,9160975093876865e-27,2.42309579004827e-10,1.7451364971382985e-9,-3.3126119768180853e-8,-8.659207996139126e-7,-49717367041957395e-22,7630959758590813e-20,.0012719271366545622,.0017063050710955563,-.07685284084478668,-.28387654227602355,.9218702936504527];let y,I,E,w,P,x,A,O,T,L,S,q,D,C,j,F,k,V,B,Q,G,U,H,Y,W,z,K,X,J,$,Z,ee,te,re,ne,ie,ae,oe,se,ue,le=ee=te=0,fe=e,ce=t,_e=new Array(r).fill(0);if(!(r>0&&0<=ce&&ce<1))return R("violaton: abort nb=%d, nu=%d",r,ce),_e[0]=0,w=l(r,0)-1,{x:0,nb:r,ncalc:w};if(fe<b||fe>o.xlrg_BESS_Y)return R("range issue: x < DBL_MIN but still bigger then 1e8 x=(%d)",fe),w=r,fe>o.xlrg_BESS_Y?_e[0]=0:fe<b&&(_e[0]=v),{x:_e[0],nb:r,ncalc:w};if(ue=f(ce+.5),E=f(ue),1===E&&(ce-=ue),-.5===ce)Q=.7978845608028654/c(fe),ee=Q*_(fe),te=-Q*d(fe);else if(fe<3){if(D=.5*fe,j=-p(D),k=ce*j,F=h(D,-ce),C=m(ce)<o.M_eps_sinc?s:ce/a.sinpi(ce),m(k)<1)for(se=k*k,Z=19,H=1,y=1;y<=9;++y)H=H*se/Z/(Z-1)+1,Z-=2;else H=.5*(F-1/F)/k;for(se=ce*ce*8,ae=n[0],O=0,P=n[1],ie=0,y=3;y<=19;y+=2)O=-(ae+ae+O),ae=-O*se-ae+n[y-1],ie=-(P+P+ie),P=-ie*se-P+n[y];for(O=(.5*O+ae)*se-ae+n[20],ie=2*(ie+P),T=ie*ce+O,V=F*T,F=.5*(F+1/F),k=2*C*(ie*F+O*H*j),F=ce*ce,Q=V*C,G=s/V,C=ce*u,U=m(C)<o.M_eps_sinc?1:a.sinpi(ce/2)/C,U*=g*C*U,C=1,j=-D*D,B=0,ee=k+U*G,te=Q,Z=1;m(V/(1+m(ee)))+m(B/(1+m(te)))>N;)k=(k*Z+Q+G)/(Z*Z-F),C*=j/Z,Q/=Z-ce,G/=Z+ce,V=C*(k+U*G),B=C*Q-Z*V,ee+=V,te+=B,Z+=1;ee=-ee,te=-te/D}else if(fe<o.thresh_BESS_Y){for(C=(.5-ce)*(.5+ce),D=fe+fe,F=fe*s*i.cospi(ce)/N,F*=F,Q=1,G=-fe,U=1+fe*fe,H=U,Z=2;U*Z*Z<F;)le=Z+1,j=(Z-1+C/Z)/H,Q=(Z+Z-Q*j)/le,G=(G*j-D)/le,H=Q*Q+G*G,U*=H,Z=le;for(k=Q/H,Q=k,V=-G/H,G=V;Z-=1,Z>0;)U=le*(2-Q)-2,H=D+le*G,j=(Z-1+C/Z)/(U*U+H*H),Q=j*U,G=j*H,F=k+1,k=Q*F-V*G,V=G*F+Q*V,le=Z;k=1+k,j=k*k+V*V,K=k/j,J=-V/j,j=ce+.5-Q,G+=fe,X=(K*G-J*j)/fe,$=(J*G+K*j)/fe,D=fe-u*(ce+.5),C=d(D),H=_(D),j=.7978845608028654/c(fe),ee=j*(K*H+J*C),te=j*($*H-X*C)}else for(E=0,Y=f(fe/15.707963267948966),y=f(Y),oe=fe-15*Y-.7079632679489662*Y-(t+.5)*u,y-(y/2<<1)==0?(S=d(oe),q=_(oe)):(S=-d(oe),q=-_(oe)),A=8*fe,oe=t,ne=c(fe),I=1;I<=2;++I){for(Q=S,S=q,q=-Q,Y=(2*oe-1)*(2*oe+1),W=0,x=A,Q=0,G=0,z=Y/x,L=z,y=2;y<=20&&(W+=8,Y-=W,x+=A,L=-L*Y/x,Q+=L,W+=8,Y-=W,x+=A,L*=Y/x,G+=L,!(m(L)<=N));++y);Q+=1,G+=z,1===I?ee=.7978845608028654*(Q*S-G*q)/ne:te=.7978845608028654*(Q*S-G*q)/ne,oe+=1}if(1===E&&(B=2*(ce+1)/fe,B>1&&m(te)>M/B&&(B=0,ee=0),B=B*te-ee,ee=te,te=B),_e[0]=ee,w=1,r>1&&(_e[1]=te,0!==te))for(ae=1+t,re=2/fe,w=2,y=2;y<r;++y){if(re<1){if(m(_e[y-1])*re>=M/ae)break}else if(m(_e[y-1])>=M/ae/re)break;_e[y]=re*ae*_e[y-1]-_e[y-2],ae+=1,++w}return{x:_e[w-1],nb:r,ncalc:w}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(29),o=r(2),s=r(11),{isNaN:u,isFinite:l,POSITIVE_INFINITY:f}=Number,c=n("beta");function _(e,t){if(u(e)||u(t))return e+t;if(e<0||t<0)return i.ML_ERR_return_NAN(c);if(0===e||0===t)return f;if(!l(e)||!l(t))return 0;if(e+t<171.61447887182297)return 1/a.gammafn(e+t)*a.gammafn(e)*a.gammafn(t);{let r=s.internal_lbeta(e,t);return r<-708.3964185322641&&i.ML_ERROR(i.ME.ME_UNDERFLOW,"beta",c),Math.exp(r)}}t.beta=function(e,t){return o.multiplexer(e,t)((e,t)=>_(e,t))},t.internal_beta=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{LN2:a,log:o,min:s,max:u,exp:l,sqrt:f}=Math,{MAX_VALUE:c,isFinite:_}=Number,d=n("rbeta");t.expmax=i.DBL_MAX_EXP*a,t.rbeta=function(e,r,n,a){const p=new Array(e).fill(0).map(()=>{if(r<0||n<0)return i.ML_ERR_return_NAN(d);if(!_(r)&&!_(n))return.5;if(0===r&&0===n)return a.unif_rand()<.5?0:1;if(!_(r)||0===n)return 1;if(!_(n)||0===r)return 0;let e,p,m,h,g,b,N,v,M,R,y,I=0,E=0,w=0,P=0,x=0,A=0,O=0,T=-1,L=-1;function S(e){E=P*o(I/(1-I)),E<=t.expmax?(w=e*l(E),_(w)||(w=c)):w=c}if(R=T===r&&L===n,R||(T=r,L=n),e=s(r,n),p=u(r,n),m=e+p,e<=1){for(R||(P=1/e,y=1+p-e,A=y*(.0138889+.0416667*e)/(p*P-.777778),O=.25+(.5+.25/y)*e);;){if(I=a.unif_rand(),N=a.unif_rand(),I<.5){if(v=I*N,M=I*v,.25*N+M-v>=A)continue}else{if(M=I*I*N,M<=.25){S(p);break}if(M>=O)continue}if(S(p),m*(o(m/(e+w))+E)-1.3862944>=o(M))break}return r===e?e/(e+w):w/(e+w)}R||(P=f((m-2)/(2*e*p-m)),x=e+1/P);do{if(I=a.unif_rand(),N=a.unif_rand(),S(e),M=I*I*N,h=x*E-1.3862944,g=e+h-w,g+2.609438>=5*M)break;if(b=o(M),g>b)break}while(h+m*o(m/(p+w))<b);return r!==e?p/(p+w):w/(p+w)});return 1===p.length?p[0]:p}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(17),o=r(4),s=n("dnbinom"),{log:u,round:l,log1p:f}=Math,{isFinite:c,isNaN:_}=Number;t.dnbinom=function(e,t,r,n){const o=(Array.isArray(e)?e:[e]).map(e=>{let o,f;if(_(e)||_(t)||_(r))return e+t+r;if(r<=0||r>1||t<0)return i.ML_ERR_return_NAN(s);let d=i.R_D_nonint_check(n,e,s);return void 0!==d?d:e<0||!c(e)?i.R_D__0(n):0===e&&0===t?i.R_D__1(n):(e=l(e),o=a.dbinom_raw(t,e+t,r,1-r,n),f=t/(t+e),n?u(f)+o:f*o)});return 1===o.length?o[0]:o};const d=n("dnbinom_mu");t.dnbinom_mu=function(e,t,r,n){const s=(Array.isArray(e)?e:[e]).map(e=>{let s,p;if(_(e)||_(t)||_(r))return e+t+r;if(r<0||t<0)return i.ML_ERR_return_NAN(d);let m=i.R_D_nonint_check(n,e,d);if(void 0!==m)return m;if(e<0||!c(e))return i.R_D__0(n);if(0===e&&0===t)return i.R_D__1(n);if(0===(e=l(e))){let e;return e=t<r?u(t/(t+r)):f(-r/(t+r)),i.R_D_exp(n,t*e)}return e<1e-10*t?(p=u(t<r?t/(1+t/r):r/(1+r/t)),i.R_D_exp(n,e*p-r-o.lgammafn(e+1)+f(e*(e-1)/(2*t)))):(s=a.dbinom_raw(t,e+t,t/(t+r),r/(t+r),n),p=t/(t+e),n?u(p)+s:p*s)});return 0===s.length?s[0]:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(9),o=r(3),s=r(6),u=r(2),l=r(57),{isNaN:f,POSITIVE_INFINITY:c,EPSILON:_}=Number,{max:d,sqrt:p,floor:m,round:h}=Math,g=n("do_search");function b(e,t,r,n,i,a){if(g("start: y:%d, z:%o, p:%d, n:%d, pr:%d, incr:%d",e,t,r,n,i,a),t.val>=r)for(;;){if(0===e||(t.val=l.pnbinom(e-a,n,i,!0,!1))<r)return g("exit1"),e;e=d(0,e-a)}else for(;;)if(e+=a,(t.val=l.pnbinom(e,n,i,!0,!1))>=r)return g("exit2"),e}const N=n("qnbinom");function v(e,t,r,n,g){return u.map(e)(e=>{let u,v,M,R,y,I;const E=new a.NumberW(0);if(f(e)||f(t)||f(r))return NaN;if(0===r&&0===t)return 0;if(r<=0||r>1||t<0)return i.ML_ERR_return_NAN(N);if(1===r||0===t)return 0;let w=i.R_Q_P01_boundaries(n,g,e,0,c);if(void 0!==w)return w;if(v=1/r,u=(1-r)*v,M=t*u,R=p(t*u*v),y=(v+u)/R,!n||g){if((e=o.R_DT_qIv(n,g,e))===i.R_DT_0(n,g))return 0;if(e===i.R_DT_1(n,g))return c}if(e+1.01*_>=1)return c;if(E.val=s.qnorm(e,0,1,!0,!1),I=h(M+R*(E.val+y*(E.val*E.val-1)/6)),E.val=l.pnbinom(I,t,r,!0,!1),e*=1-64*_,I<1e5)return b(I,E,e,t,r,1);{let n,i=m(.001*I);do{n=i,I=b(I,E,e,t,r,i),i=d(1,m(i/100))}while(n>1&&i>1e-15*I);return I}})}t.qnbinom=v,t.qnbinom_mu=function(e,t,r,n,i){return v(e,t,t/(t+r),n,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(30),o=r(32),{isFinite:s}=Number,u=n("rnbinom");t.rnbinom=function(e,t,r,n){u("n:%d, size:%d, prob:%d",e,t,r);const l=new Array(e).fill(0).map(()=>!s(t)||!s(r)||t<=0||r<=0||r>1?i.ML_ERR_return_NAN(u):1===r?0:o.rpois(1,a.rgamma(1,t,(1-r)/r,n),n));return 1===l.length?l[0]:l};const l=n("rnbinom_mu");t.rnbinom_mu=function(e=1,t,r,n){const u=new Array(e).fill(0).map(()=>!s(t)||!s(r)||t<=0||r<0?i.ML_ERR_return_NAN(l):0===r?0:o.rpois(1,a.rgamma(1,t,r/t,n),n));return 1===u.length?u[0]:u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{isNaN:o}=Number,{PI:s,log:u}=Math,l=n("dcauchy");t.dcauchy=function(e,t=0,r=1,n=!1){return a.map(e)(e=>{let a;return o(e)||o(t)||o(r)?e+t+r:r<=0?i.ML_ERR_return_NAN(l):(a=(e-t)/r,n?-u(s*r*(1+a*a)):1/(s*r*(1+a*a)))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(0),o=r(2),s=r(33),{isNaN:u,isFinite:l}=Number,{abs:f}=Math,c=n("pcauchy");t.pcauchy=function(e,t=0,r=1,n=!0,_=!1){return o.map(e)(e=>{if(u(e)||u(t)||u(r))return e+t+r;if(r<=0)return i.ML_ERR_return_NAN(c);if(u(e=(e-t)/r))return i.ML_ERR_return_NAN(c);if(!l(e))return e<0?i.R_DT_0(n,_):i.R_DT_1(n,_);if(n||(e=-e),f(e)>1){let t=s.atanpi(1/e);return e>0?a.R_D_Clog(_,t):i.R_D_val(_,-t)}return i.R_D_val(_,.5+s.atanpi(e))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(76),{expm1:s,exp:u}=Math,{isNaN:l,isFinite:f}=Number,{ML_POSINF:c,ML_NEGINF:_}={ML_POSINF:1/0,ML_NEGINF:-1/0},d=n("qcauchy");t.qcauchy=function(e,t=0,r=1,n=!0,p=!1){return a.map(e)(e=>{if(l(e)||l(t)||l(r))return NaN;let a=n,m=i.R_Q_P01_check(p,e);if(void 0!==m)return m;if(r<=0||!f(r))return 0===r?t:i.ML_ERR_return_NAN(d);const h=t+(a?r:-r)*c;if(p)if(e>-1){if(0===e)return h;a=!a,e=-s(e)}else e=u(e);else if(e>.5){if(1===e)return h;e=1-e,a=!a}return.5===e?t:0===e?t+(a?r:-r)*_:t+(a?-r:r)/o.tanpi(e)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{isNaN:a,isFinite:o}=Number,{PI:s}=Math,u=n("rcauchy");t.rcauchy=function(e,t=0,r=1,n){const l=new Array(e).fill(0).map(()=>a(t)||!o(r)||r<0?i.ML_ERR_return_NAN(u):0!==r&&o(t)?t+r*Math.tan(s*n.unif_rand()):t);return 1===l.length?l[0]:l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(63),{trunc:a,log:o,abs:s,min:u,pow:l}=Math,f=n("Toms708.bratio");class c{static alnrel(e){let t=0,r=0,n=0,i=0;return Math.abs(e)>.375?(n=1+e,o(n)):(t=e/(e+2),i=t*t,r=(((-.0178874546012214*i+.405303492862024)*i-1.29418923021993)*i+1)/(((-.0845104217945565*i+.747811014037616)*i-1.62752256355323)*i+1),2*t*r)}static algdiv(e,t){let r=0,n=0,i=0,a=0,s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0,h=0,g=0;return e<=t?(a=e/t,n=a/(1+a),_=1/(1+a),i=t+(e-.5)):(a=t/e,n=1/(1+a),_=a/(1+a),i=e+(t-.5)),h=_*_,d=1+_+h,p=1+_+h*d,m=1+_+h*p,g=1+_+h*m,r=1+_+h*g,s=Math.pow(1/t,2),f=((((-.00165322962780713*r*s+.000837308034031215*g)*s+-.00059520293135187*m)*s+.00079365066682539*p)*s+-.00277777777760991*d)*s+.0833333333333333,f*=n/t,u=i*c.alnrel(e/t),l=e*(o(t)-1),u<=l?f-u-l:f-l-u}static apser(e,t,r,n){const i=.577215664901533;let a=0,s=0,u=0,l=0,f=0,_=0,d=0;s=t*r,f=r-s,u=t*n>.02?o(s)+i+f:o(r)+c.psi(t)+i+f,_=5*n*Math.abs(u),a=1,l=0;do{a++,f*=r-s/a,d=f/a,l+=d}while(Math.abs(d)>_);return-e*(u+l)}static basym(e,t,r,n){let i=new Array(21).fill(0),a=new Array(21).fill(0),o=new Array(21).fill(0),s=new Array(21).fill(0);const u=1.12837916709551,l=.353553390593274;let f,_,d,p;e<=t?(f=e/t,_=1/(1+f),d=(t-e)/t,p=1/Math.sqrt(e*(1+f))):(f=t/e,_=1/(1+f),d=(t-e)/e,p=1/Math.sqrt(t*(1+f)));let m=e*c.rlog1(-r/e)+t*c.rlog1(r/t),h=Math.exp(-m);if(0===h)return 0;let g=Math.sqrt(m),b=g/l*.5,N=m+m;i[0]=2/3*d,o[0]=-.5*i[0],s[0]=-o[0];let v=.5/u*c.erfc1(1,g),M=l,R=v+s[0]*p*M,y=1,I=f*f,E=1,w=p,P=b,x=N;for(let e=2;e<=20;e+=2){E*=I,i[e]=2*_*(1+f*E)/(e+2);let t=e+1;y+=E,i[t]=2*d*y/(e+3);for(let r=e;r<=t;r++){let e=-.5*(r+1);a[1]=e*i[1];for(let t=2;t<=r;t++){let r=0,n=t-1;for(let o=1;o<=n;o++){let n=t-o;r+=(o*e-n)*i[o]*a[n]}a[t]=e*i[t]+r/t}o[r]=a[r]/(r+1);let t=0,n=r-1;for(let e=1;e<=n;e++)t+=s[r-e]*o[e];s[r]=-(t+o[r])}v=l*P+(e-1)*v,M=l*x+e*M,P*=N,x*=N,w*=p;let r=s[e]*w*v;w*=p;let u=s[t]*w*M;if(R+=r+u,Math.abs(r)+Math.abs(u)<=n*R)break}return u*h*Math.exp(-c.bcorr(e,t))*R}static bcorr(e,t){const r=-.00165322962780713,n=.000837308034031215,i=-.00059520293135187,a=.00079365066682539,o=-.00277777777760991,s=.0833333333333333;let u=0,l=0,f=0,c=0,_=0,d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0;return l=Math.min(e,t),f=Math.max(e,t),_=l/f,c=_/(1+_),m=1/(1+_),N=m*m,h=1+(m+N),g=1+(m+N*h),b=1+(m+N*g),v=1+(m+N*b),u=1+(m+N*v),d=Math.pow(1/f,2),p=((((r*u*d+n*v)*d+i*b)*d+a*g)*d+o*h)*d+s,p*=c/f,d=Math.pow(1/l,2),(((((r*d+n)*d+i)*d+a)*d+o)*d+s)/l+p}static beta_cdf_values(e,t,r,n,i){const a=[.5,.5,.5,1,1,1,1,1,2,2,2,2,2,2,2,2,2,5.5,10,10,10,10,20,20,20,20,20,30,30,40,1,1,1,1,1,1,1,1,2,3,4,5],o=[.5,.5,.5,.5,.5,.5,.5,1,2,2,2,2,2,2,2,2,2,5,.5,5,5,10,5,10,10,20,20,10,10,20,.5,.5,.5,.5,2,3,4,5,2,2,2,2],s=[.06376856085851985,.2048327646991335,1,0,.005012562893380045,.0513167019494862,.2928932188134525,.5,.028,.104,.216,.352,.5,.648,.784,.896,.972,.4361908850559777,.1516409096347099,.08978271484375,1,.5,.4598773297575791,.2146816102371739,.9507364826957875,.5,.8979413687105918,.2241297491808366,.7586405487192086,.7001783247477069,.0513167019494862,.1055728090000841,.1633399734659245,.2254033307585166,.36,.488,.5904,.67232,.216,.0837,.03078,.010935],u=[.01,.1,1,0,.01,.1,.5,.5,.1,.2,.3,.4,.5,.6,.7,.8,.9,.5,.9,.5,1,.5,.8,.6,.8,.5,.6,.7,.8,.7,.1,.2,.3,.4,.2,.2,.2,.2,.3,.3,.3,.3];e.val<0&&(e.val=0),e.val++,e.val>42?(e.val=0,t.val=r.val=n.val=i.val=0):(t.val=a[e.val-1],r.val=o[e.val-1],n.val=u[e.val-1],i.val=s[e.val-1])}static betaln(e,t){const r=.918938533204673;let n=0,i=0,s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0;if(n=Math.min(e,t),i=Math.max(e,t),n<1)return i<8?c.gamln(n)+c.algdiv(n,i):c.gamln(n)+c.gamln(i)-c.gamln(n+i);if(n>=1&&n<8){if(n<2&&i<2)return c.gamln(n)+c.gamln(i)-c.gsumln(n,i);if(i>2){if(p=0,i<8){for(f=a(i-1),m=1,l=1;l<=f;l++)i--,m*=i/(n+i);return p+o(m)+(c.gamln(n)+c.gamln(i)-c.gsumln(n,i))}return c.gamln(n)+c.algdiv(n,i)}if(n>2){if(i>1e3){for(f=a(n-1),p=1,l=1;l<=f;l++)n--,p*=n/(1+n/i);return o(p)-f*o(i)+(c.gamln(n)+c.algdiv(n,i))}for(f=a(n-1),p=1,l=1;l<=f;l++)n--,u=n/i,p*=u/(1+u);if(p=o(p),i<8){for(f=a(i-1),m=1,l=1;l<=f;l++)i--,m*=i/(n+i);return p+o(m)+(c.gamln(n)+c.gamln(i)-c.gsumln(n,i))}return p+c.gamln(n)+c.algdiv(n,i)}}return p=c.bcorr(n,i),u=n/i,s=u/(1+u),_=-(n-.5)*o(s),d=i*c.alnrel(u),_>d?-.5*o(i)+r+p-_-d:-.5*o(i)+r+p-d-_}static bfrac(e,t,r,n,i,a){let o=0,s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0,M=0,R=0,y=0,I=0,E=c.brcomp(e,t,r,n);if(0===E)return 0;for(l=1+i,g=t/e,b=1+1/e,s=n+1,o=0,_=1,p=e+1,y=0,I=1,N=1,v=l/b,d=b/l;o++,m=o/e,h=o*(t-o)*r,f=e/p,u=_*(_+g)*f*f*(h*r),f=(1+m)/(b+m+m),R=o+h/p+f*(l+o*s),_=1+m,p+=2,m=u*y+R*N,y=N,N=m,m=u*I+R*v,I=v,v=m,M=d,d=N/v,!(Math.abs(d-M)<=a*d);)y/=v,I/=v,N=d,v=1;return E*=d,E}static bgrat(e,t,r,n,a,s,u){let l=0,f=0,_=0,d=0,p=0,m=new Array(30),h=new Array(30),g=0,b=0,N=0,v=0,M=0,R=0,y=0,I=0,E=0,w=0,P=0,x=0,A=0,O=0,T=0,L=0,S=0;if(g=t-.5-.5,d=e+.5*g,_=n<=.375?c.alnrel(-n):o(r),P=-d*_,t*P!=0){if(R=t*(1+c.gam1(t))*Math.exp(t*o(P)),R*=Math.exp(e*_)*Math.exp(.5*g*_),E=c.algdiv(t,e)+t*o(d),E=R*Math.exp(-E),0===E)return void(u.val=1);let r=new i.NumberW(0),n=new i.NumberW(0);for(c.grat1(t,P,R,r,n,s),M=n.val,w=.25*Math.pow(1/d,2),O=.25*_*_,f=a.val/E,l=M/R,x=l,I=1,S=1,p=0,v=1;v<=30;v++){if(A=t+p,l=(A*(A+1)*l+(P+A+1)*I)*w,p+=2,I*=O,S/=p*(p+1),m[v-1]=S,y=0,1!==v)for(b=v-1,T=t-v,N=1;N<=b;N++)y+=T*m[N-1]*h[v-N-1],T+=t;if(h[v-1]=g*S+y/v,L=h[v-1]*l,x+=L,x<=0)return void(u.val=1);if(Math.abs(L)<=s*(x+f))break}return u.val=0,void(a.val+=E*x)}u.val=1}static brcomp(e,t,r,n){if(0===r||0===n)return 0;let i,a,s,u,l,f,_,d,p,m,h,g=Math.min(e,t);if(g<8){if(!(r<=.375)){n<=.375?(a=c.alnrel(-n),s=o(n)):(a=o(r),s=o(n));let l=e*a+t*s;if(g>=1)return l-=c.betaln(e,t),Math.exp(l);if(i=Math.max(e,t),!(i<8)){let e=c.gamln1(g),t=i-1;if(t>=1){u=1;for(let e=1;e<=t;e++)i--,u*=i/(g+i);e=o(u)+e}l-=e,i--;let r,n=g+i;return n<=1?r=1+c.gam1(n):(e=g+i-1,r=(1+c.gam1(e))/n),g*Math.exp(l)*(1+c.gam1(i))/r}if(i<=1){let r=Math.exp(l);if(0===r)return 0;let n=e+t;if(n<=1)l=1+c.gam1(n);else{let r=e+t-1;l=(1+c.gam1(r))/n}return u=(1+c.gam1(e))*(1+c.gam1(t))/l,r*=g*u/(1+g/i),r}let f=c.gamln1(g)+c.algdiv(g,i);return g*Math.exp(l-f)}a=o(r),s=c.alnrel(-r)}e<=t?(p=e/t,l=p/(1+p),f=1/(1+p),_=e-(e+t)*r):(p=t/e,l=1/(1+p),f=p/(1+p),_=(e+t)*n-t),d=-_/e,m=Math.abs(d)<=.6?c.rlog1(d):d-o(r/l),d=_/t,h=Math.abs(d)>.6?c.rlog1(d):d-o(n/f);let b=Math.exp(-(e*m+t*h));return.398942280401433*Math.sqrt(t*l)*b*Math.exp(-c.bcorr(e,t))}static brcmp1(e,t,r,n,i){let s,u,l,f,_,d,p,m=Math.min(t,r);if(m<8){let f,_;n<=.375?(f=o(n),_=c.alnrel(-n)):i<=.375?(f=c.alnrel(-i),_=o(i)):(f=o(n),_=o(i));let d=t*f+r*_;if(m<=1)return d-=c.betaln(t,r),c.esum(e,d);let p=Math.max(t,r);if(p>=8)return u=c.gamln1(m)+c.algdiv(m,p),m*c.esum(e,d-u);if(p<=1){let n=c.esum(e,d);return 0===n?0:(l=t+r,l<=1?d=1+c.gam1(l):(u=t+r-1,d=(1+c.gam1(u))/l),s=(1+c.gam1(t))*(1+c.gam1(r))/d,n*=m*s/(1+m/p),n)}u=c.gamln1(m);let h,g=a(p-1);if(g>=1){s=1;for(let e=1;e<=g;e++)p-=1,s*=p/(m+p);u=o(s)+u}return d-=u,p-=1,l=m+p,l<=1?h=1+c.gam1(l):(u=m+p-1,h=(1+c.gam1(u))/l),m*c.esum(e,d)*(1+c.gam1(p))/h}t<=r?(f=t/r,_=f/(1+f),d=1/(1+f),p=t-(t+r)*n):(f=r/t,_=1/(1+f),d=f/(1+f),p=(t+r)*i-r);let h,g=-p/t;u=Math.abs(g)<=.6?c.rlog1(g):g-o(n/_),g=p/r,h=Math.abs(g)<=.6?c.rlog1(g):g-o(i/d);let b=c.esum(e,-(t*u+r*h));return.398942280401433*Math.sqrt(r*_)*b*Math.exp(-c.bcorr(t,r))}static bpser(e,t,r,n){let i=0,s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0;if(0===r)return 0;if(b=Math.min(e,t),b>=1)m=e*o(r)-c.betaln(e,t),v=Math.exp(m)/e;else if(N=Math.max(e,t),N<8)if(N<=1){if(v=Math.pow(r,e),0===v)return 0;s=e+t,s<=1?m=1+c.gam1(s):(d=e+t-1,m=(1+c.gam1(d))/s),u=(1+c.gam1(e))*(1+c.gam1(t))/m,v*=u*(t/s)}else{if(d=c.gamln1(b),f=a(N-1),f>=1){for(u=1,l=1;l<=f;l++)N--,u*=N/(b+N);d=o(u)+d}m=e*o(r)-d,N--,s=b+N,s<=1?_=1+c.gam1(s):(d=b+N-1,_=(1+c.gam1(d))/s),v=Math.exp(m)*(b/e)*(1+c.gam1(N))/_}else d=c.gamln1(b)+c.algdiv(b,N),m=e*o(r)-d,v=b/e*Math.exp(m);if(0===v||e<=.1*n)return v;g=0,i=0,u=1,h=n/e;do{i++,u*=(.5-t/i+.5)*r,p=u/(e+i),g+=p}while(Math.abs(p)>h);return v*=1+e*g,v}static bratio(e,t,r,n,a,o,_){let d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0,M=0,R=0;if(g=c.spmpar(1),f("eps is: %d",g),a.val=0,o.val=0,e<0||t<0)_.val=1;else if(0!==e||0!==t)if(r<0||r>1)_.val=3;else if(n<0||n>1)_.val=4;else{if(b=r+n-.5-.5,!(s(b)>3*g)){if(_.val=0,0===r)return 0===e?void(_.val=6):(a.val=0,void(o.val=1));if(0===n)return 0===t?void(_.val=7):(a.val=1,void(o.val=0));if(0===e)return a.val=1,void(o.val=0);if(0===t)return a.val=0,void(o.val=1);if(g=Math.max(g,1e-15),Math.max(e,t)<.001*g)return a.val=t/(e+t),void(o.val=e/(e+t));if(p=0,N=e,v=t,M=r,R=n,u(N,v)<=1){if(r<=.5&&(p=1,N=t,v=e,M=n,R=r),v<u(g,g*N))return a.val=c.fpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(N<u(g,g*v)&&v*M<=1)return o.val=c.apser(N,v,M,g),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(Math.max(N,v)<=1){if(N>=Math.min(.2,v)||Math.pow(M,N)<=.9)return a.val=c.bpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(M>=.3)return o.val=c.bpser(v,N,R,g),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));m=20,o.val=c.bup(v,N,R,M,m,g),v+=m;let e=new i.NumberW(0);return c.bgrat(v,N,R,M,o,15*g,e),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))}if(v<=1)return a.val=c.bpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(M>=.3)return o.val=c.bpser(v,N,R,g),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(M<.1&&l(M*v,N)<=.7)return a.val=c.bpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(v>15){let e=new i.NumberW(0);return c.bgrat(v,N,R,M,o,15*g,e),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))}m=20,o.val=c.bup(v,N,R,M,m,g),v+=m;let s=new i.NumberW(0);return c.bgrat(v,N,R,M,o,15*g,s),a.val=.5-o.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))}if(d=e<=t?e-(e+t)*r:(e+t)*n-t,d<0&&(p=1,N=t,v=e,M=n,R=r,d=s(d)),v<40&&v*M<=.7)return a.val=c.bpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));if(v<40){if(m=Math.trunc(v),v-=m,0===v&&(m--,v=1),a.val=c.bup(v,N,R,M,m,g),M<=.7)return a.val+=c.bpser(N,v,M,g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h));N<=15&&(m=20,a.val+=c.bup(N,v,M,R,m,g),N+=m);let e=new i.NumberW(0);return c.bgrat(N,v,M,R,a,15*g,e),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))}return N<=v?N<=100||d>.03*N?(a.val=c.bfrac(N,v,M,R,d,15*g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))):(a.val=c.basym(N,v,d,100*g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))):v<=100||d>.03*v?(a.val=c.bfrac(N,v,M,R,d,15*g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h))):(a.val=c.basym(N,v,d,100*g),o.val=.5-a.val+.5,0===p?void 0:(h=a.val,a.val=o.val,void(o.val=h)))}_.val=5}else _.val=2}static bup(e,t,r,n,i,o){let s,u,l,f=0,_=1,d=0,p=0,m=0,h=e+t,g=e+1;if(1!==i&&e>1&&h>=1.1*g&&(f=a(Math.abs(c.exparg(1))),u=a(c.exparg(0)),u<f&&(f=u),d=f,_=Math.exp(-d)),s=c.brcmp1(f,e,t,r,n)/e,1===i||0===s)return s;let b=i-1;if(m=_,u=0,t<=1){for(let e=u+1;e<=b&&(l=e-1,_*=(h+l)/(g+l)*r,m+=_,!(_<=o*m));e++);return s*m}if(n>1e-4){if(p=(t-1)*r/n-e,p<1){for(let e=u+1;e<=b&&(l=e-1,_*=(h+l)/(g+l)*r,m+=_,!(_<=o*m));e++);return s*m}u=b,d=b,p<d&&(u=a(p))}else u=b;for(let e=1;e<=u;e++)l=e-1,_*=(h+l)/(g+l)*r,m+=_;if(u===b)return s*m;for(let e=u+1;e<=b&&(l=e-1,_*=(h+l)/(g+l)*r,m+=_,!(_<=o*m));e++);return s*m}static erf(e){const t=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],r=[.00301048631703895,.0538971687740286,.375795757275549],n=[-1.36864857382717e-7,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],i=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],a=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],o=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let s=0,u=0,l=0,f=0,_=0;if(s=Math.abs(e),s<=.5)return l=e*e,f=(((t[0]*l+t[1])*l+t[2])*l+t[3])*l+t[4]+1,u=((r[0]*l+r[1])*l+r[2])*l+1,e*(f/u);if(s<=4)return f=((((((n[0]*s+n[1])*s+n[2])*s+n[3])*s+n[4])*s+n[5])*s+n[6])*s+n[7],u=((((((i[0]*s+i[1])*s+i[2])*s+i[3])*s+i[4])*s+i[5])*s+i[6])*s+i[7],e<0?-(.5-Math.exp(-e*e)*f/u+.5):.5-Math.exp(-e*e)*f/u+.5;if(s<5.8){_=e*e,l=1/_,f=(((a[0]*l+a[1])*l+a[2])*l+a[3])*l+a[4],u=(((o[0]*l+o[2])*l+o[3])*l+o[3])*l+1;let t=(.564189583547756-f/(_*u))/s;return t=.5-Math.exp(-_)*t+.5,e<0?-t:t}return c.sign(1,e)}static erfc1(e,t){const r=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],n=[.00301048631703895,.0538971687740286,.375795757275549],i=[-1.36864857382717e-7,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],a=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],o=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],s=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let u=0,l=0,f=0,_=0,d=0,p=0,m=0;if(f=Math.abs(t),f<.5)return p=t*t,m=(((r[0]*p+r[1])*p+r[2])*p+r[3])*p+r[4]+1,d=((n[0]*p+n[1])*p+n[2])*p+1,u=.5-t*(m/d)+.5,0!==e&&(u*=Math.exp(p)),u;if(f<=4&&f>=.5)m=((((((i[0]*f+i[1])*f+i[2])*f+i[3])*f+i[4])*f+i[5])*f+i[6])*f+i[7],d=((((((a[0]*f+a[2])*f+a[2])*f+a[3])*f+a[5])*f+a[5])*f+a[6])*f+a[7],u=m/d;else{if(t<=-5.6)return 0!==e?2*Math.exp(t*t):2;if(0!==e)p=Math.pow(1/t,2),m=(((o[0]*p+o[1])*p+o[2])*p+o[3])*p+o[4],d=(((s[0]*p+s[2])*p+s[3])*p+s[3])*p+1,u=(.564189583547756-p*m/d)/f;else if(t>100||t*t>-c.exparg(1))return 0}return 0!==e?(t<0&&(u=2*Math.exp(t*t)-u),u):(l=t*t,p=l,_=l-p,u*=(.5-_+.5)*Math.exp(-p),t<0&&(u=2-u),u)}static esum(e,t){let r=0;return t<=0?e<0?(r=e,Math.exp(r)*Math.exp(t)):(r=e+t,r>0?(r=e,Math.exp(r)*Math.exp(t)):Math.exp(r)):e>0?(r=e,Math.exp(r)*Math.exp(t)):(r=e+t,r<0?(r=e,Math.exp(r)*Math.exp(t)):Math.exp(r))}static erf_values(e,t,r){const n=[0,.112462916,.2227025892,.3286267595,.428392355,.5204998778,.6038560908,.6778011938,.7421009647,.7969082124,.8427007929,.8802050696,.9103139782,.9340079449,.9522851198,.9661051465,.9763483833,.9837904586,.9890905016,.9927904292,.995322265];let i=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2];e.val<0&&(e.val=0),e.val++,21<e.val?(e.val=0,t.val=0,r.val=0):(t.val=i[e.val-1],r.val=n[e.val-1])}static exparg(e){let t=0,r=0,n=c.ipmpar(4);switch(n){case 2:t=.69314718055995;break;case 8:t=2.0794415416798;break;case 16:t=2.7725887222398;break;default:t=o(n)}return 0!==e?(r=c.ipmpar(6),.99999*r*t):(r=c.ipmpar(7),.99999*r*t)}static fpser(e,t,r,n){let i=0,a=0,s=0,u=0,l=0,f=1;if(e>.001*n){if(f=0,s=e*o(r),s<c.exparg(1))return f;f=Math.exp(s)}f*=t/e,u=n/e,l=e+1,s=r,a=s/l;do{l+=1,s*=r,i=s/l,a+=i}while(Math.abs(i)>u);return f*(1+e*a)}static gam1(e){const t=[.577215664901533,-.409078193005776,-.230975380857675,.0597275330452234,.0076696818164949,-.00514889771323592,.000589597428611429],r=[1,.427569613095214,.158451672430138,.0261132021441447,.00423244297896961],n=[-.422784335098468,-.771330383816272,-.244757765222226,.118378989872749,.000930357293360349,-.0118290993445146,.00223047661158249,.000266505979058923,-.000132674909766242];let i=0,a=0,o=0,s=0,u=0;return o=e,i=e-.5,i>0&&(o=i-.5),0===o?0:o>0?(u=(((((t[6]*o+t[5])*o+t[4])*o+t[3])*o+t[2])*o+t[1])*o+t[0],a=(((r[4]*o+r[3])*o+r[2])*o+r[1])*o+1,s=u/a,i<=0?e*s:o/e*(s-.5-.5)):(u=(((((((n[8]*o+n[7])*o+n[6])*o+n[5])*o+n[4])*o+n[3])*o+n[2])*o+n[1])*o+n[0],a=(.0559398236957378*o+.273076135303957)*o+1,s=u/a,i<=0?e*(s+.5+.5):o*s/e)}static grat1(e,t,r,n,i,a){let s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0,M=0,R=0,y=0,I=0,E=0;if(e*t==0)return t<=e?(n.val=0,void(i.val=1)):(n.val=1,void(i.val=0));if(.5===e)return t<.25?(n.val=c.erf(Math.sqrt(t)),void(i.val=.5-n.val+.5)):(i.val=c.erfc1(0,Math.sqrt(t)),void(n.val=.5-i.val+.5));if(t<1.1){E=3,m=t,R=t/(e+3),M=.1*a/(e+1);do{E++,m=t/E*-m,b=m/(e+E),R+=b}while(Math.abs(b)>M);return s=e*t*((R/6-.5/(e+2))*t+1/(e+1)),v=e*o(t),g=c.gam1(e),h=1+g,t<.25&&v>-.13394?(u=c.rexp(v),N=.5+(.5+u),i.val=(N*s-u)*h-g,i.val<0?(n.val=1,void(i.val=0)):void(n.val=.5-i.val+.5)):(N=Math.exp(v),n.val=N*h*(.5-s+.5),void(i.val=.5-n.val+.5))}y=1,_=1,I=t,d=t+(1-e),m=1;do{y=t*_+m*y,I=t*d+m*I,l=y/I,m++,p=m-e,_=y+p*_,d=I+p*d,f=_/d}while(Math.abs(f-l)>=a*f);return i.val=r*f,void(n.val=.5-i.val+.5)}static ipmpar(e){return[2,31,2147483647,2,24,-125,128,53,-1021,1024][e-1]}static gamma_inc_values(e,t,r,n){const i=[.1,.1,.1,.5,.5,.5,1,1,1,1.1,1.1,1.1,2,2,2,6,6,11,26,41],a=[.7382350532339351,.9083579897300343,.9886559833621947,.3014646416966613,.7793286380801532,.9918490284064972,.09516258196404043,.6321205588285577,.9932620530009145,.07205974576054322,.5891809618706485,.9915368159845525,.01018582711118352,.4421745996289254,.9927049442755639,.04202103819530612,.9796589705830716,.9226039842296428,.4470785799755852,.7444549220718699],o=[.03,.3,1.5,.075,.75,3.5,.1,1,5,.1,1,5,.15,1.5,7,2.5,12,16,25,45];e.val<0&&(e.val=0),e.val++,20<e.val?(e.val=0,t.val=0,r.val=0,n.val=0):(t.val=i[e.val-1],r.val=o[e.val-1],n.val=a[e.val-1])}static gamma_log_values(e,t,r){const n=[1.524064183,.7966780066,.3982337117,.1520599127,0,-.04987246543,-.08537410945,-.1081747934,-.119612895,-.120782204,-.1125917658,-.09580771625,-.07108385116,-.0389842838,0,12.80182743,39.33988571,71.25704193],i=[.2,.4,.6,.8,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,10,20,30];e.val<0&&(e.val=0),e.val++,18<e.val?(e.val=0,t.val=0,r.val=0):(t.val=i[e.val-1],r.val=n[e.val-1])}static gamln(e){let t=0,r=0,n=0,i=0;if(e<=.8)return c.gamln1(e)-o(e);if(e<=2.25)return n=e-.5-.5,c.gamln1(n);if(e<10){for(r=a(e-1.25),n=e,i=1,t=1;t<=r;t++)n--,i*=n;return c.gamln1(n-1)+o(i)}return n=Math.pow(1/e,2),i=(((((-.00165322962780713*n+.000837308034031215)*n-.00059520293135187)*n+.00079365066682539)*n-.00277777777760991)*n+.0833333333333333)/e,.418938533204673+i+(e-.5)*(o(e)-1)}static gamln1(e){let t=0,r=0;return e<.6?(t=((((((-.00271935708322958*e-.0673562214325671)*e-.402055799310489)*e-.780427615533591)*e-.168860593646662)*e+.844203922187225)*e+.577215664901533)/((((((.000667465618796164*e+.0325038868253937)*e+.361951990101499)*e+1.56875193295039)*e+3.12755088914843)*e+2.88743195473681)*e+1),-e*t):(r=e-.5-.5,t=(((((.000497958207639485*r+.017050248402265)*r+.156513060486551)*r+.565221050691933)*r+.848044614534529)*r+.422784335098467)/(((((.000116165475989616*r+.00713309612391)*r+.10155218743983)*r+.548042109832463)*r+1.24313399877507)*r+1),r*t)}static gsumln(e,t){let r=e+t-2;return r<=.25?c.gamln1(1+r):r<=1.25?c.gamln1(r)+c.alnrel(r):c.gamln1(r-1)+o(r*(1+r))}static psi(e){const t=[.0089538502298197,4.77762828042627,142.441585084029,1186.45200713425,3633.51846806499,4138.10161269013,1305.60269827897],r=[44.8452573429826,520.752771467162,2210.0079924783,3641.27349079381,1908.310765963,691091682714533e-20],n=[-2.12940445131011,-7.01677227766759,-4.48616543918019,-.648157123766197],i=[32.2703493791143,89.2920700481861,54.6117738103215,7.77788548522962];let s=0,u=0,l=0,f=0,_=0,d=0,p=0,m=0,h=0,g=0,b=0,N=0,v=0,M=0;if(l=c.ipmpar(3),l=Math.min(l,1/c.spmpar(1)),u=1e-9,b=e,d=0,b<.5){if(Math.abs(b)<=1e-9){if(0===b)return 0;d=-1/b}else{if(g=-b,h=.785398163397448,g<=0&&(g=-g,h=-h),g>=l)return 0;if(s=a(g),g-=s,s=a(4*g),g=4*(g-.25*s),m=s/2,m+m!==s&&(g=1-g),N=.785398163397448*g,p=m/2,p+p!==m&&(h=-h),m=(s+1)/2,p=m/2,p+=p,p===m){if(0===N)return 0;d=h*(Math.cos(N)/Math.sin(N)*4)}else d=h*(Math.sin(N)/Math.cos(N)*4)}b=1-b}if(b<=3){for(f=b,v=t[1]*b,_=0;_<5;_++)f=(f+r[_])*b,v=(v+t[_+1])*b;return f=(v+t[6])/(f+r[5]),M=b-1.4616321449683622,f*M+d}if(b<l){for(g=1/(b*b),f=g,v=n[0]*g,_=0;_<3;_++)f=(f+i[_])*g,v=(v+n[_+1])*g;d=v/(f+i[3])-.5/b+d}return d+o(b)}static psi_values(e,t,r){const n=[-.5772156649,-.4237549404,-.2890398966,-.1691908889,-.0613845446,-.036489974,.1260474528,.2085478749,.2849914333,.3561841612,.4227843351],i=[1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2];e.val<0&&(e.val=0),e.val++,11<e.val?(e.val=0,t.val=0,r.val=0):(t.val=i[e.val-1],r.val=n[e.val-1])}static r4_epsilon(){let e=1,t=1+e/2;for(;1<t;)e/=2,t=1+e/2;return e}static rexp(e){let t=0;return Math.abs(e)<=.15?e*(((.0238082361044469*e+9.14041914819518e-10)*e+1)/(((.000595130811860248*e-.0119041179760821)*e+.107141568980644)*e-.499999999085958)*e+1):(t=Math.exp(e),e<=0?t-.5-.5:t*(.5-1/t+.5))}static rlog1(e){let t=0,r=0,n=0,i=0,a=0;return e<-.39||e>.57?(i=e+.5+.5,e-o(i)):(e<-.18?(t=e+.3,t/=.7,a=.0566749439387324-.3*t):e>.18?(t=.75*e-.25,a=.0456512608815524+t/3):(t=e,a=0),r=t/(t+2),n=r*r,i=((.00620886815375787*n-.224696413112536)*n+.333333333333333)/((.354508718369557*n-1.27408923933623)*n+1),2*n*(1/(1-r)-r*i)+a)}static sign(e,t){return t>=0?Math.abs(e):-Math.abs(e)}static spmpar(e){let t=0,r=0,n=0,i=0,a=0,o=0,s=0,u=0,l=0,f=0;return e>1?e>2?(a=c.ipmpar(4),s=c.ipmpar(5),r=c.ipmpar(7),o=a,i=a-1,u=1,f=Math.pow(o,s-1),l=((f-u)*o+i)/(o*f),f=Math.pow(o,r-2),l*f*o*o):(o=c.ipmpar(4),t=c.ipmpar(6),u=1,n=u/o,l=Math.pow(o,t+2),l*n*n*n):(o=c.ipmpar(4),s=c.ipmpar(5),Math.pow(o,1-s))}}t.Toms708=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(1),a=r(2),{log:o,exp:s}=Math,{isNaN:u}=Number,l=i("dexp");t.dexp=function(e,t,r=!1){return a.map(e)(e=>u(e)||u(t)?NaN:t<=0?n.ML_ERR_return_NAN(l):e<0?n.R_D__0(r):r?-e/t-o(t):s(-e/t)/t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(2),a=r(1),o=r(3),{expm1:s}=Math,{isNaN:u}=Number,l=a("pexp");t.pexp=function(e,t,r,a){return i.map(e)(e=>u(e)||u(t)?e+t:t<0?n.ML_ERR_return_NAN(l):e<=0?n.R_DT_0(r,a):(e=-e/t,r?a?o.R_Log1_Exp(e):-s(e):n.R_D_exp(a,e)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(3),{isNaN:s}=Number,u=n("qexp");t.qexp=function(e,t,r,n){return a.map(e)(e=>{if(s(e)||s(t))return e+t;if(t<0)return i.ML_ERR_return_NAN(u);let a=i.R_Q_P01_check(n,e);return void 0!==a?a:e===i.R_DT_0(r,n)?0:-t*o.R_DT_Clog(r,n,e)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(1),a=r(28),{isFinite:o}=Number,s=i("rexp");t.rexp=function(e=1,t=1,r){const i=new Array(e).fill(0).map(e=>!o(t)||t<=0?0===t?0:n.ML_ERR_return_NAN(s):t*a.exp_rand(r.unif_rand));return 1===i.length?i[0]:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(17),o=r(21),{log:s}=Math,{isNaN:u,isFinite:l,POSITIVE_INFINITY:f}=Number,c=n("df");t.df=function(e,t,r,n=!1){const _=(Array.isArray(e)?e:[e]).map(e=>{let _,d,p,m;return u(e)||u(t)||u(r)?e+t+r:t<=0||r<=0?i.ML_ERR_return_NAN(c):e<0?i.R_D__0(n):0===e?t>2?i.R_D__0(n):2===t?i.R_D__1(n):f:l(t)||l(r)?l(r)?t>1e14?(m=o.dgamma(1/e,r/2,2/r,n),n?m-2*s(e):m/(e*e)):(p=1/(r+e*t),d=r*p,_=e*t*p,t>=2?(p=t*d/2,m=a.dbinom_raw((t-2)/2,(t+r-2)/2,_,d,n)):(p=t*t*d/(2*_*(t+r)),m=a.dbinom_raw(t/2,(t+r)/2,_,d,n)),n?s(p)+m:p*m):o.dgamma(e,t/2,2/t,n):1===e?f:i.R_D__0(n)});return 1===_.length?_[0]:_}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(54),o=r(61),s=r(21),{log1p:u,log:l}=Math,{isFinite:f,isNaN:c,POSITIVE_INFINITY:_}=Number,d=n("dnf");t.dnf=function(e,t,r,n,p){const m=(Array.isArray(e)?e:[e]).map(e=>{let m,h,g;return c(e)||c(t)||c(r)||c(n)?e+r+t+n:t<=0||r<=0||n<0?i.ML_ERR_return_NAN(d):e<0?i.R_D__0(p):f(n)?f(t)||f(r)?f(r)?t>1e14&&n<1e7?(g=1+n/t,h=s.dgamma(1/e/g,r/2,2/r,p),p?h-2*l(e)-l(g):h/(e*e)/g):(m=t/r*e,h=a.dnbeta(m/(1+m),t/2,r/2,n,p),p?h+l(t)-l(r)-2*u(m):h*(t/r)/(1+m)/(1+m)):t*o.dnchisq(e*t,t,n,p):1===e?_:i.R_D__0(p):i.ML_ERR_return_NAN(d)});return 1===m.length?m[0]:m}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(12),o=r(38),{isNaN:s,POSITIVE_INFINITY:u,NaN:l,isFinite:f}=Number,{LN2:c}=Math,_=n("pf");t.pf=function(e,t,r,n=!0,d=!1){const p=(Array.isArray(e)?e:[e]).map(e=>{if(s(e)||s(t)||s(r))return e+r+t;if(t<=0||r<=0)return i.ML_ERR_return_NAN(_);let p=i.R_P_bounds_01(n,d,e,0,u);if(void 0!==p)return p;if(r===u){if(t===u){if(e<1)return i.R_DT_0(n,d);if(1===e)return d?-c:.5;if(e>1)return i.R_DT_1(n,d)}return o.pchisq(e*t,t,n,d)}return t===u?o.pchisq(r/e,r,!n,d):(e=t*e>r?a.pbeta(r/(r+t*e),r/2,t/2,!n,d):a.pbeta(t*e/(r+t*e),t/2,r/2,n,d),f(e)?e:l)});return 1===p.length?p[0]:p}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(35),o=r(39),{isNaN:s,isFinite:u,POSITIVE_INFINITY:l}=Number,f=n("pnf");t.pnf=function(e,t,r,n,c=!0,_=!1){const d=(Array.isArray(e)?e:[e]).map(e=>{let d;if(s(e)||s(t)||s(r)||s(n))return e+r+t+n;if(t<=0||r<=0||n<0)return i.ML_ERR_return_NAN(f);if(!u(n))return i.ML_ERR_return_NAN(f);if(!u(t)&&!u(r))return i.ML_ERR_return_NAN(f);let p=i.R_P_bounds_01(c,_,e,0,l);return void 0!==p?p:r>1e8?o.pnchisq(e*t,t,n,c,_):(d=t/r*e,a.pnbeta2(d/(1+d),1/(1+d),t/2,r/2,n,c,_))});return 1===d.length?d[0]:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(55),o=r(40),s=n("qf"),{isNaN:u,isFinite:l,NaN:f,POSITIVE_INFINITY:c,isFinite:_}=Number;t.qf=function(e,t,r,n,d){const p=(Array.isArray(e)?e:[e]).map(e=>{if(u(e)||u(t)||u(r))return e+t+r;if(t<=0||r<=0)return i.ML_ERR_return_NAN(s);let p=i.R_Q_P01_boundaries(n,d,e,0,c);return void 0!==p?p:t<=r&&r>4e5?l(t)?o.qchisq(e,t,n,d)/t:1:t>4e5?r/o.qchisq(e,r,!n,d):(e=(1/a.qbeta(e,r/2,t/2,!n,d)-1)*(r/t),_(e)?e:f)});return 1===p.length?p[0]:p}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(56),o=r(62),{isNaN:s,isFinite:u,POSITIVE_INFINITY:l}=Number,f=n("qnf");t.qnf=function(e,t,r,n,c=!0,_=!1){const d=(Array.isArray(e)?e:[e]).map(e=>{let d;if(s(e)||s(t)||s(r)||s(n))return e+t+r+n;switch(!0){case t<=0||r<=0||n<0:case!u(n):case!u(t)&&!u(r):return i.ML_ERR_return_NAN(f)}let p=i.R_Q_P01_boundaries(c,_,e,0,l);return void 0!==p?p:r>1e8?o.qnchisq(e,t,n,c,_)/t:(d=a.qnbeta(e,t/2,r/2,n,c,_),d/(1-d)*(r/t))});return 1===d.length?d[0]:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(13),o=r(2),s=n("rf"),{isNaN:u,isFinite:l}=Number,f=o.seq()();t.rf=function(e,t,r,n){return o.map(f(e))(()=>{let e,o;return u(t)||u(r)||t<=0||r<=0?i.ML_ERR_return_NAN(s):(e=l(t)?a.rchisq(1,t,n)/t:1,o=l(r)?a.rchisq(1,r,n)/r:1,e/o)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{max:n,log1p:i,exp:a,abs:o}=Math;t.logspace_add=function(e,t){return n(e,t)+i(a(-o(e-t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(9),o=r(2),s=n("dpsifn"),{NaN:u,POSITIVE_INFINITY:l,isNaN:f,EPSILON:c}=Number,{pow:_,abs:d,max:p,min:m,exp:h,log:g,sin:b,cos:N,PI:v,round:M,round:R}=Math;function y(e,t,r,n,a,o,f){const R=[1,-.5,.16666666666666666,-.03333333333333333,.023809523809523808,-.03333333333333333,.07575757575757576,-.2531135531135531,1.1666666666666667,-7.092156862745098,54.971177944862156,-529.1242424242424,6192.123188405797,-86580.25311355312,1425517.1666666667,-27298231.067816094,601580873.9006424,-15116315767.092157,429614643061.1667,-13711655205088.332,488332318973593.2,-0x448e22fd0e7564];let I,E,w,P,x,A,O,T,L,S,q,D,C,j,F,k,V,B,Q,G,U,H,Y,W,z,K,X,J,$,Z,ee,te,re,ne,ie,ae,oe=0,se=0,ue=0,le=0,fe=new Array(23).fill(0),ce=new Array(101).fill(0);if(f.val=0,t<0||r<1||r>2||n<1)return void(f.val=1);if(e<=0){if(e===M(e)){for(w=0;w<n;w++)a[w]=(w+t)%2?l:u;return}if(y(1-e,t,1,n,a,o,f),n>1||t>3)return void(f.val=4);for(e*=v,$=0===t?N(e)/b(e):1===t?-1/i.R_pow_di(b(e),2):2===t?2*N(e)/i.R_pow_di(b(e),3):3===t?-2*(2*i.R_pow_di(N(e),2)+1)/i.R_pow_di(b(e),4):u,G=t%2?-1:1,Z=ee=G=1,P=0,w=P-t;w<n;P++,w++,G=-G)Z*=v,P>=2&&(ee*=P),w>=0&&(a[w]=G*(a[w]+Z/ee*$));return void(0===t&&2===r&&(a[0]+=le))}if(o.val=0,le=g(e),1===r&&1===n){let r=1/(2*c);if(0===t&&e*le>r)return void(a[0]=-le);if(t>=1&&e>t*r)return void(a[0]=h(-t*le)/t)}x=n,I=i.imin2(-i.DBL_MIN_EXP,i.DBL_MAX_EXP),Q=i.M_LOG10_2,B=.5*Number.EPSILON,te=p(B,5e-19),D=2.302*(I*Q-3);let _e=!1,de=!1,pe=!1;for(;;){if(O=t+x-1,L=O,H=(L+1)*le,d(H)>D){if(H<=0)return o.val=0,void(f.val=2)}else{if(e<te){if(a[0]=i.R_pow_di(e,-t-1),1!==x)for(P=1;P<x;P++)a[P]=a[P-1]/e;return void(0===t&&2===r&&(a[0]+=le))}if(k=Q*i.DBL_MANT_DIG,k=m(k,18.06),j=p(k,3)-3,ae=3.5+.4*j,U=.21+j*(6038e-7*j+.008677),re=ae+U*L,A=1+(re>>0),ne=A,0!==t&&(re=-2.302*k-m(0,le),S=re/t,S=m(0,S),C=h(S),re=1-C,d(S)<.001&&(re=-S),j=e*re/C,re=ne-e,re>7&&j<15))break;if(ue=e,se=le,oe=0,e<ne&&(I=e>>0,oe=ne-I,ue=e+oe,se=g(ue)),H=L*se,Z=se+se,ee=H+se,W=p(d(H),p(d(Z),d(ee))),W<=D){_e=!0;break}}if(o.val++,x--,a[x]=0,0===x)return}if(_e){if(X=h(-H),$=.5/ue,Z=$,J=te*$,0!==O&&(Z=$+1/L),V=1/(ue*ue),Y=.5*V,H=(L+1)*Y,G=H*R[2],d(G)>=J)for(W=2,P=4;P<=22&&(H=H*((W+L+1)/(W+1))*((W+L)/(W+2))*V,fe[P]=H*R[P-1],!(d(fe[P])<J));P++)G+=fe[P],W+=2;for(G=(G+Z)*X;;){if(0!==oe){if(I=oe>>0,T=O+1,I>100)return o.val=0,void(f.val=3);if(0===O){de=!0;break}for(re=oe-1,F=e+re,E=1;E<=I;E++)ce[E]=_(F,-T),G+=ce[E],re-=1,F=e+re}if(a[x-1]=G,0===L){pe=!0;break}for(w=2;w<=x;w++){if(L--,X*=ue,Z=$,0!==L&&(Z=$+1/L),H=(L+1)*Y,G=H*R[2],d(G)>=J)for(W=4+L,P=4;P<=22&&(fe[P]=fe[P]*(L+1)/W,!(d(fe[P])<J));P++)G+=fe[P],W+=2;if(G=(G+Z)*X,0!==oe){if(0===L){de=!0;break}for(re=oe-1,F=e+re,E=1;E<=I;E++)ce[E]=ce[E]*F,G+=ce[E],re-=1,F=e+re}if(a[x-w]=G,0===L){pe=!0;break}}return}if(s(de?"goto L20 was set!":"goto L20 was not set"),!pe)for(E=1;E<=I;E++)G+=1/(e+(I-E));2!==r?a[0]=G-se:ue!==e&&(ie=ue/e,a[0]=G-g(ie))}else{for(O=1+(j>>0),T=t+1,Z=(t+1)*le,H=h(-Z),G=H,q=e,E=1;E<=O;E++)q+=1,fe[E]=_(q,-T),G+=fe[E];if(a[0]=G,0===t&&2===r&&(a[0]=G+le),1!==x)for(z=te/5,w=1;w<x;w++){for(H/=e,G=H,K=H*z,q=e,E=1;E<=O&&(q+=1,fe[E]/=q,G+=fe[E],!(fe[E]<K));E++);a[w]=G}}}const I=n("psigamma");t.psigamma=function(e,t=0){let r=[0],n=new a.NumberW,i=new a.NumberW;return o.multiplexer(e,t)((e,t)=>{let a,o;if(n.val=0,i.val=0,r[0]=0,f(e))return e;if(o=(t=R(t))>>0,o>100)return I('"deriv = %d > %d (= n_max)',o,100),u;if(y(e,o,1,1,r,n,i),0!==i.val)return u;for(r[0]=-r[0],a=1;a<=o;a++)r[0]*=-a;return r[0]})},t.digamma=function(e){let t=[0],r=new a.NumberW,n=new a.NumberW;return o.map(e)(e=>(t[0]=0,r.val=0,n.val=0,f(e)?e:(y(e,0,1,1,t,r,n),0!==n.val?u:-t[0])))},t.trigamma=function(e){let t=[0],r=new a.NumberW(0),n=new a.NumberW(0);return o.map(e)(e=>(t[0]=0,r.val=0,n.val=0,f(e)?e:(y(e,1,1,1,t,r,n),0!==n.val?u:t[0])))},t.tetragamma=function(e){let t=[0],r=new a.NumberW,n=new a.NumberW;return o.map(e)(e=>(t[0]=0,r.val=0,n.val=0,f(e)?e:(y(e,2,1,1,t,r,n),0!==n.val?u:-2*t[0])))},t.pentagamma=function(e){let t=[0],r=new a.NumberW,n=new a.NumberW;return o.map(e)(e=>(t[0]=0,r.val=0,n.val=0,f(e)?e:(y(e,3,1,1,t,r,n),0!==n.val?u:6*t[0])))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(17),a=r(0),{isNaN:o,isFinite:s}=Number,{round:u,log:l}=Math,f=n("dgeom");t.dgeom=function(e,t,r=!1){const n=(Array.isArray(e)?e:[e]).map(e=>{let n;if(o(e)||o(t))return e+t;if(t<=0||t>1)return a.ML_ERR_return_NAN(f);let c=a.R_D_nonint_check(r,e,f);return void 0!==c?c:e<0||!s(e)||0===t?a.R_D__0(r):(e=u(e),n=i.dbinom_raw(0,e,t,1-t,r),r?l(t)+n:t*n)});return 1===n.length?n[0]:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),{expm1:o,log1p:s,log:u,exp:l,floor:f}=Math,{isNaN:c,isFinite:_}=Number,d=n("pgeom");t.pgeom=function(e,t,r=!0,n=!1){const p=(Array.isArray(e)?e:[e]).map(e=>c(e)||c(t)?e+t:t<=0||t>1?i.ML_ERR_return_NAN(d):e<0?i.R_DT_0(r,n):_(e)?(e=f(e+1e-7),1===t?(e=r?1:0,n?u(e):e):(e=s(-t)*(e+1),n?a.R_DT_Clog(r,n,e):r?-o(e):l(e))):i.R_DT_1(r,n));return 1===p.length?p[0]:p}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),{ceil:o,max:s,log1p:u}=Math,{POSITIVE_INFINITY:l,isNaN:f}=Number,c=n("qgeom");t.qgeom=function(e,t,r=!0,n=!1){const _=(Array.isArray(e)?e:[e]).map(e=>{if(t<=0||t>1)return i.ML_ERR_return_NAN(c);let _=i.R_Q_P01_boundaries(r,n,e,0,l);return void 0!==_?_:f(e)||f(t)?e+t:1===t?0:s(0,o(a.R_DT_Clog(r,n,e)/u(-t)-1-1e-12))});return 1===_.length?_[0]:_}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(28),o=r(32),{isFinite:s}=Number,u=n("rgeom");t.rgeom=function(e,t,r){const n=new Array(e).fill(0).map(()=>!s(t)||t<=0||t>1?i.ML_ERR_return_NAN(u):o.rpois(1,a.exp_rand(r.unif_rand)*((1-t)/t),r));return 1===n.length?n[0]:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(11),{log:i}=Math;t.lfastchoose=function(e,t){return-i(e+1)-n.internal_lbeta(e-t+1,t+1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=r(69),{floor:u,round:l,log1p:f}=Math,{EPSILON:c,isNaN:_,isFinite:d}=Number,p=n("phyper");t.phyper=function(e,t,r,n,m=!0,h=!1){return o.map(e)(e=>{let o,g,b=m,N=h,v=t,M=r,R=n;if(_(e)||_(v)||_(M)||_(R))return e+v+M+R;if(e=u(e+1e-7),v=l(v),M=l(M),R=l(R),v<0||M<0||!d(v+M)||R<0||R>v+M)return i.ML_ERR_return_NAN(p);if(e*(v+M)>R*v){let t=M;M=v,v=t,e=R-e-1,b=!b}return e<0?i.R_DT_0(b,N):e>=v||e>=R?i.R_DT_1(b,N):(o=s.dhyper(e,v,M,R,N),g=function(e,t,r,n,i){let a=0,o=1;for(;e>0&&o>=c*a;)o*=e*(r-n+e)/(n+1-e)/(t+1-e),a+=o,e--;let s=a;return i?f(s):1+s}(e,v,M,R,N),N?a.R_DT_log(b,N,o+g):i.R_D_Lval(b,o*g))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(36),a=r(0),o=r(70),{log:s,round:u,exp:l,sqrt:f}=Math,{isFinite:c,MAX_SAFE_INTEGER:_}=Number,d=n("afc");function p(e){const t=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415];if(e<0)return d("rhyper.c: afc(i), i=%d < 0 -- SHOULD NOT HAPPEN!",e),-1;if(e<=7)return t[e];let r=e,n=r*r;return(r+.5)*s(r)-r+a.M_LN_SQRT_2PI+(.0833333333333333-.00277777777777778/n)/r}t.afc=p,t.rhyper=function(e,t,r,n,d){const h=new Array(e).fill(0).map(()=>function(e,t,r,n){let d=0,h=0,g=0,b=0,N=!1,v=!1,M=-1,R=-1,y=-1,I=0,E=0,w=0,P=0,x=0,A=0,O=0,T=0,L=0,S=0,q=0,D=0,C=0,j=0,F=0,k=0,V=0,B=0,Q=0,G=0;if(!c(e)||!c(t)||!c(r))return a.ML_ERR_return_NAN(m);if(e=u(e),t=u(t),r=u(r),e<0||t<0||r<0||r>e+t)return a.ML_ERR_return_NAN(m);if(e>=_||t>=_||r>=_)return 1===r?i.rbinom(1,r,e/(e+t),n):o.qhyper(n.unif_rand(),e,t,r,!1,!1);if(d=e,h=t,g=r,d!==R||h!==y?(N=!0,v=!0):g!==M?(N=!1,v=!0):(N=!1,v=!1),N&&(R=d,y=h,O=d+h,d<=h?(x=d,A=h):(x=h,A=d)),v&&(M=g,P=g+g>=O?O-g:g),(N||v)&&(I=(P+1)*(x+1)/(O+2),E=a.imax2(0,P-A),w=a.imin2(x,P),m("rhyper(nn1=%d, nn2=%d, kk=%d), setup: floor(mean)= m=%d, jx in (%d..%d)",d,h,g,I,E,w)),E===w)m("rhyper(), branch I (degenerate)"),b=w;else if(I-E<10){const e=1e25,t=57.564627324851145;if(N||v){let e;e=P<A?p(A)+p(x+A-P)-p(A-P)-p(x+A):p(x)+p(P)-p(P-A)-p(x+A),T=l(e+t)}let r=0,i=0;m("rhyper(), branch II; w = %d > 0",T);let a=!1;for(;;){for(r=T,b=E,i=n.unif_rand()*e,m("  _new_ u = %d",i);i>r;)if(i-=r,r*=(x-b)*(P-b),b++,r=r/b/(A-P+b),m("       ix=%d, u=%d, p=%d (u-p=%d)\n",b,i,r,i-r),b>w){a=!0;break}if(!a)break}}else{(N||v)&&(q=f((O-P)*P*x*A/(O-1)/O/O),S=1.5*q+.5,D=I-S+.5,C=I+S+.5,L=p(I)+p(x-I)+p(P-I)+p(A-P+I),j=l(L-p(D)-p(x-D)-p(P-D)-p(A-P+D)),F=l(L-p(C-1)-p(x-C+1)-p(P-C+1)-p(A-P+C-1)),k=-s(D*(A-P+D)/(x-D+1)/(P-D+1)),V=-s((x-C+1)*(P-C+1)/C/(A-P+C)),B=S+S,Q=B+j/k,G=Q+F/V),m("rhyper(), branch III {accept/reject}: (xl,xr)= (%d,%d); (lamdl,lamdr)= (%d,%d)\n",D,C,k,V),m("-------- p123= c(%d,%d,%d)\n",B,Q,G);let e=0;for(;;){let t=n.unif_rand()*G,r=n.unif_rand();if(e++,e>=1e4)return m("rhyper() branch III: giving up after %d rejections",e),a.ML_ERR_return_NAN(m);if(m(" ... L30: new (u=%d, v ~ U[0,1])[%d]\n",t,e),t<B)b=D+t;else if(t<=Q){if(b=D+s(r)/k,b<E)continue;r=r*(t-B)*k}else{if(b=C-s(r)/V,b>w)continue;r=r*(t-Q)*V}let i=!0;if(I<100||b<=50){let e,t=1;if(I<b)for(e=I+1;e<=b;e++)t=t*(x-e+1)*(P-e+1)/(A-P+e)/e;else if(I>b)for(e=b+1;e<=I;e++)t=t*e*(A-P+e)/(x-e+1)/(P-e+1);r<=t&&(i=!1)}else{const e=.0078,t=.0034;let n,a,o,u,l,f,c,_,d,h,g,N,v,M,R,y,E,w,O,T,S,D,C;m(" ... accept/reject 'large' case v=%d",r),l=b,O=l+1,T=l-I,S=x-l+1,D=P-l+1,v=A-P+O,o=-T/O,q=T/S,u=T/D,n=-T/v,a=S*D/(O*v)-1,c=1,a<0&&(c=1+a),N=a*(1+a*(a/3-.5)),g=N-a*a*a*a*.25/c,E=I+.5,w=x-I+.5,y=P-I+.5,M=A-P+E,R=l*N-I*g+t+E*o*(1+o*(o/3-.5))+w*q*(1+q*(q/3-.5))+y*u*(1+u*(u/3-.5))+M*n*(1+n*(n/3-.5)),C=s(r),C>R?i=!0:(_=E*(o*o*o*o),o<0&&(_/=1+o),d=w*(q*q*q*q),q<0&&(d/=1+q),h=y*(u*u*u*u),u<0&&(h/=1+u),f=M*(n*n*n*n),n<0&&(f/=1+n),i=!(C<R-.25*(_+d+h+f)+(l+I)*(g-N)-e||C<=L-p(b)-p(x-b)-p(P-b)-p(A-P+b)))}if(!i)break}}return g+g>=O?b=d>h?g-h+b:d-b:d>h&&(b=g-b),b}(t,r,n,d));return 1===h.length?h[0]:h};const m=n("_rhyper")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(34);t.Beta=n.Beta;var i=r(81);t.Binomial=i.Binomial;var a=r(80);t.NegativeBinomial=a.NegativeBinomial;var o=r(82);t.Cauchy=o.Cauchy;var s=r(83);t.ChebyshevSeries=s.ChebyshevSeries;var u=r(84);t.ChiSquared=u.ChiSquared;var l=r(86);t.Exponential=l.Exponential;var f=r(87);t.FDist=f.FDist;var c=r(25);t.Gamma=c.Gamma;var _=r(88);t.Geometric=_.Geometric;var d=r(89);t.HyperGeometric=d.HyperGeometric;var p=r(90);t.Logistic=p.Logistic;var m=r(91);t.LogNormal=m.LogNormal;var h=r(92);t.Multinomial=h.Multinomial;var g=r(93);t.Normal=g.Normal;var b=r(94);t.Poisson=b.Poisson;var N=r(16);t.rng=N.rng,t.IRNG=N.IRNG,t.IRNGNormal=N.IRNGNormal;var v=r(95);t.SignRank=v.SignRank;var M=r(96);t.StudentT=M.StudentT;var R=r(97);t.Tukey=R.Tukey;var y=r(98);t.Uniform=y.Uniform;var I=r(99);t.Weibull=I.Weibull;var E=r(100);t.Wilcoxon=E.Wilcoxon;const w=r(79),P=r(34),x=r(85),A=r(25);t.special=Object.freeze(Object.assign({},A.special,P.special,x.special,w.special));const O=r(2);t.R={any:O.any,arrayrify:O.arrayrify,asArray:O.asArray,div:O.div,flatten:O.flatten,isOdd:O.isOdd,map:O.map,each:O.each,mult:O.mult,multiplex:O.multiplex,multiplexer:O.multiplexer,numberPrecision:O.numberPrecision,selector:O.selector,seq:O.seq,sum:O.sum,summary:O.summary,Welch_Satterthwaite:O.Welch_Satterthwaite,c:O.flatten}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{log:o,exp:s,abs:u}=Math,{isNaN:l}=Number,f=n("dlogis");t.dlogis=function(e,t=0,r=1,n=!1){return a.map(e)(e=>{let a,c;return l(e)||l(t)||l(r)?NaN:r<=0?i.ML_ERR_return_NAN(f):(e=u((e-t)/r),a=s(-e),c=1+a,n?-(e+o(r*c*c)):a/(r*c*c))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{exp:o,log1p:s}=Math,{isNaN:u}=Number;function l(e){return e<=18?s(o(e)):e>33.3?e:e+o(-e)}t.Rf_log1pexp=l;const f=n("plogis");t.plogis=function(e,t=0,r=1,n=!0,s=!1){return a.map(e)(e=>{if(u(e)||u(t)||u(r))return e+t+r;if(r<=0)return i.ML_ERR_return_NAN(f);if(u(e=(e-t)/r))return i.ML_ERR_return_NAN(f);let a=i.R_P_bounds_Inf_01(n,s,e);return void 0!==a?a:s?-l(n?-e:e):1/(1+o(n?-e:e))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),{isNaN:s,POSITIVE_INFINITY:u,NEGATIVE_INFINITY:l}=Number,{log:f}=Math,c=n("qlogis");t.qlogis=function(e,t=0,r=1,n=!0,_=!1){return o.map(e)(e=>{if(s(e)||s(t)||s(r))return e+t+r;let o=i.R_Q_P01_boundaries(n,_,e,l,u);return void 0!==o?o:r<0?i.ML_ERR_return_NAN(c):0===r?t:(_?n?e-=a.R_Log1_Exp(e):e=a.R_Log1_Exp(e)-e:e=f(n?e/(1-e):(1-e)/e),t+r*e)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{log:o}=Math,{isNaN:s,isFinite:u}=Number,l=a.seq()(),f=n("rlogis");t.rlogis=function(e,t=0,r=1,n){return a.map(l(e))(()=>{if(s(t)||!u(r))return i.ML_ERR_return_NAN(f);if(0!==r&&u(t)){let e=n.unif_rand();return t+r*o(e/(1-e))}return t})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{isNaN:o,POSITIVE_INFINITY:s}=Number,{log:u,exp:l}=Math,f=n("dlnorm");t.dlnorm=function(e,t,r,n){return a.map(e)(e=>{if(o(e)||o(t)||o(r))return e+t+r;if(r<=0)return r<0?i.ML_ERR_return_NAN(f):u(e)===t?s:i.R_D__0(n);if(e<=0)return i.R_D__0(n);let a=(u(e)-t)/r;return n?-(i.M_LN_SQRT_2PI+.5*a*a+u(e*r)):i.M_1_SQRT_2PI*l(-.5*a*a)/(e*r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(19),o=r(2),{isNaN:s}=Number,{log:u}=Math,l=n("plnorm");t.plnorm=function(e,t=0,r=1,n=!0,f=!1){return o.map(e)(e=>s(e)||s(t)||s(r)?e+t+r:r<0?i.ML_ERR_return_NAN(l):e>0?a.pnorm5(u(e),t,r,n,f):i.R_DT_0(n,f))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(6),a=r(2),{exp:o}=Math,{isNaN:s,POSITIVE_INFINITY:u}=Number;t.qlnorm=function(e,t=0,r=1,l=!0,f=!1){return a.map(e)(e=>s(e)||s(t)||s(r)?e+t+r:(n.R_Q_P01_boundaries(l,f,e,0,u),o(i.qnorm(e,t,r,l,f))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(43),o=r(2),s=o.arrayrify(Math.exp),{isNaN:u,isFinite:l}=Number,f=n("rlnorm"),c=o.seq()();t.rlnorm=function(e,t=0,r=1,n){return u(t)||!l(r)||r<0?o.map(c(e))(()=>i.ML_ERR_return_NAN(f)):s(a.rnorm(e,t,r,n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(25),i=r(2),{isFinite:a}=Number,o=i.arrayrify((e,t)=>e/t),{lgamma:s}=n.special,u=i.arrayrify((e,t)=>e+t),l=i.arrayrify(Math.log);t.dmultinom=function(e){e.asLog=!!e.asLog;let t=i.flatten(e.x).filter(e=>!!e),r=i.flatten(e.prob),n=!!r.find(e=>!a(e)||e<0),f=i.sum(r);if(n||0===f)throw new Error("probabilities must be finite, non-negative and not all 0");if(r=i.flatten(o(r,f)),t=t.map(Math.round),i.any(t)(e=>e<0))throw new Error("probabilities must be finite, non-negative and not all 0");const c=i.sum(t),_=e.size?e.size:c;if(_!==c)throw new Error(`size:${_} != sum(x):${c}, i.e. one is wrong`);const d=r.map(e=>0===e);if(i.any(d)(e=>!!e)){if(d.find((e,r)=>0!==t[r]))return e.asLog?-1/0:0;t=t.filter((e,t)=>d[t]),r=r.filter((e,t)=>d[t])}const p=[];if(r.length<=1&&p.push("number of propabilities need to be at least 2, it is:"+r.length),t.length<=1&&p.push("number of quantiles need to be at least 2, it is :"+t.length),t.length!==r.length&&p.push(`number of effective quantiles:${t.length} is not equal to number of effective probabilities:${r.length}.`),p.length)throw new Error(p.join("\n"));const m=s(u(t,1)),h=l(r),g=t.map((e,t)=>e*h[t]-m[t]),b=s(_+1)+i.sum(g);return e.asLog?b:Math.exp(b)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),{isFinite:i}=Number,{abs:a}=Math,o=r(36),s=r(2),u=n("rmultinom");t.rmultinom=function(e,t,r,n){const l=Array.from({length:e}).map(()=>function(e,t,r){const n=[];let l=s.flatten(t);const f=l.length;if(0===l.length)return u("list of probabilities cannot be empty"),n;if(e<0)return u("Illegal Argument:size is negative"),n.splice(0),n;if(l.find(e=>!i(e)||e<0))return u("some propbabilities are invalid or negative numbers"),n.splice(0),n;if(n.splice(0,n.length,...new Array(f).fill(0)),0===e)return n;let c=e,_=s.sum(l);u("%o",{p:l,p_tot:_,_size:c,K:f,rN:n});for(let e=0;e<f-1;e++){if(a(_)<Number.EPSILON){n[e]=c,c=0,_=0;continue}const t=l[e]/_;0!==t&&0!==c?(n[e]=t<1?o.rbinom(1,c,t,r):c,c-=n[e],_-=l[e],u("%o",{p_tot:_,_size:c,k:e,rN:n})):n[e]=0}return n[f-1]=c,n}(t,r,n));return s.possibleScalar(l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(9),o=r(71),s=r(6),u=r(3),l=r(2),{max:f,sqrt:c,floor:_,round:d}=Math,{isNaN:p,EPSILON:m,POSITIVE_INFINITY:h,isFinite:g}=Number;function b(e,t,r,n,i){if(t.val>=r)for(;;){if(0===e||(t.val=o.ppois(e-i,n,!0,!1))<r)return e;e=f(0,e-i)}else for(;;)if(e+=i,(t.val=o.ppois(e,n,!0,!1))>=r)return e}t.qpois=function(e,t,r=!0,n=!1){return l.map(e)(e=>function(e,t,r,n){let l,v,M,R,y=new a.NumberW(0);if(p(e)||p(t))return e+t;if(!g(t))return i.ML_ERR_return_NAN(N);if(t<0)return i.ML_ERR_return_NAN(N);if(0===t)return 0;let I=i.R_Q_P01_boundaries(r,n,e,0,h);if(void 0!==I)return I;if(l=t,v=c(t),M=1/v,!r||n){if(0===(e=u.R_DT_qIv(r,n,e)))return 0;if(1===e)return h}if(e+1.01*m>=1)return h;if(y.val=s.qnorm(e,0,1,!0,!1),R=d(l+v*(y.val+M*(y.val*y.val-1)/6)),y.val=o.ppois(R,t,!0,!1),e*=1-64*m,t<1e5)return b(R,y,e,t,1);{let r,n=_(.001*R);do{r=n,R=b(R,y,e,t,n),n=f(1,_(n/100))}while(r>1&&n>1e-15*t);return R}}(e,t,r,n))};const N=n("_qpois")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(20),i=r(7),a=r(14),o=r(10),s=100,u=1073741824;function l(e,t){const r=new Uint32Array(3);return r[0]=e,r[1]=t,r[2]=r[0]-r[1]&u-1,r[2]}function f(e){return e%2==1}class c extends i.IRNG{get KT_pos(){return this.m_seed[100]}set KT_pos(e){this.m_seed[100]=e}ran_array(e,t){let r,n;for(n=0;n<s;n++)e[n]=this.ran_x[n];for(;n<t;n++)e[n]=l(e[n-s],e[n-37]);for(r=0;r<37;r++,n++)this.ran_x[r]=l(e[n-s],e[n-37]);for(;r<s;r++,n++)this.ran_x[r]=l(e[n-s],this.ran_x[r-37])}ran_arr_cycle(){this.ran_array(this.ran_arr_buf,1009),this.ran_arr_buf[s]=-1}ran_start(e){let t,r;const n=new Uint32Array(199),i=new Uint32Array(1),a=new Uint32Array([e]);for(i[0]=a[0]+2&u-2,r=0;r<s;r++)n[r]=i[0],i[0]=i[0]<<1,i[0]>=u&&(i[0]=i[0]-(u-2));for(n[1]++,i[0]=a[0]&u-1,t=69;t;){for(r=99;r>0;r--)n[r+r]=n[r],n[r+r-1]=0;for(r=198;r>=s;r--)n[r-63]=l(n[r-63],n[r]),n[r-s]=l(n[r-s],n[r]);if(f(i[0])){for(r=s;r>0;r--)n[r]=n[r-1];n[0]=n[s],n[37]=l(n[37],n[s])}i[0]?i[0]=i[0]>>>1:t--}for(r=0;r<37;r++)this.ran_x[r+s-37]=n[r];for(;r<s;r++)this.ran_x[r-37]=n[r];for(r=0;r<10;r++)this.ran_array(n,199)}RNG_Init_KT2(e){this.ran_start(e%1073741821),this.KT_pos=100}KT_next(){return this.KT_pos>=100&&(this.ran_arr_cycle(),this.KT_pos=0),this.ran_x[this.KT_pos++]}constructor(e=o.timeseed()){super(e)}_setup(){this._kind=a.IRNGType.KNUTH_TAOCP2002,this._name="Knuth-TAOCP-2002",this.qualityBuffer=new ArrayBuffer(4036),this.ran_arr_buf=new Uint32Array(this.qualityBuffer);const e=new ArrayBuffer(404);this.m_seed=new Uint32Array(e).fill(0),this.ran_x=this.m_seed}internal_unif_rand(){return n.fixup(9.31322574615479e-10*this.KT_next())}init(e=o.timeseed()){const t=new Uint32Array([0]);t[0]=e;for(let e=0;e<50;e++)t[0]=69069*t[0]+1;this.RNG_Init_KT2(t[0]),super.init(e)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(o.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.KnuthTAOCP2002=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(20),i=r(7),a=r(14),o=r(10),s=r(150),u=new ArrayBuffer(4036),l=new Uint32Array(u),f=(e,t)=>e-t&(1<<30)-1;class c extends i.IRNG{get KT_pos(){return this.m_seed[100]}set KT_pos(e){this.m_seed[100]=e}fixupSeeds(){this.KT_pos<=0&&(this.KT_pos=100),void 0===this.m_seed.slice(0,100).find(e=>!!e)&&this.init(o.timeseed())}KT_next(){const e=this.m_seed;return this.KT_pos>=100&&(this.ran_arr_cycle(),this.KT_pos=0),e[this.KT_pos++]}RNG_Init_R_KT(e){this.m_seed.set(s.TAOCP1997init(e%1073741821)),this.KT_pos=100,this.fixupSeeds()}ran_arr_cycle(){return this.ran_array(l,1009),l[100]=-1,l[0]}ran_array(e,t){let r,n;const i=this.m_seed;for(n=0;n<100;n++)e[n]=i[n];for(;n<t;n++)e[n]=f(e[n-100],e[n-37]);for(r=0;r<37;r++,n++)i[r]=f(e[n-100],e[n-37]);for(;r<100;r++,n++)i[r]=f(e[n-100],i[r-37])}constructor(e=o.timeseed()){super(e)}_setup(){this.buf=new ArrayBuffer(404),this._kind=a.IRNGType.KNUTH_TAOCP,this._name="Knuth-TAOCP",this.m_seed=new Int32Array(this.buf).fill(0)}init(e=o.timeseed()){const t=new Uint32Array([0]);t[0]=e;for(let e=0;e<50;e++)t[0]=69069*t[0]+1;this.RNG_Init_R_KT(t[0]),super.init(e)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(o.timeseed()):this.m_seed.set(e)}internal_unif_rand(){return n.fixup(9.31322574615479e-10*this.KT_next())}get seed(){return Array.from(this.m_seed)}}t.KnuthTAOCP=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),{trunc:i}=Math;t.TAOCP1997init=function(e){const t=100,r=1073741824,a=1073741823;let o=e-e%2+2;const s=new Uint32Array(199),u=n.seq(-1)();for(let e of u(1,t))s[e]=o,o+=o,o>=r&&(o=o-r+2);s[1]++,o=e;let l=69;for(;l>0;){for(let e of u(t,2))s[e+e]=s[e];for(let e of u(199,64,-2))s[199-e]=s[e]-s[e]%2;for(let e of u(199,101))s[e]%2==1&&(s[e-63]=s[e-63]-s[e]&a,s[e-t]=s[e-t]-s[e]&a);if(1&o){for(let e of u(t,1))s[e+1]=s[e];s[0]=s[100],s[100]%2==1&&(s[37]=s[37]-s[100]&a)}o?o=i(o/2):l-=1}const f=new Uint32Array(t);return f.set(s.slice(37,t)),f.set(s.slice(0,37),63),f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7),i=r(14),a=r(10),o=4294944443,s=4294967087;class u extends n.IRNG{constructor(e=a.timeseed()){super(e)}_setup(){this._kind=i.IRNGType.LECUYER_CMRG,this._name="L'Ecuyer-CMRG",this.m_seed=new Int32Array(6).fill(0)}init(e=a.timeseed()){const t=new Int32Array([0]);t[0]=e;for(let e=0;e<50;e++)t[0]=69069*t[0]+1;for(let e=0;e<this.m_seed.length;e++){for(t[0]=69069*t[0]+1;t[0]>=o;)t[0]=69069*t[0]+1;this.m_seed[e]=t[0]}super.init(e)}internal_unif_rand(){const e=this.m_seed;let t,r,n;return r=1403580*new Uint32Array([e[1]])[0]-810728*new Uint32Array([e[0]])[0],t=new Int32Array([r/s])[0],r-=t*s,r<0&&(r+=s),e[0]=e[1],e[1]=e[2],e[2]=new Int32Array([r])[0],n=527612*new Uint32Array([e[5]])[0]-1370589*new Uint32Array([e[3]])[0],t=new Int32Array([n/o])[0],n-=t*o,n<0&&(n+=o),e[3]=e[4],e[4]=e[5],e[5]=new Int32Array([n])[0],2.328306549295728e-10*(r>n?r-n:r-n+s)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(a.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.LecuyerCMRG=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(20),i=r(7),a=r(14),o=r(10);class s extends i.IRNG{fixupSeeds(){const e=this.m_seed;0===e[0]&&(e[0]=1),0===e[1]&&(e[1]=1)}constructor(e=o.timeseed()){super(e)}init(e=o.timeseed()){const t=new Int32Array([e]);for(let e=0;e<50;e++)t[0]=69069*t[0]+1;for(let e=0;e<this.m_seed.length;e++)t[0]=69069*t[0]+1,this.m_seed[e]=t[0];this.fixupSeeds(),super.init(e)}_setup(){this._kind=a.IRNGType.MARSAGLIA_MULTICARRY,this._name="Marsaglia-MultiCarry",this.m_seed=new Int32Array(new ArrayBuffer(8)).fill(0)}internal_unif_rand(){const e=this.m_seed;e[0]=36969*(65535&e[0])+(e[0]>>>16),e[1]=18e3*(65535&e[1])+(e[1]>>>16);const t=new Uint32Array(2);return t[0]=e[0]<<16,t[1]=65535&e[1],t[0]=t[0]^t[1],n.fixup(t[0]*n.i2_32m1)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(o.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.MarsagliaMultiCarry=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(15),a=[0,.03917609,.07841241,.1177699,.1573107,.1970991,.2372021,.2776904,.3186394,.3601299,.4022501,.4450965,.4887764,.5334097,.5791322,.626099,.6744898,.7245144,.7764218,.8305109,.8871466,.9467818,1.00999,1.077516,1.150349,1.229859,1.318011,1.417797,1.534121,1.67594,1.862732,2.153875],o=[0,0,0,0,0,.2636843,.2425085,.2255674,.2116342,.1999243,.1899108,.1812252,.1736014,.1668419,.1607967,.1553497,.1504094,.1459026,.14177,.1379632,.1344418,.1311722,.128126,.1252791,.1226109,.1201036,.1177417,.1155119,.1134023,.1114027,.1095039],s=[.0007673828,.00230687,.003860618,.005438454,.007050699,.008708396,.01042357,.01220953,.01408125,.01605579,.0181529,.02039573,.02281177,.02543407,.02830296,.03146822,.03499233,.03895483,.04345878,.04864035,.05468334,.06184222,.07047983,.08113195,.09462444,.1123001,.136498,.1716886,.2276241,.330498,.5847031],u=[.03920617,.03932705,.03950999,.03975703,.04007093,.04045533,.04091481,.04145507,.04208311,.04280748,.04363863,.04458932,.04567523,.04691571,.04833487,.04996298,.05183859,.05401138,.05654656,.0595313,.06308489,.06737503,.07264544,.07926471,.08781922,.09930398,.1155599,.1404344,.1836142,.2790016,.7010474];class l extends i.IRNGNormal{constructor(e=new n.MersenneTwister(0)){super(e)}internal_norm_rand(){let e,t,r,n,i,l=this.rng.unif_rand(),f=0;l>.5&&(f=1),l=l+l-f,l*=32;const c=new Int32Array([l]);if(32===c[0]&&(c[0]=31),0!==c[0]){for(n=l-c[0],t=a[c[0]-1];n<=s[c[0]-1];){for(l=this.rng.unif_rand(),e=l*(a[c[0]]-t),r=(.5*e+t)*e;;){if(n>r)return i=t+e,1===f?-i:i;if(l=this.rng.unif_rand(),n<l)break;r=l,n=this.rng.unif_rand()}n=this.rng.unif_rand()}e=(n-s[c[0]-1])*u[c[0]-1]}else{for(c[0]=6,t=a[31];l+=l,!(l>=1);)t+=o[c[0]-1],c[0]=c[0]+1;l-=1;e:for(;;){for(e=l*o[c[0]-1],r=(.5*e+t)*e;;){if(n=this.rng.unif_rand(),n>r)break e;if(l=this.rng.unif_rand(),n<l)break;r=l}l=this.rng.unif_rand()}}return i=t+e,1===f?-i:i}}t.AhrensDieter=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(15),{log:a,sqrt:o,cos:s,sin:u}=Math;class l extends i.IRNGNormal{reset(){this.BM_norm_keep=0}constructor(e=new n.MersenneTwister(0)){super(e),this.BM_norm_keep=0,e.register("INIT",this.reset.bind(this))}internal_norm_rand(){let e=0,t=0;if(0!==this.BM_norm_keep)return e=this.BM_norm_keep,this.BM_norm_keep=0,e;{t=6.283185307179586*this.rng.unif_rand();let e=o(-2*a(this.rng.unif_rand()))+222507e-312;return this.BM_norm_keep=e*u(t),e*s(t)}}}t.BoxMuller=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(15),{log:a,sqrt:o,min:s,max:u,abs:l,exp:f}=Math;class c extends i.IRNGNormal{constructor(e=new n.MersenneTwister(0)){super(e)}internal_norm_rand(){const e=2.216035867166471,t=t=>.398942280401433*f(-t*t/2)-.180025191068563*(e-t),r=this.rng.unif_rand();let n,i,c;if(r<.884070402298758){let t=this.rng.unif_rand();return e*(1.1311316354418*r+t-1)}if(r>=.973310954173898)for(;;)if(n=this.rng.unif_rand(),i=this.rng.unif_rand(),c=e*e-2*a(i),n*n<e*e/c)return r<.986655477086949?o(c):-o(c);if(r>=.958720824790463)for(;;){if(n=this.rng.unif_rand(),i=this.rng.unif_rand(),c=e-.63083480192196*s(n,i),u(n,i)<=.755591531667601)return n<i?c:-c;if(.034240503750111*l(n-i)<=t(c))return n<i?c:-c}if(r>=.911312780288703)for(;;){if(n=this.rng.unif_rand(),i=this.rng.unif_rand(),c=.479727404222441+1.10547366102207*s(n,i),u(n,i)<=.87283497667179)return n<i?c:-c;if(.049264496373128*l(n-i)<=t(c))return n<i?c:-c}for(;;)if(n=this.rng.unif_rand(),i=this.rng.unif_rand(),c=.479727404222441-.59550713801594*s(n,i),u(n,i)<=.805577924423817)return n<i?c:-c}}t.BuggyKindermanRamage=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5),i=r(15),{exp:a,log:o,sqrt:s,max:u,min:l,abs:f}=Math,c=2.216035867166471;class _ extends i.IRNGNormal{constructor(e=new n.MersenneTwister(0)){super(e)}internal_norm_rand(){let e,t,r,n;const i=e=>.398942280401433*a(-e*e/2)-.180025191068563*(c-e);if(e=this.rng.unif_rand(),e<.884070402298758)return t=this.rng.unif_rand(),c*(1.13113163544418*e+t-1);if(e>=.973310954173898)for(;;)if(t=this.rng.unif_rand(),r=this.rng.unif_rand(),n=c*c-2*o(r),t*t<c*c/n)return e<.986655477086949?s(n):-s(n);if(e>=.958720824790463)for(;;){if(t=this.rng.unif_rand(),r=this.rng.unif_rand(),n=c-.63083480192196*l(t,r),u(t,r)<=.755591531667601)return t<r?n:-n;if(.034240503750111*f(t-r)<=i(n))return t<r?n:-n}if(e>=.911312780288703)for(;;){if(t=this.rng.unif_rand(),r=this.rng.unif_rand(),n=.479727404222441+1.10547366102207*l(t,r),u(t,r)<=.87283497667179)return t<r?n:-n;if(.049264496373128*f(t-r)<=i(n))return t<r?n:-n}for(;;)if(t=this.rng.unif_rand(),r=this.rng.unif_rand(),n=.479727404222441-.59550713801594*l(t,r),!(n<0)){if(u(t,r)<=.805577924423817)return t<r?n:-n;if(.053377549506886*f(t-r)<=i(n))return t<r?n:-n}}}t.KindermanRamage=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(20),i=r(7),a=r(14),o=r(10),s=new ArrayBuffer(8);class u extends i.IRNG{constructor(e=o.timeseed()){super(e)}_setup(){this._kind=a.IRNGType.SUPER_DUPER,this._name="Super-Duper",this.m_seed=new Int32Array(s).fill(0)}internal_unif_rand(){const e=this.m_seed;e[0]^=e[0]>>>15&131071,e[0]^=e[0]<<17,e[1]*=69069;const t=new Uint32Array(2);return t[0]=e[0],t[1]=e[1],t[0]=t[0]^t[1],n.fixup(t[0]*n.i2_32m1)}fixupSeeds(){const e=this.m_seed;0===e[0]&&(e[0]=1),e[1]|=1}init(e=o.timeseed()){const t=new Uint32Array([e]);for(let e=0;e<50;e++)t[0]=69069*t[0]+1;for(let e=0;e<this.m_seed.length;e++)t[0]=69069*t[0]+1,this.m_seed[e]=t[0];this.fixupSeeds(),super.init(e)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(o.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.SuperDuper=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{trunc:n}=Math,i=r(20),a=r(7),o=r(14),s=r(10);class u extends a.IRNG{constructor(e=s.timeseed()){super(e)}_setup(){this._kind=o.IRNGType.WICHMANN_HILL,this._name="Wichmann-Hill";const e=new ArrayBuffer(12);this.m_seed=new Uint32Array(e).fill(0)}internal_unif_rand(){const e=this.m_seed;e[0]=171*e[0]%30269,e[1]=172*e[1]%30307,e[2]=170*e[2]%30323;let t=e[0]/30269+e[1]/30307+e[2]/30323;return i.fixup((r=t)-n(r));var r}fixupSeeds(){const e=this.m_seed;e[0]=e[0]%30269,e[1]=e[1]%30307,e[2]=e[2]%30323,0===e[0]&&(e[0]=1),0===e[1]&&(e[1]=1),0===e[2]&&(e[2]=1)}init(e=s.timeseed()){const t=new Uint32Array([e]);for(let e=0;e<50;e++)t[0]=69069*t[0]+1;for(let e=0;e<this.m_seed.length;e++)t[0]=69069*t[0]+1,this.m_seed[e]=t[0];this.fixupSeeds(),super.init(e)}set seed(e){e.length>this.m_seed.length||0===e.length?this.init(s.timeseed()):this.m_seed.set(e)}get seed(){return Array.from(this.m_seed)}}t.WichmannHill=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);t.csignrank=function(e,t,r,i,a){if(e<0||e>r)return 0;if(e>i&&(e=r-e),1===t)return 1;if(1===a[0])return a[e];a[0]=a[1]=1;for(let e=2;e<t+1;++e){let t;for(t=n.imin2(e*(e+1)/2,i);t>=e;--t)a[t]+=a[t-e]}return a[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(159),{round:o,trunc:s,abs:u,log:l,LN2:f}=Math,{isNaN:c}=Number,_=n("dsignrank");t.dsignrank=function(e,t,r=!1){const n=o(t),d=n*(n+1)/2,p=s(d/2),m=new Array(p+1).fill(0),h=(Array.isArray(e)?e:[e]).map(e=>c(e)||c(t)?e+t:t<=0?i.ML_ERR_return_NAN(_):u(e-o(e))>1e-7||(e=o(e))<0||e>t*(t+1)/2?i.R_D__0(r):i.R_D_exp(r,l(a.csignrank(s(e),t,d,p,m))-t*f));return 1===h.length?h[0]:h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{abs:n}=Math,{isNaN:i}=Number;t.fsign=function(e,t){return i(e)?e:t?n(e):-n(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=r(73),{round:s,trunc:u,LN2:l,exp:f}=Math,{isNaN:c,isFinite:_}=Number,d=n("psignrank");t.psignrank=function(e,t,r=!0,n=!1){const p=s(t),m=p*(p+1)/2,h=u(m/2),g=new Array(h+1).fill(0);return a.map(e)(e=>{e=s(e+1e-7);let a=r;if(c(e)||c(t))return NaN;if(!_(t))return i.ML_ERR_return_NAN(d);if(t<=0)return i.ML_ERR_return_NAN(d);if(e<0)return i.R_DT_0(r,n);if(e>=m)return i.R_DT_1(r,n);let u=f(-p*l),b=0;if(e<=m/2)for(let t=0;t<=e;t++)b+=o.csignrank(t,p,m,h,g)*u;else{e=t*(t+1)/2-e;for(let t=0;t<e;t++)b+=o.csignrank(t,p,m,h,g)*u;a=!a}return i.R_DT_val(a,n,b)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=r(73),{round:u,trunc:l,LN2:f,exp:c}=Math,{isNaN:_,isFinite:d,EPSILON:p}=Number,m=n("qsignrank");t.qsignrank=function(e,t,r=!0,n=!1){const h=u(t),g=h*(h+1)/2,b=l(g/2),N=new Array(b+1).fill(0);return o.map(e)(e=>{if(_(e)||_(t))return NaN;if(!d(t))return i.ML_ERR_return_NAN(m);let o=i.R_Q_P01_check(n,e);if(void 0!==o)return o;if(h<=0)return i.ML_ERR_return_NAN(m);if(e===i.R_DT_0(r,n))return 0;if(e===i.R_DT_1(r,n))return g;!n&&r||(e=a.R_DT_qIv(r,n,e));let u=c(-t*f),v=0,M=0;if(e<=.5)for(e-=10*p;v+=s.csignrank(M,h,g,b,N)*u,!(v>=e);)M++;else for(e=1-e+10*p;;){if(v+=s.csignrank(M,h,g,b,N)*u,v>e){M=l(g-M);break}M++}return M})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{isNaN:o}=Number,{floor:s,round:u}=Math,l=n("rsignrank"),f=a.seq()();t.rsignrank=function(e,t,r){return a.map(f(e))(()=>{if(o(t))return t;const e=u(t);if(e<0)return i.ML_ERR_return_NAN(l);if(0===e)return 0;let n=0,a=s(e);for(let e=0;e<a;)n+=++e*s(r.unif_rand()+.5);return n})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(4),o=r(31),s=r(2),u=r(45),l=r(46),{isNaN:f,isFinite:c,EPSILON:_}=Number,{abs:d,sqrt:p,log:m,exp:h}=Math,g=n("dnt");t.dnt=function(e,t,r=0,n=!1){return s.map(e)(e=>{if(f(e)||f(t))return e+t;if(t<=0)return i.ML_ERR_return_NAN(g);if(0===r)return u.dt(e,t,n);if(!c(e))return i.R_D__0(n);if(!c(t)||t>1e8)return o.dnorm4(e,r,1,n);const s=d(e)>p(t*_)?(g("fabs(x:%d)>sqrt(df*espsilon):%d",d(e),p(t*_)),m(t)-m(d(e))+m(d(l.pnt(e*p((t+2)/t),t+2,r,!0,!1)-l.pnt(e,t,r,!0,!1)))):(g("fabs(x:%d)<=sqrt(df*espsilon):%d",d(e),p(t*_)),a.lgammafn((t+1)/2)-a.lgammafn(t/2)-(i.M_LN_SQRT_PI+.5*(m(t)+r*r)));return g("u=%d, giveLog=%s",s,n),n?s:h(s)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(6),s=r(2),u=r(46),l=r(75),{abs:f,max:c,min:_}=Math,{MAX_VALUE:d,EPSILON:p,isFinite:m,POSITIVE_INFINITY:h,NEGATIVE_INFINITY:g,isNaN:b}=Number,N=n("qnt");t.qnt=function(e,t,r,n,v){return s.map(e)(e=>function(e,t,r,n,s){let v,M,R,y;if(b(e)||b(t)||b(r))return e+t+r;if(t<=0)return i.ML_ERR_return_NAN(N);if(0===r&&t>=1)return l.qt(e,t,n,s);let I=i.R_Q_P01_boundaries(n,s,e,g,h);if(void 0!==I)return I;if(!m(t))return o.qnorm(e,r,1,n,s);if((e=a.R_DT_qIv(n,s,e))>1-p)return h;for(y=_(1-p,e*(1+1e-11)),v=c(1,r);v<d&&u.pnt(v,t,r,!0,!1)<y;v*=2);for(y=e*(1-1e-11),M=_(-1,-r);M>-d&&u.pnt(M,t,r,!0,!1)>y;M*=2);do{R=.5*(M+v),u.pnt(R,t,r,!0,!1)>e?v=R:M=R}while(v-M>1e-13*c(f(M),f(v)));return.5*(M+v)}(e,t,r,n,v))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(13),a=r(0),o=r(2),{sqrt:s}=Math,{isNaN:u,isFinite:l}=Number,f=o.seq()(),c=n("rt");t.rt=function(e,t,r){return o.map(f(e))(()=>u(t)||t<=0?a.ML_ERR_return_NAN(c):l(t)?r.norm_rand()/s(i.rchisq(1,t,r)/t):r.norm_rand())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const{sqrt:n,log:i}=Math,a=r(1),o=r(0),s=r(3),u=r(2),l=r(77),{isNaN:f,POSITIVE_INFINITY:c}=Number,{abs:_,max:d}=Math,p=a("qtukey");t.qtukey=function(e,t,r,a,m=!0,h=!1){return u.map(e)(e=>function(e,t,r,a,u,m){let h,g,b,N,v,M,R=0;if(f(e)||f(t)||f(r)||f(a))return o.ML_ERROR(o.ME.ME_DOMAIN,"qtukey",p),NaN;if(a<2||t<1||r<2)return o.ML_ERR_return_NAN(p);let y=o.R_Q_P01_boundaries(u,m,e,0,c);if(void 0!==y)return y;for(e=s.R_DT_qIv(u,m,e),b=function(e,t,r){let a,o,s,u;return a=.5-.5*e,u=n(i(1/(a*a))),s=u+((((-453642210148e-16*u-.204231210125)*u-.342242088547)*u-1)*u+.322232421088)/((((.0038560700634*u+.10353775285)*u+.531103462366)*u+.588581570495)*u+.099348462606),r<120&&(s+=(s*s*s+s)/r/4),o=.8832-.2368*s,r<120&&(o+=-1.214/r+1.208*s/r),s*(o*i(t-1)+1.4142)}(e,r,a),h=l._ptukey(b,t,r,a,!0,!1)-e,N=h>0?d(0,b-1):b+1,g=l._ptukey(N,t,r,a,!0,!1)-e,M=1;M<50;M++)if(R=N-g*(N-b)/(g-h),h=g,b=N,R<0&&(R=0,g=-e),g=l._ptukey(R,t,r,a,!0,!1)-e,N=R,v=_(N-b),v<1e-4)return R;return o.ML_ERROR(o.ME.ME_NOCONV,"qtukey",p),R}(e,t,r,a,m,h))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(19),{exp:a,pow:o}=Math,s=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],u=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277];t.wprob=function(e,t,r){let l,f,c,_,d,p,m,h,g,b,N,v,M,R,y,I,E,w,P,x;if(N=.5*e,N>=8)return 1;for(c=2*i.pnorm5(N,0,1,!0,!1)-1,c=c>=a(-50/r)?o(c,r):0,R=e>3?2:3,I=N,d=(8-N)/R,E=I+d,w=0,m=r-1,M=1;M<=R;M++){P=0,l=.5*(E+I),_=.5*(E-I);for(let t=1;t<=12&&(6<t?(x=12-t+1,y=s[x-1]):(x=t,y=-s[x-1]),p=_*y,f=l+p,b=f*f,!(b>60));t++)g=2*i.pnorm5(f,0,1,!0,!1),h=2*i.pnorm5(f,e,1,!0,!1),v=.5*g-.5*h,v>=a(-30/m)&&(v=u[x-1]*a(-.5*b)*o(v,m),P+=v);P*=2*_*r*n.M_1_SQRT_2PI,w+=P,I=E,E+=d}return c+=w,c<=a(-30/t)?0:(c=o(c,t),c>=1?1:c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(2),{isNaN:a}=Number,{log:o}=Math;t.dunif=function(e,t=0,r=1,s=!1){return i.map(e)(e=>a(e)||a(t)||a(r)?e+t+r:t<=e&&e<=r?s?-o(r-t):1/(r-t):n.R_D__0(s))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1)("punif"),i=r(0),a=r(2),{isNaN:o,isFinite:s}=Number;t.punif=function(e,t=0,r=1,u=!0,l=!1){return a.map(e)(e=>o(e)||o(t)||o(r)?e+t+r:r<t?i.ML_ERR_return_NAN(n):s(t)&&s(r)?e>=r?i.R_DT_1(u,l):e<=t?i.R_DT_0(u,l):u?i.R_D_val(l,(e-t)/(r-t)):i.R_D_val(l,(r-e)/(r-t)):i.ML_ERR_return_NAN(n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),i=r(1),a=r(3),o=r(2),{isNaN:s,isFinite:u}=Number,l=i("qunif");t.qunif=function(e,t=0,r=1,i=!0,f=!1){return o.map(e)(e=>{if(s(e)||s(t)||s(r))return NaN;let o=n.R_Q_P01_check(f,e);return void 0!==o?o:u(t)&&u(r)?r<t?n.ML_ERR_return_NAN(l):r===t?t:t+a.R_DT_qIv(i,f,e)*(r-t):n.ML_ERR_return_NAN(l)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),{isFinite:a}=Number,o=n("runif");t.runif=function(e=1,t=0,r=1,n){if(!(a(t)&&a(r)&&r>t))return i.ML_ERR_return_NAN(o);let s=new Array(e).fill(0).map(()=>{const e=n.unif_rand();return(r-t)*e+t});return 1===s.length?s[0]:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{pow:o,log:s,exp:u}=Math,{isNaN:l,isFinite:f,POSITIVE_INFINITY:c}=Number,_=n("dweilbull");t.dweibull=function(e,t,r=1,n=!1){return a.map(e)(e=>{if(l(e)||l(t)||l(r))return e+t+r;if(t<=0||r<=0)return i.ML_ERR_return_NAN(_);if(e<0)return i.R_D__0(n);if(!f(e))return i.R_D__0(n);if(0===e&&t<1)return c;let a=o(e/r,t-1),d=a*(e/r);return n?-d+s(t*a/r):t*a*u(-d)/r})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),{expm1:s,pow:u}=Math,{isNaN:l}=Number,f=n("pweibull");t.pweibull=function(e,t,r=1,n=!0,c=!1){return o.map(e)(e=>l(e)||l(t)||l(r)?e+t+r:t<=0||r<=0?i.ML_ERR_return_NAN(f):e<=0?i.R_DT_0(n,c):(e=-u(e/r,t),n?c?a.R_Log1_Exp(e):-s(e):i.R_D_exp(c,e)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),{pow:s}=Math,{isNaN:u,POSITIVE_INFINITY:l}=Number,f=n("qweibull");t.qweibull=function(e,t,r=1,n=!0,c=!1){return o.map(e)(e=>{if(u(e)||u(t)||u(r))return e+t+r;if(t<=0||r<=0)return i.ML_ERR_return_NAN(f);let o=i.R_Q_P01_boundaries(n,c,e,0,l);return void 0!==o?o:r*s(-a.R_DT_Clog(n,c,e),1/t)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),{log:o,pow:s}=Math,{isFinite:u}=Number,l=n("rweibull");t.rweibull=function(e,t,r=1,n){const f=new Array(e).fill(0).map(()=>!u(t)||!u(r)||t<=0||r<=0?0===r?0:i.ML_ERR_return_NAN(l):r*s(-o(n.unif_rand()),1/t));return a.possibleScalar(f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(27),o=r(2),s=r(49),u=r(48),{round:l,abs:f,log:c}=Math,{isNaN:_}=Number,d=n("dwilcox");t.dwilcox=function(e,t,r,n=!1){return t=l(t),r=l(r),o.map(e)(e=>{const o=new u.WilcoxonCache;return _(e)||_(t)||_(r)?e+t+r:t<=0||r<=0?i.ML_ERR_return_NAN(d):f(e-l(e))>1e-7||(e=l(e))<0||e>t*r?i.R_D__0(n):n?c(s.cwilcox(e,t,r,o))-a.internal_lchoose(t+r,r):s.cwilcox(e,t,r,o)/a.internal_choose(t+r,r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(27),o=r(2),s=r(48),u=r(49),{round:l,floor:f}=Math,{isNaN:c,isFinite:_}=Number,d=n("pwilcox");t.pwilcox=function(e,t,r,n=!0,p=!1){return t=l(t),r=l(r),o.map(e)(e=>{const o=new s.WilcoxonCache;let l=n;if(c(e)||c(t)||c(r))return e+t+r;if(!_(t)||!_(r))return i.ML_ERR_return_NAN(d);if(t<=0||r<=0)return i.ML_ERR_return_NAN(d);if((e=f(e+1e-7))<0)return i.R_DT_0(l,p);if(e>=t*r)return i.R_DT_1(l,p);let m=a.internal_choose(t+r,r),h=0;if(e<=t*r/2)for(let n=0;n<=e;n++)h+=u.cwilcox(n,t,r,o)/m;else{e=t*r-e;for(let n=0;n<e;n++)h+=u.cwilcox(n,t,r,o)/m;l=!l}return i.R_DT_val(l,p,h)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(3),o=r(2),s=r(49),u=r(48),l=r(27),{round:f,trunc:c}=Math,{isNaN:_,isFinite:d,EPSILON:p}=Number,m=n("qwilcox");t.qwilcox=function(e,t,r,n=!0,h=!1){t=f(t),r=f(r);const g=new u.WilcoxonCache;return o.map(e)(e=>{if(_(e)||_(t)||_(r))return e+t+r;if(!d(e)||!d(t)||!d(r))return i.ML_ERR_return_NAN(m);if(i.R_Q_P01_check(h,e),t<=0||r<=0)return i.ML_ERR_return_NAN(m);if(e===i.R_DT_0(n,h))return 0;if(e===i.R_DT_1(n,h))return t*r;!h&&n||(e=a.R_DT_qIv(n,h,e));let o=l.internal_choose(t+r,r),u=0,f=0;if(e<=.5)for(e-=10*p;u+=s.cwilcox(f,t,r,g)/o,!(u>=e);)f++;else for(e=1-e+10*p;;){if(u+=s.cwilcox(f,t,r,g)/o,u>e){f=c(t*r-f);break}f++}return f})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(0),a=r(2),o=n("rwilcox"),{round:s,trunc:u,floor:l}=Math,{isNaN:f}=Number;t.rwilcox=function(e,t,r,n){const c=new Array(e).fill(0).map(()=>{if(f(t)||f(r))return t+r;if(t=s(t),r=s(r),t<0||r<0)return i.ML_ERR_return_NAN(o);if(0===t||0===r)return 0;let e=0,c=u(t+r),_=a.seq()()(0,c-1);o("------v");for(let t=0;t<r;t++){let i=l(c*n.unif_rand());e+=_[i],_[i]=_[--c],o("i:%d,\tn:%d\tj:%d\tk:%d\tr:%d\tx:%o",t,r,i,c,_)}return e-r*(r-1)/2});return a.possibleScalar(c)}},function(e,r,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},r.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)}},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){var e;try{e=r.storage.getItem("debug")}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e},r.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(e){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(78)(r),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,r,n){"use strict";var i=n(186),a=n(187);r.init=function(e){e.inspectOpts={};for(var t=Object.keys(r.inspectOpts),n=0;n<t.length;n++)e.inspectOpts[t[n]]=r.inspectOpts[t[n]]},r.log=function(){return t.stderr.write(a.format.apply(a,arguments)+"\n")},r.formatArgs=function(t){var n=this.namespace;if(this.useColors){var i=this.color,a="[3"+(i<8?i:"8;5;"+i),o="  ".concat(a,";1m").concat(n," [0m");t[0]=o+t[0].split("\n").join("\n"+o),t.push(a+"m+"+e.exports.humanize(this.diff)+"[0m")}else t[0]=(r.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+t[0]},r.save=function(e){e?t.env.DEBUG=e:delete t.env.DEBUG},r.load=function(){return t.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?Boolean(r.inspectOpts.colors):i.isatty(t.stderr.fd)},r.colors=[6,2,3,4,5,1];try{var o=n(185);o&&(o.stderr||o).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}r.inspectOpts=Object.keys(t.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,r){var n=r.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),i=t.env[r];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[n]=i,e}),{}),e.exports=n(78)(r);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,a.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,a.inspect(e,this.inspectOpts)}},function(e,t){var r=1e3,n=6e4,i=60*n,a=24*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var s,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===l&&!1===isNaN(e))return t.long?(s=e,(u=Math.abs(s))>=a?o(s,u,a,"day"):u>=i?o(s,u,i,"hour"):u>=n?o(s,u,n,"minute"):u>=r?o(s,u,r,"second"):s+" ms"):function(e){var t=Math.abs(e);return t>=a?Math.round(e/a)+"d":t>=i?Math.round(e/i)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){e.exports=r(4)},function(e,t){e.exports=r(2)},function(e,t){e.exports=r(3)}])},e.exports=n(r(2),r(3),function(){try{return r(4)}catch(e){}}())}).call(this,r(1))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){let n={},a=r(0),{rpois:o}=r(28);n.skeleton=function(e,t,r,n,o,s){let u={};n=.1;let l=[e.S],f=[e.M],c=[e.R],_=[],d=[],p=[],m=[],h=[],g=[];for(let t=0;t<s.nstageE;t++)_.push(e["E"+(t+1)]);for(let t=0;t<s.nstageP;t++)d.push(e["P"+(t+1)]);for(let t=0;t<s.nstageI;t++)p.push(e["I"+(t+1)]);for(let t=0;t<s.nstageH;t++)m.push(e["H"+(t+1)]);for(let t=0;t<s.nstageC;t++)h.push(e["C"+(t+1)]);for(let t=0;t<s.nstageV;t++)g.push(e["V"+(t+1)]);let b=[],N=[],v=[];for(let t=0;t<s.nstageE;t++)b.push(e["EQ"+(t+1)]);for(let t=0;t<s.nstageP;t++)N.push(e["PQ"+(t+1)]);for(let t=0;t<s.nstageI;t++)v.push(e["IQ"+(t+1)]);let M,R=new Array(1),y=new Array(s.nstageE),I=new Array(s.nstageP),E=new Array(s.nstageI),w=new Array(s.nstageH),P=new Array(s.nstageC),x=new Array(s.nstageV),A=new Array(1),O=new Array(1),T=new Array(s.nstageE),L=new Array(s.nstageP),S=new Array(s.nstageI),q=0;for(let e=0;e<s.nstageP;e++)q+=d[e];let D,C,j,F,k,V,B=0;for(i=0;i<s.nstageI;i++)B+=p[i];if(D=isFinite(o.tests)?t.rho*(o.tests/(o.tests+t.TF)):t.rho*(15/(15+t.TF)),C=t.betaI*B,j=t.betaI*t.theta*q*(1-D),F=t.betaI*t.theta*q*D,r<s.T0)M=a.rgammawn(t.beta_sd,n)/n,k=(C+j+t.iota)/s.pop*M,V=F/s.pop*M;else if(r<s.T0+7){let e=(r-s.T0)/7,i=3*e*e-2*e*e*e;M=a.rgammawn((1-i+i*t.dB0)*t.beta_sd,n)/n,k=((1-i+i*t.dI0)*C+(1-i+i*t.dP0)*j+(1-i+i*t.dT0)*t.iota)/s.pop*M,V=(1-i+i*t.dP0)*F/s.pop*M}else if(r<s.T1)M=a.rgammawn(t.dB0*t.beta_sd,n)/n,k=(t.dI0*C+t.dP0*j+t.dT0*t.iota)/s.pop*M,V=t.dP0*F/s.pop*M;else if(r<s.T1+7){let e=(r-s.T1)/7,i=3*e*e-2*e*e*e;M=a.rgammawn(((1-i)*t.dB0+i*t.dB1)*t.beta_sd,n)/n,k=(((1-i)*t.dI0+i*t.dI1)*C+((1-i)*t.dP0+i*t.dP1)*j+((1-i)*t.dT0+i*t.dT1)*t.iota)/s.pop*M,V=((1-i)*t.dP0+i*t.dP1)*F/s.pop*M}else M=a.rgammawn(t.dB1*t.beta_sd,n)/n,k=(t.dI1*C+t.dP1*j+t.dT1*t.iota)/s.pop*M,V=t.dP1*F/s.pop*M;let Q=new Array(2),G=new Array(2);G[0]=k,G[1]=V;let U=G[0]+G[1],H=(1-Math.exp(-U*n))*l[0];Q[0]=G[0]/U*H,Q[1]=G[1]/U*H;let Y=new Array(s.nstageE),W=s.nstageE*t.sigma;for(let e=0;e<s.nstageE;e++)Y[e]=(1-Math.exp(-W*n))*b[e];let z,K=new Array(s.nstageP+1),X=s.nstageP*t.kappa;for(let e=0;e<s.nstageP-1;e++)K[e]=(1-Math.exp(-X*n))*N[e];z=(1-Math.exp(-X*n))*N[s.nstageP-1],K[s.nstageP-1]=(1-t.qP)*z,K[s.nstageP]=t.qP*z;let J,$=new Array(s.nstageI+1),Z=s.nstageI*t.gammaI;for(let e=0;e<s.nstageI-1;e++)$[e]=(1-Math.exp(-Z*n))*v[e];J=(1-Math.exp(-Z*n))*v[s.nstageI-1],$[s.nstageI-1]=(1-t.mI)*J,$[s.nstageI]=t.mI*J;let ee=new Array(s.nstageE),te=s.nstageE*t.sigma;for(let e=0;e<s.nstageE;e++)ee[e]=(1-Math.exp(-te*n))*_[e];let re,ne=new Array(s.nstageP+2),ie=s.nstageP*t.kappa;for(let e=0;e<s.nstageP-1;e++)ne[e]=(1-Math.exp(-ie*n))*d[e];re=(1-Math.exp(-ie*n))*d[s.nstageP-1],ne[s.nstageP-1]=(1-D)*(1-t.qP)*re,ne[s.nstageP]=t.qP*re,ne[s.nstageP+1]=D*(1-t.qP)*re;let ae,oe=new Array(s.nstageI+1),se=s.nstageI*t.gammaI;for(let e=0;e<s.nstageI-1;e++)oe[e]=(1-Math.exp(-se*n))*p[e];ae=(1-Math.exp(-se*n))*p[s.nstageI-1],oe[s.nstageI-1]=(1-t.mI)*ae,oe[s.nstageI]=t.mI*ae;let ue,le=new Array(s.nstageH+1),fe=s.nstageH*t.gammaH;for(let e=0;e<s.nstageH-1;e++)le[e]=(1-Math.exp(-fe*n))*m[e];ue=(1-Math.exp(-fe*n))*m[s.nstageH-1],le[s.nstageH-1]=(1-t.qH)*ue,le[s.nstageH]=t.qH*ue;let ce,_e=new Array(s.nstageC+2),de=s.nstageC*t.gammaC;for(let e=0;e<s.nstageC-1;e++)_e[e]=(1-Math.exp(-de*n))*h[e];ce=(1-Math.exp(-de*n))*h[s.nstageC-1],_e[s.nstageC-1]=(1-t.mC)*(1-t.qC)*ce,_e[s.nstageC]=t.qC*ce,_e[s.nstageC+1]=t.mC*(1-t.qC)*ce;let pe,me=new Array(s.nstageV+1),he=s.nstageV*t.gammaV;for(let e=0;e<s.nstageV-1;e++)me[e]=(1-Math.exp(-he*n))*g[e];for(pe=(1-Math.exp(-he*n))*g[s.nstageV-1],me[s.nstageV-1]=(1-t.mV)*pe,me[s.nstageV]=t.mV*pe,R[0]=l[0],i=0;i<s.nstageE;i++)y[i]=_[i];for(i=0;i<s.nstageP;i++)I[i]=d[i];for(i=0;i<s.nstageI;i++)E[i]=p[i];for(i=0;i<s.nstageH;i++)w[i]=m[i];for(i=0;i<s.nstageC;i++)P[i]=h[i];for(i=0;i<s.nstageV;i++)x[i]=g[i];for(A[0]=f[0],O[0]=c[0],u.casesI=e.casesI,u.casesIQ=e.casesIQ,u.casesH=e.casesH,u.deathsIIQ=e.deathsIIQ,u.deathsCV=e.deathsCV,i=0;i<s.nstageE;i++)T[i]=b[i];for(i=0;i<s.nstageP;i++)L[i]=N[i];for(i=0;i<s.nstageI;i++)S[i]=v[i];for(R[0]-=Q[0],y[0]+=Q[0],i=0;i<s.nstageE;i++)y[i]-=ee[i];for(i=1;i<s.nstageE;i++)y[i]+=ee[i-1];for(I[0]+=ee[s.nstageE-1],i=0;i<s.nstageP;i++)I[i]-=ne[i];for(i=1;i<s.nstageP;i++)I[i]+=ne[i-1];for(E[0]+=ne[s.nstageP-1],w[0]+=ne[s.nstageP],I[s.nstageP-1]-=ne[s.nstageP],i=0;i<s.nstageI;i++)E[i]-=oe[i];for(i=1;i<s.nstageI;i++)E[i]+=oe[i-1];for(i=0;i<s.nstageH;i++)w[i]-=le[i];for(i=1;i<s.nstageH;i++)w[i]+=le[i-1];for(P[0]+=le[s.nstageH],w[s.nstageH-1]-=le[s.nstageH],E[s.nstageI-1]-=oe[s.nstageI],i=0;i<s.nstageC;i++)P[i]-=_e[i];for(i=1;i<s.nstageC;i++)P[i]+=_e[i-1];for(x[0]+=_e[s.nstageC],P[s.nstageC-1]-=_e[s.nstageC]+_e[s.nstageC+1],i=0;i<s.nstageV;i++)x[i]-=me[i];for(i=1;i<s.nstageV;i++)x[i]+=me[i-1];for(x[s.nstageV-1]-=me[s.nstageV],O[0]+=oe[s.nstageI-1]+le[s.nstageH-1]+_e[s.nstageC-1]+me[s.nstageV-1],A[0]+=oe[s.nstageI]+_e[s.nstageC+1]+me[s.nstageV],R[0]-=Q[1],T[0]+=Q[1],i=0;i<s.nstageE;i++)T[i]-=Y[i];for(i=1;i<s.nstageE;i++)T[i]+=Y[i-1];for(L[0]+=Y[s.nstageE-1],i=0;i<s.nstageP;i++)L[i]-=K[i];for(i=1;i<s.nstageP;i++)L[i]+=K[i-1];for(L[s.nstageP-1]-=K[s.nstageP],I[s.nstageP-1]-=ne[s.nstageP+1],S[0]+=K[s.nstageP-1]+ne[s.nstageP+1],w[0]+=K[s.nstageP],i=0;i<s.nstageI;i++)S[i]-=$[i];for(i=1;i<s.nstageI;i++)S[i]+=$[i-1];return S[s.nstageI-1]-=$[s.nstageI],O[0]+=$[s.nstageI-1],A[0]+=$[s.nstageI],u.casesI+=ne[s.nstageP-1],u.casesIQ+=K[s.nstageP-1]+ne[s.nstageP+1],u.casesH+=K[s.nstageP]+ne[s.nstageP],u.deathsIIQ+=oe[s.nstageI]+$[s.nstageI],u.deathsCV+=_e[s.nstageC+1]+me[s.nstageV],u.S=R[0],u.E1=y[0],u.E2=y[1],u.E3=y[2],u.P1=I[0],u.P2=I[1],u.P3=I[2],u.I1=E[0],u.I2=E[1],u.I3=E[2],u.H1=w[0],u.H2=w[1],u.H3=w[2],u.C1=P[0],u.C2=P[1],u.C3=P[2],u.V1=x[0],u.V2=x[1],u.V3=x[2],u.M=A[0],u.R=O[0],u.EQ1=T[0],u.EQ2=T[1],u.EQ3=T[2],u.PQ1=L[0],u.PQ2=L[1],u.PQ3=L[2],u.IQ1=S[0],u.IQ2=S[1],u.IQ3=S[2],u},n.rprocess=function(e,t,r,n,o,s){let u=[],l=[],f=[],c=[],_=[],d=[],p=[],m=[],h=[],g=[],b=[],N=[];u=[e.S],l=[e.E1,e.E2,e.E3],f=[e.P1,e.P2,e.P3],c=[e.I1,e.I2,e.I3],_=[e.H1,e.H2,e.H3],d=[e.C1,e.C2,e.C3],p=[e.V1,e.V2,e.V3],m=[e.M],h=[e.R],g=[e.EQ1,e.EQ2,e.EQ3],b=[e.PQ1,e.PQ2,e.PQ3],N=[e.IQ1,e.IQ2,e.IQ3];let v,M,R,y,I,E,w,P=0,x=0;!function(){for(let e=0;e<s.nstageP;e++)P+=f[e];for(let e=0;e<s.nstageI;e++)x+=c[e];if(v=isNaN(Number(o.tests))?t.rho*(15/(15+t.TF)):t.rho*(o.tests/(o.tests+t.TF)),M=t.betaI*x,R=t.betaI*t.theta*P*(1-v),y=t.betaI*t.theta*P*v,r<s.T0)I=a.rgammawn(t.beta_sd,n)/n,E=(M+R+t.iota)/s.pop*I,w=y/s.pop*I;else if(r<s.T0+7){let e=(r-s.T0)/7,i=3*e*e-2*e*e*e;I=a.rgammawn((1-i+i*t.dB0)*t.beta_sd,n)/n,E=((1-i+i*t.dI0)*M+(1-i+i*t.dP0)*R+(1-i+i*t.dT0)*t.iota)/s.pop*I,w=(1-i+i*t.dP0)*y/s.pop*I}else if(r<s.T1)I=a.rgammawn(t.dB0*t.beta_sd,n)/n,E=(t.dI0*M+t.dP0*R+t.dT0*t.iota)/s.pop*I,w=t.dP0*y/s.pop*I;else if(r<s.T1+7){let e=(r-s.T1)/7,i=3*e*e-2*e*e*e;I=a.rgammawn(((1-i)*t.dB0+i*t.dB1)*t.beta_sd,n)/n,E=(((1-i)*t.dI0+i*t.dI1)*M+((1-i)*t.dP0+i*t.dP1)*R+((1-i)*t.dT0+i*t.dT1)*t.iota)/s.pop*I,w=((1-i)*t.dP0+i*t.dP1)*y/s.pop*I}else I=a.rgammawn(t.dB1*t.beta_sd,n)/n,E=(t.dI1*M+t.dP1*R+t.dT1*t.iota)/s.pop*I,w=t.dP1*y/s.pop*I}();let A=new Array(2),O=new Array(2);O[0]=E,O[1]=w,a.reulermultinom(2,Math.round(u[0]),0,n,0,O,A);let T=new Array(s.nstageE),L=[s.nstageE*t.sigma];for(let e=0;e<s.nstageE;e++)a.reulermultinom(1,Math.round(g[e]),0,n,e,L,T);let S=new Array(s.nstageP+1),q=[s.nstageP*t.kappa];for(i=0;i<s.nstageP-1;i++)a.reulermultinom(1,Math.round(b[i]),0,n,i,q,S);let D=new Array(2);D[0]=(1-t.qP)*s.nstageP*t.kappa,D[1]=t.qP*s.nstageP*t.kappa,a.reulermultinom(2,Math.round(b[s.nstageP-1]),0,n,s.nstageP-1,D,S);let C=new Array(s.nstageI+1),j=[s.nstageI*t.gammaI];for(let e=0;e<s.nstageI-1;e++)a.reulermultinom(1,Math.round(N[e]),0,n,e,j,C);let F=new Array(2);F[0]=(1-t.mI)*s.nstageI*t.gammaI,F[1]=t.mI*s.nstageI*t.gammaI,a.reulermultinom(2,Math.round(N[s.nstageI-1]),0,n,s.nstageI-1,F,C);let k=new Array(s.nstageE),V=[s.nstageE*t.sigma];for(let e=0;e<s.nstageE;e++)a.reulermultinom(1,Math.round(l[e]),0,n,e,V,k);let B=new Array(s.nstageP+2),Q=[s.nstageP*t.kappa];for(i=0;i<s.nstageP-1;i++)a.reulermultinom(1,Math.round(f[i]),0,n,i,Q,B);let G=new Array(3);G[0]=(1-v)*(1-t.qP)*s.nstageP*t.kappa,G[1]=t.qP*s.nstageP*t.kappa,G[2]=v*(1-t.qP)*s.nstageP*t.kappa,a.reulermultinom(3,Math.round(f[s.nstageP-1]),0,n,s.nstageP-1,G,B);let U=new Array(s.nstageI+1),H=[s.nstageI*t.gammaI];for(let e=0;e<s.nstageI-1;e++)a.reulermultinom(1,Math.round(c[e]),0,n,e,H,U);let Y=new Array(2);Y[0]=(1-t.mI)*s.nstageI*t.gammaI,Y[1]=t.mI*s.nstageI*t.gammaI,a.reulermultinom(2,Math.round(c[s.nstageI-1]),0,n,s.nstageI-1,Y,U);let W=new Array(s.nstageH+1),z=[s.nstageH*t.gammaH];for(let e=0;e<s.nstageH-1;e++)a.reulermultinom(1,Math.round(_[e]),0,n,e,z,W);let K=new Array(2);K[0]=(1-t.qH)*s.nstageH*t.gammaH,K[1]=t.qH*s.nstageH*t.gammaH,a.reulermultinom(2,Math.round(_[s.nstageH-1]),0,n,s.nstageH-1,K,W);let X=new Array(s.nstageC+2),J=[s.nstageC*t.gammaC];for(let e=0;e<s.nstageC-1;e++)a.reulermultinom(1,Math.round(d[e]),0,n,e,J,X);let $=new Array(3);$[0]=(1-t.mC)*s.nstageC*t.gammaC,$[1]=t.qC*s.nstageC*t.gammaC,$[2]=t.mC*(1-t.qC)*s.nstageC*t.gammaC,a.reulermultinom(3,Math.round(d[s.nstageC-1]),0,n,s.nstageC-1,$,X);let Z=new Array(s.nstageV+1),ee=[s.nstageV*t.gammaV];for(i=0;i<s.nstageV-1;i++)a.reulermultinom(1,Math.round(p[i]),0,n,i,ee,Z);let te=new Array(2);te[0]=(1-t.mV)*s.nstageV*t.gammaV,te[1]=t.mV*s.nstageV*t.gammaV,a.reulermultinom(2,Math.round(p[s.nstageV-1]),0,n,s.nstageV-1,te,Z),u[0]-=A[0],l[0]+=A[0];for(let e=0;e<s.nstageE;e++)l[e]-=k[e];for(let e=1;e<s.nstageE;e++)l[e]+=k[e-1];f[0]+=k[s.nstageE-1];for(let e=0;e<s.nstageP;e++)f[e]-=B[e];for(let e=1;e<s.nstageP;e++)f[e]+=B[e-1];c[0]+=B[s.nstageP-1],_[0]+=B[s.nstageP],f[s.nstageP-1]-=B[s.nstageP];for(let e=0;e<s.nstageI;e++)c[e]-=U[e];for(let e=1;e<s.nstageI;e++)c[e]+=U[e-1];for(let e=0;e<s.nstageH;e++)_[e]-=W[e];for(let e=1;e<s.nstageH;e++)_[e]+=W[e-1];d[0]+=W[s.nstageH],_[s.nstageH-1]-=W[s.nstageH],c[s.nstageI-1]-=U[s.nstageI];for(let e=0;e<s.nstageC;e++)d[e]-=X[e];for(let e=1;e<s.nstageC;e++)d[e]+=X[e-1];p[0]+=X[s.nstageC],d[s.nstageC-1]-=X[s.nstageC]+X[s.nstageC+1];for(let e=0;e<s.nstageV;e++)p[e]-=Z[e];for(let e=1;e<s.nstageV;e++)p[e]+=Z[e-1];p[s.nstageV-1]-=Z[s.nstageV],h[0]+=U[s.nstageI-1]+W[s.nstageH-1]+X[s.nstageC-1]+Z[s.nstageV-1],m[0]+=U[s.nstageI]+X[s.nstageC+1]+Z[s.nstageV],u[0]-=A[1],g[0]+=A[1];for(let e=0;e<s.nstageE;e++)g[e]-=T[e];for(let e=1;e<s.nstageE;e++)g[e]+=T[e-1];b[0]+=T[s.nstageE-1];for(let e=0;e<s.nstageP;e++)b[e]-=S[e];for(let e=1;e<s.nstageP;e++)b[e]+=S[e-1];b[s.nstageP-1]-=S[s.nstageP],f[s.nstageP-1]-=B[s.nstageP+1],N[0]+=S[s.nstageP-1]+B[s.nstageP+1],_[0]+=S[s.nstageP];for(let e=0;e<s.nstageI;e++)N[e]-=C[e];for(let e=1;e<s.nstageI;e++)N[e]+=C[e-1];N[s.nstageI-1]-=C[s.nstageI],h[0]+=C[s.nstageI-1],m[0]+=C[s.nstageI];return e.casesI+=B[s.nstageP-1],e.casesIQ+=S[s.nstageP-1]+B[s.nstageP+1],e.casesH+=B[s.nstageP]+S[s.nstageP],e.deathsIIQ+=U[s.nstageI]+C[s.nstageI],e.deathsCV+=X[s.nstageC+1]+Z[s.nstageV],[e.S]=u,[e.E1,e.E2,e.E3]=l,[e.P1,e.P2,e.P3]=f,[e.I1,e.I2,e.I3]=c,[e.H1,e.H2,e.H3]=_,[e.C1,e.C2,e.C3]=d,[e.V1,e.V2,e.V3]=p,[e.M]=m,[e.R]=h,[e.EQ1,e.EQ2,e.EQ3]=g,[e.PQ1,e.PQ2,e.PQ3]=b,[e.IQ1,e.IQ2,e.IQ3]=N,e},n.initializer=function(e,t,r){let n={},i=e.S0,a=e.EQ0/r.nstageE,o=e.PQ0/r.nstageP,s=e.IQ0/r.nstageI,u=e.E0/r.nstageE,l=e.P0/r.nstageP,f=e.I0/r.nstageI,c=e.H0/r.nstageH,_=e.C0/r.nstageC,d=e.V0/r.nstageV,p=e.M0,m=1-i-r.nstageE*u-r.nstageP*l-r.nstageI*f-r.nstageH*c-r.nstageC*_-r.nstageV*d-r.nstageE*a-r.nstageP*o-r.nstageI*s-p;n.S=Math.round(r.pop*i);for(let e=0;e<r.nstageE;e++)n["EQ"+(e+1)]=Math.round(r.pop*a);for(let e=0;e<r.nstageP;e++)n["PQ"+(e+1)]=Math.round(r.pop*o);for(let e=0;e<r.nstageI;e++)n["IQ"+(e+1)]=Math.round(r.pop*s);for(let e=0;e<r.nstageE;e++)n["E"+(e+1)]=Math.round(r.pop*u);for(let e=0;e<r.nstageP;e++)n["P"+(e+1)]=Math.round(r.pop*l);for(let e=0;e<r.nstageI;e++)n["I"+(e+1)]=Math.round(r.pop*f);for(let e=0;e<r.nstageH;e++)n["H"+(e+1)]=Math.round(r.pop*c);for(let e=0;e<r.nstageC;e++)n["C"+(e+1)]=Math.round(r.pop*_);for(let e=0;e<r.nstageV;e++)n["V"+(e+1)]=Math.round(r.pop*d);return n.M=Math.round(r.pop*p),n.R=Math.round(r.pop*m),n.casesI=0,n.casesIQ=0,n.casesH=0,n.deathsIIQ=0,n.deathsCV=0,n},n.dmeasure=function(e,t,r,n=1,i){let o,s,u,l,f,c=[],_=[],d=[];for(let e=0;e<i.nstageH;e++)c.push(t["H"+(e+1)]);for(let e=0;e<i.nstageC;e++)_.push(t["C"+(e+1)]);for(let e=0;e<i.nstageV;e++)d.push(t["V"+(e+1)]);if(isFinite(e.reports)){let r=t.casesH+t.casesIQ;o=a.dpois(e.reports,r+1e-6,1)}else o=0;if(isFinite(e.deaths)){let r=t.deathsCV+t.deathsIIQ;s=a.dpois(e.deaths,r+1e-6,1)}else s=0;let p=0;for(let e=0;e<i.nstageH;e++)p+=c[e];let m=0;for(let e=0;e<i.nstageC;e++)m+=_[e];let h=0;for(let e=0;e<i.nstageV;e++)h+=d[e];u=isFinite(e.hospital)&isFinite(e.ICU)?a.dpois(e.hospital-e.ICU,p+1e-6,1):0,l=isFinite(e.ICU)&isFinite(e.ventilator)?a.dpois(e.ICU-e.ventilator,m+1e-6,1):0,f=isFinite(e.ventilator)?a.dpois(e.ventilator,h+1e-6,1):0;let g=o+s+u+l+f;return 0==n&&(g=Math.exp(g)),g},n.rmeasure=function(e,t){let r=[],n=[],a=[],s={};for(let t=0;t<args.nstageH;t++)r.push(e["H"+(t+1)]);for(let t=0;t<args.nstageC;t++)r.push(e["C"+(t+1)]);for(let t=0;t<args.nstageV;t++)r.push(e["V"+(t+1)]);let u=e.casesH+e.casesIQ;s.reports=o(u+1e-6);let l=e.deathsCV+e.deathsIIQ;s.deaths=o(l+1e-6);let f=0;for(let e=0;e<args.nstageH;e++)f+=r[e];let c=0;for(i=0;i<args.nstageC;i++)c+=n[i];let _=0;for(i=0;i<args.nstageV;i++)_+=a[i];s.ventilator=o(_+1e-6),s.ICU=o(c+1e-6)+s.ventilator,s.hospital=o(f+1e-6)+s.ICU};let s=["betaI","iota","beta_sd","sigma","kappa","gammaI","gammaH","gammaC","gammaV","TF"],u=["rho","theta","dI0","dP0","dT0","dB0","dI1","dP1","dT1","dB1","qP","qH","qC","mI","mC","mV"];n.paramsMod=[...s,...u],n.paramsIc=["S0","EQ0","PQ0","IQ0","E0","P0","I0","H0","C0","V0","M0"],n.zeronames=["casesI","casesIQ","casesH","deathsIIQ","deathsCV"],n.statenames=[...function(){let e=["S"];for(let t=0;t<3;t++)e.push("EQ"+t);for(let t=0;t<3;t++)e.push("PQ"+t);for(let t=0;t<3;t++)e.push("IQ"+t);for(let t=0;t<3;t++)e.push("E"+t);for(let t=0;t<3;t++)e.push("P"+t);for(let t=0;t<3;t++)e.push("I"+t);for(let t=0;t<3;t++)e.push("H"+t);for(let t=0;t<3;t++)e.push("C"+t);for(let t=0;t<3;t++)e.push("V"+t);return e.push("M","R"),e}(),...n.zeronames],n.toEstimationScale=function(e){let t=Object.assign({},e);for(let r=0;r<s.length;r++)t[s[r]]=Math.log(e[s[r]]);for(let r=0;r<u.length;r++)t[u[r]]=a.qlogis(e[u[r]]);return t},n.fromEstimationScale=function(e){let t=Object.assign({},e);for(let r=0;r<s.length;r++)t[s[r]]=Math.exp(e[s[r]]);for(let r=0;r<u.length;r++)t[u[r]]=a.plogis(e[u[r]]);return t},n.determineRW=function(e){return(e=>{let t={};for(let e=0;e<Object.keys(n.paramsMod).length;e++)t[n.paramsMod[e]]=0;return t.dB0=e<75?0:.05,t}).toString()},e.exports=n},function(e,t,r){let n=r(0);t.rpois=function(e){let t,r,i,a,o,s,u,l,f,c,_=1/Math.sqrt(2*Math.PI),d=[1,1,2,6,24,120,720,5040,40320,362880],p=0,m=0,h=new Array(36),g=0,b=0,N=0,v=0,M=0,R=0,y=0,I=0,E=0,w=0,P=0,x=0,A=0,O=0,T=0,L=0,S=0,q=0,D=0,C=0,j=0,F=-1,k=0,V=!1;if(!isFinite(e)||e<0)throw"error";if(e<=0)return 0;if(c=e>=10,c&&(V=!1),!c||e!==T)if(c)V=!0,T=e,P=Math.sqrt(e),x=6*e*e,O=Math.floor(e-1.1484);else for(e!==T&&(T=e,m=Math.trunc(Math.max(1,Math.trunc(e))),p=0,w=I=E=Math.exp(-e));;){if(j=Math.random(),j<=I)return 0;if(0!==p){for(f=j<=.458?1:Math.trunc(Math.min(p,m));f<=p;f++)if(j<=h[f])return f;if(35===p)continue}for(p++,f=p;f<=35;f++)if(E*=e/f,w+=E,h[f]=w,j<=w)return p=f,f;p=35}if(a=e+P*function(){for(var e=0,t=0;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)}(),a>=0){if(F=Math.floor(a),F>=O)return F;if(D=F,S=e-D,j=Math.random(),x*j>=S*S*S)return F}(V||e!==L)&&(L=e,A=_/P,g=.041666666666666664/e,b=.3*g*g,y=.14285714285714285*g*b,R=b-15*y,M=g-6*b+45*y,v=1-g+3*b-15*y,N=.1069/e);let B=!1,Q=!0;for(;;)if(Q&&(Q=!1,a>=0&&(k=0,B=!0)),B||(q=n.expRand(Math.random),j=2*Math.random()-1,C=1.8+n.sign(q,j>=0)),C>-.6744||B)if(B||(F=Math.floor(e+P*C),D=F,S=e-D,k=1),B=!1,F<10?(o=-e,s=Math.pow(e,F)/d[Math.trunc(F)]):(t=.08333333333333333/D,t*=1-4.8*t*t,u=S/D,o=Math.abs(u)<=.25?D*u*u*(((((((.125006*u-.1384794)*u+.1421878)*u-.1661269)*u+.2000118)*u-.2500068)*u+.3333333)*u-.5)-t:D*Math.log(1+u)-S-t,s=_/Math.sqrt(D)),l=(.5-S)/P,l*=l,r=-.5*l,i=A*(((y*l+R)*l+M)*l+v),k>0){if(N*Math.abs(j)<=s*Math.exp(o+q)-i*Math.exp(r+q))break}else if(i-j*i<=s*Math.exp(o-r))break;return F}},function(e,t){let r=class{constructor(e){null==e&&(e={}),this.data=e.data||[],this.times=e.times||[],this.t0=e.t0||0,this.rprocess=e.rprocess||{},this.rprocessDetail=e.rprocessDetail||{},this.dprocess=e.dprocess||{},this.rmeasure=e.rmeasure||{},this.dmeasure=e.dmeasure||{},this.measurement_model=e.measurement_model||{},this.skeleton=e.skeleton||{},this.skeletonDetail=e.skeletonDetail||{},this.initializer=e.initializer||{},this.rprior=e.rprior||{},this.dprior=e.dprior||{},this.params=e.params||{},this.covar=e.covar||{},this.tcovar=e.tcovar||{},this.obsnames=e.obsnames||{},this.statenames=e.statenames||{},this.paramnames=e.paramnames||{},this.covarnames=e.covarnames||{},this.zeronames=e.zeronames||{},this.PACKAGE=e.PACKAGE||{},this.fromEstimationScale=e.fromEstimationScale||{},this.toEstimationScale=e.toEstimationScale||{},this.globals=e.globals||{},this.cdir=e.cdir||{},this.cfile=e.cfile||{},this.shlib_args=e.shlib_args||{};let t="in 'pomp': ";if(null==this.data||0==this.data.length)throw new Error(t+"'data' is a required argument.");if(1==Object.keys(e).length)return data;if(!Array.isArray(this.data)&&"Pomp"!=this.data.constructor.name)throw new Error(t+"'data'must be a data frame or an object of class 'pomp'.");let r=void 0===this.fromEstimationScale||this.fromEstimationScale=={},n=void 0===this.toEstimationScale||this.toEstimationScale=={};if(r^n)throw new Error(t+"if one of 'toEstimationScale', 'fromEstimationScale' is supplied, then so must the other");if(r=void 0===this.covar||this.covar=={},n=void 0===this.tcovar||this.tcovar=={},r^n)throw new Error(t+"if one of 'covar', 'tcovar' is supplied, then so must the other");if(void 0===this.times||this.times===[])throw new Error(t+"'times' is a required argument");if(!Array.isArray(this.times)){if(Number.isInteger(this.times)&&(this.times<1||this.times>this.data[0].length)||"string"==typeof this.times&&-1==this.data[0].indexOf(this.times))throw new Error(t+"when 'data' is a data frame, 'times' must identify a single column of 'data' either by name or by index.");let e=-1;Number.isInteger(this.times)?e=this.times:"string"==typeof this.times&&(e=this.data[0].indexOf(this.times)),this.times=this.data.map((function(t,r){return t[e]})),this.data.map((function(t){return t.splice(e,1)})),this.obsnames=this.data.shift(),this.times.shift()}}};r.prototype.interpolator=function(e){let t=this.covar.length,r=this.covarnames.length;if(point={},0===t)for(let e=0;e<r;e++)point[this.covarnames[e]]=0;if(1===t)for(let e=0;e<r;e++)point[this.covarnames[e]]=+this.covar[0][this.covarnames[e]];if(e<=this.tcovar[0])for(let t=0;t<r;t++)point[this.covarnames[t]]=+this.covar[0][this.covarnames[t]]+(e-this.tcovar[0])*(this.covar[1][this.covarnames[t]]-this.covar[0][this.covarnames[t]])/(this.tcovar[1]-this.tcovar[0]);else if(e>=this.tcovar[t-1])for(let n=0;n<r;n++)point[this.covarnames[n]]=+this.covar[t-1][this.covarnames[n]]+(e-this.tcovar[t-1])*(this.covar[t-2][this.covarnames[n]]-this.covar[t-1][this.covarnames[n]])/(this.tcovar[t-2]-this.tcovar[t-1]);else for(let n=0;n<t;n++)if(e>this.tcovar[n]&&e<=this.tcovar[n+1]){for(let t=0;t<r;t++)point[this.covarnames[t]]=+this.covar[n][this.covarnames[t]]+(e-this.tcovar[n])*(this.covar[n+1][this.covarnames[t]]-this.covar[n][this.covarnames[t]])/(this.tcovar[n+1]-this.tcovar[n]);return point}return point},e.exports=r}]);